package com.z0ltan.compilers.triangle.parser;

import static org.hamcrest.MatcherAssert.assertThat;
import static org.hamcrest.Matchers.is;
import static org.hamcrest.Matchers.equalTo;

import com.z0ltan.compilers.triangle.scanner.Scanner;
import com.z0ltan.compilers.triangle.scanner.SourcePosition;
import com.z0ltan.compilers.triangle.parser.Parser;
import com.z0ltan.compilers.triangle.ast.Program;
import com.z0ltan.compilers.triangle.ast.EmptyCommand;
import com.z0ltan.compilers.triangle.ast.AssignCommand;
import com.z0ltan.compilers.triangle.ast.LetCommand;
import com.z0ltan.compilers.triangle.ast.CallCommand;
import com.z0ltan.compilers.triangle.ast.IfCommand;
import com.z0ltan.compilers.triangle.ast.WhileCommand;
import com.z0ltan.compilers.triangle.ast.SequentialCommand;
import com.z0ltan.compilers.triangle.ast.IntegerExpression;
import com.z0ltan.compilers.triangle.ast.CharacterExpression;
import com.z0ltan.compilers.triangle.ast.LetExpression;
import com.z0ltan.compilers.triangle.ast.IfExpression;
import com.z0ltan.compilers.triangle.ast.CallExpression;
import com.z0ltan.compilers.triangle.ast.VnameExpression;
import com.z0ltan.compilers.triangle.ast.UnaryExpression;
import com.z0ltan.compilers.triangle.ast.BinaryExpression;
import com.z0ltan.compilers.triangle.ast.ArrayExpression;
import com.z0ltan.compilers.triangle.ast.RecordExpression;
import com.z0ltan.compilers.triangle.ast.SingleArrayAggregate;
import com.z0ltan.compilers.triangle.ast.MultipleArrayAggregate;
import com.z0ltan.compilers.triangle.ast.SingleRecordAggregate;
import com.z0ltan.compilers.triangle.ast.MultipleRecordAggregate;
import com.z0ltan.compilers.triangle.ast.EmptyFormalParameterSequence;
import com.z0ltan.compilers.triangle.ast.SingleFormalParameterSequence;
import com.z0ltan.compilers.triangle.ast.MultipleFormalParameterSequence;
import com.z0ltan.compilers.triangle.ast.EmptyActualParameterSequence;
import com.z0ltan.compilers.triangle.ast.SingleActualParameterSequence;
import com.z0ltan.compilers.triangle.ast.MultipleActualParameterSequence;
import com.z0ltan.compilers.triangle.ast.ConstFormalParameter;
import com.z0ltan.compilers.triangle.ast.VarFormalParameter;
import com.z0ltan.compilers.triangle.ast.ProcFormalParameter;
import com.z0ltan.compilers.triangle.ast.ConstActualParameter;
import com.z0ltan.compilers.triangle.ast.VarActualParameter;
import com.z0ltan.compilers.triangle.ast.ProcActualParameter;
import com.z0ltan.compilers.triangle.ast.FuncActualParameter;
import com.z0ltan.compilers.triangle.ast.VarDeclaration;
import com.z0ltan.compilers.triangle.ast.ConstDeclaration;
import com.z0ltan.compilers.triangle.ast.ProcDeclaration;
import com.z0ltan.compilers.triangle.ast.FuncDeclaration;
import com.z0ltan.compilers.triangle.ast.TypeDeclaration;
import com.z0ltan.compilers.triangle.ast.SequentialDeclaration;
import com.z0ltan.compilers.triangle.ast.SimpleTypeDenoter;
import com.z0ltan.compilers.triangle.ast.ArrayTypeDenoter;
import com.z0ltan.compilers.triangle.ast.RecordTypeDenoter;
import com.z0ltan.compilers.triangle.ast.SingleFieldTypeDenoter;
import com.z0ltan.compilers.triangle.ast.MultipleFieldTypeDenoter;
import com.z0ltan.compilers.triangle.ast.SimpleVname;
import com.z0ltan.compilers.triangle.ast.DotVname;
import com.z0ltan.compilers.triangle.ast.SubscriptVname;
import com.z0ltan.compilers.triangle.ast.Identifier;
import com.z0ltan.compilers.triangle.ast.Operator;
import com.z0ltan.compilers.triangle.ast.IntegerLiteral;
import com.z0ltan.compilers.triangle.ast.CharacterLiteral;

import static com.z0ltan.compilers.triangle.scanner.SourcePosition.dummyPosition;

public class ParserTest {
  public void testEmptyCommandEot() {
    String filename = "samples/source/emptycommandeot.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram = new Program(new EmptyCommand(dummyPosition()), dummyPosition());
    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }

  public void testEmptyCommandSemicolon() {
    String filename = "samples/source/emptycommandsemicolon.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram = new Program(new EmptyCommand(dummyPosition()), dummyPosition());
    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }

  public void testHello() {
    String filename = "samples/source/hello.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram = 
      new Program(new CallCommand(new Identifier("putint", dummyPosition()), 
            new SingleActualParameterSequence(new ConstActualParameter(new IntegerExpression(new IntegerLiteral("42", dummyPosition()), dummyPosition()), 
                dummyPosition()), dummyPosition()), 
            dummyPosition()),
          dummyPosition());
    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }

  public void testInc() {
    String filename = "samples/source/inc.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram =
      new Program(
          new LetCommand(
            new SequentialDeclaration(
              new VarDeclaration(
                new Identifier("x", dummyPosition()),
                new SimpleTypeDenoter(new Identifier("Integer", dummyPosition()), dummyPosition()),
                dummyPosition()),
              new ProcDeclaration(
                new Identifier("inc", dummyPosition()),
                new SingleFormalParameterSequence(
                  new VarFormalParameter(new Identifier("n", dummyPosition()), 
                    new SimpleTypeDenoter(new Identifier("Integer", dummyPosition()), dummyPosition()),
                    dummyPosition()),
                  dummyPosition()),
                new AssignCommand(
                  new SimpleVname(new Identifier("n", dummyPosition()), dummyPosition()),
                  new BinaryExpression(
                    new VnameExpression(new SimpleVname(new Identifier("n", dummyPosition()), dummyPosition()), dummyPosition()),
                    new Operator("+", dummyPosition()),
                    new IntegerExpression(new IntegerLiteral("1", dummyPosition()), dummyPosition()),
                    dummyPosition()),
                  dummyPosition()),
                dummyPosition()),
              dummyPosition()),
              new SequentialCommand(
                  new SequentialCommand(
                    new CallCommand(
                      new Identifier("getint", dummyPosition()),
                      new SingleActualParameterSequence(
                        new VarActualParameter(new SimpleVname(new Identifier("x", dummyPosition()), dummyPosition()), dummyPosition()),
                        dummyPosition()),
                      dummyPosition()),
                    new CallCommand(
                      new Identifier("inc", dummyPosition()),
                      new SingleActualParameterSequence(
                        new VarActualParameter(new SimpleVname(new Identifier("x", dummyPosition()), dummyPosition()), dummyPosition()),
                        dummyPosition()),
                      dummyPosition()),
                    dummyPosition()),
                  new CallCommand(
                    new Identifier("putint", dummyPosition()),
                    new SingleActualParameterSequence(
                      new ConstActualParameter(new VnameExpression(new SimpleVname(new Identifier("x", dummyPosition()), dummyPosition()), dummyPosition()),
                        dummyPosition()),
                      dummyPosition()), dummyPosition()),
                  dummyPosition()),
                  dummyPosition()),
                  dummyPosition());
    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }

  public void testEcho() {
    String filename = "samples/source/echo.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram = 
      new Program(
          new LetCommand(
            new SequentialDeclaration(
              new VarDeclaration(new Identifier("ch", dummyPosition()), new SimpleTypeDenoter(new Identifier("Char", dummyPosition()), dummyPosition()), dummyPosition()),
              new ProcDeclaration(new Identifier("echo", dummyPosition()), new EmptyFormalParameterSequence(dummyPosition()),
                new WhileCommand(new UnaryExpression(new Operator("\\", dummyPosition()), 
                    new CallExpression(new Identifier("eol", dummyPosition()), new EmptyActualParameterSequence(dummyPosition()), dummyPosition()),
                    dummyPosition()),
                  new SequentialCommand(
                    new CallCommand(new Identifier("get", dummyPosition()), new SingleActualParameterSequence(
                        new VarActualParameter(new SimpleVname(new Identifier("ch", dummyPosition()), dummyPosition()), dummyPosition()),
                        dummyPosition()), dummyPosition()),
                    new CallCommand(
                      new Identifier("put", dummyPosition()),
                      new SingleActualParameterSequence(
                        new ConstActualParameter(
                          new VnameExpression(
                            new SimpleVname(new Identifier("ch", dummyPosition()), dummyPosition()), dummyPosition()), dummyPosition())
                        ,dummyPosition())
                      ,dummyPosition()) 
                    ,dummyPosition()), dummyPosition()), 
                dummyPosition()), dummyPosition()), 
                new CallCommand(new Identifier("echo", dummyPosition()), new EmptyActualParameterSequence(dummyPosition()), dummyPosition()), dummyPosition()),
                dummyPosition());
    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }

  public void testOdd() {
    String filename = "samples/source/odd.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram = 
      new Program(new LetCommand(new SequentialDeclaration(
              new VarDeclaration(
                new Identifier("n", dummyPosition()),
                new SimpleTypeDenoter(new Identifier("Integer", dummyPosition()), dummyPosition()),
                dummyPosition()),
              new FuncDeclaration(
                new Identifier("odd", dummyPosition()),
                new SingleFormalParameterSequence(new ConstFormalParameter(new Identifier("n", dummyPosition()), 
                    new SimpleTypeDenoter(new Identifier("Integer", dummyPosition()), dummyPosition()), dummyPosition()), dummyPosition()),
                new SimpleTypeDenoter(new Identifier("Boolean", dummyPosition()), dummyPosition()),
                new BinaryExpression(
                  new BinaryExpression(
                    new VnameExpression(new SimpleVname(new Identifier("n", dummyPosition()), dummyPosition()), dummyPosition()),
                    new Operator("//", dummyPosition()),
                    new IntegerExpression(new IntegerLiteral("2", dummyPosition()), dummyPosition()),
                    dummyPosition()),
                  new Operator("\\=", dummyPosition()),
                  new IntegerExpression(new IntegerLiteral("0", dummyPosition()), dummyPosition()),
                  dummyPosition()),
                dummyPosition()),
              dummyPosition()),
              new SequentialCommand(
                  new CallCommand(
                    new Identifier("getint", dummyPosition()),
                    new SingleActualParameterSequence(
                      new VarActualParameter(
                        new SimpleVname(
                          new Identifier("n", dummyPosition()), dummyPosition()), dummyPosition()), dummyPosition()),
                    dummyPosition()),
                  new IfCommand(
                    new CallExpression(
                      new Identifier("odd", dummyPosition()),
                      new SingleActualParameterSequence(
                        new ConstActualParameter(
                          new VnameExpression(
                            new SimpleVname(
                              new Identifier("n", dummyPosition()), dummyPosition()), dummyPosition()), dummyPosition()), dummyPosition()),
                      dummyPosition()),
                    new CallCommand(
                      new Identifier("putint", dummyPosition()),
                      new SingleActualParameterSequence(
                        new ConstActualParameter(new IntegerExpression(new IntegerLiteral("1", dummyPosition()), dummyPosition()), dummyPosition()), dummyPosition()),
                      dummyPosition()),
                    new CallCommand(
                      new Identifier("putint", dummyPosition()),
                      new SingleActualParameterSequence(new ConstActualParameter(new IntegerExpression(new IntegerLiteral("2", dummyPosition()), dummyPosition()), dummyPosition()), dummyPosition()),
                      dummyPosition()),
                    dummyPosition()),
                  dummyPosition()),
                  dummyPosition()),
                  dummyPosition());
    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }

  public void testSumProc() {
    String filename = "samples/source/sum_proc.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram =
      new Program(
          new LetCommand(
            new SequentialDeclaration(
              new SequentialDeclaration(
                new SequentialDeclaration(
                  new VarDeclaration(
                    new Identifier(
                      "x",
                      dummyPosition()
                      ),
                    new SimpleTypeDenoter(
                      new Identifier(
                        "Integer",
                        dummyPosition()
                        ),
                      dummyPosition()
                      ),
                    dummyPosition()
                    ),
                  new VarDeclaration(
                    new Identifier(
                      "y",
                      dummyPosition()
                      ),
                    new SimpleTypeDenoter(
                      new Identifier(
                        "Integer",
                        dummyPosition()
                        ),
                      dummyPosition()
                      ),
                    dummyPosition()
                    ),
                  dummyPosition()
                    ),
                  new VarDeclaration(
                      new Identifier(
                        "s",
                        dummyPosition()
                        ),
                      new SimpleTypeDenoter(
                        new Identifier(
                          "Integer",
                          dummyPosition()
                          ),
                        dummyPosition()
                        ),
                      dummyPosition()
                      ),
                  dummyPosition()
                    ),
                  new ProcDeclaration(
                      new Identifier(
                        "add",
                        dummyPosition()
                        ),
                      new MultipleFormalParameterSequence(
                        new ConstFormalParameter(
                          new Identifier(
                            "a",
                            dummyPosition()
                            ),
                          new SimpleTypeDenoter(
                            new Identifier(
                              "Integer",
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                          dummyPosition()
                          ),
                        new MultipleFormalParameterSequence(
                          new ConstFormalParameter(
                            new Identifier(
                              "b",
                              dummyPosition()
                              ),
                            new SimpleTypeDenoter(
                              new Identifier(
                                "Integer",
                                dummyPosition()
                                ),
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                          new SingleFormalParameterSequence(
                            new VarFormalParameter(
                              new Identifier(
                                "r",
                                dummyPosition()
                                ),
                              new SimpleTypeDenoter(
                                new Identifier(
                                  "Integer",
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                          dummyPosition()
                            ),
                          dummyPosition()
                            ),
                          new AssignCommand(
                              new SimpleVname(
                                new Identifier(
                                  "r",
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                              new BinaryExpression(
                                new VnameExpression(
                                  new SimpleVname(
                                    new Identifier(
                                      "a",
                                      dummyPosition()
                                      ),
                                    dummyPosition()
                                    ),
                                  dummyPosition()
                                  ),
                                new Operator(
                                  "+",
                                  dummyPosition()
                                  ),
                                new VnameExpression(
                                  new SimpleVname(
                                    new Identifier(
                                      "b",
                                      dummyPosition()
                                      ),
                                    dummyPosition()
                                    ),
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                  ),
                                dummyPosition()
                                  ),
                                dummyPosition()
                                  ),
                                dummyPosition()
                                  ),
                                new SequentialCommand(
                                    new SequentialCommand(
                                      new SequentialCommand(
                                        new CallCommand(
                                          new Identifier(
                                            "getint",
                                            dummyPosition()
                                            ),
                                          new SingleActualParameterSequence(
                                            new VarActualParameter(
                                              new SimpleVname(
                                                new Identifier(
                                                  "x",
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                new CallCommand(
                                    new Identifier(
                                      "getint",
                                      dummyPosition()
                                      ),
                                    new SingleActualParameterSequence(
                                      new VarActualParameter(
                                        new SimpleVname(
                                          new Identifier(
                                            "y",
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                      ),
                                    dummyPosition()
                                    ),
                                dummyPosition()
                                  ),
                                new CallCommand(
                                    new Identifier(
                                      "add",
                                      dummyPosition()
                                      ),
                                    new MultipleActualParameterSequence(
                                      new ConstActualParameter(
                                        new VnameExpression(
                                          new SimpleVname(
                                            new Identifier(
                                              "x",
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                        ),
                                      new MultipleActualParameterSequence(
                                        new ConstActualParameter(
                                          new VnameExpression(
                                            new SimpleVname(
                                              new Identifier(
                                                "y",
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                        new SingleActualParameterSequence(
                                          new VarActualParameter(
                                            new SimpleVname(
                                              new Identifier(
                                                "s",
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                          ),
                                        dummyPosition()
                                          ),
                                        dummyPosition()
                                          ),
                                        dummyPosition()
                                          ),
                                        new CallCommand(
                                            new Identifier(
                                              "putint",
                                              dummyPosition()
                                              ),
                                            new SingleActualParameterSequence(
                                              new ConstActualParameter(
                                                new VnameExpression(
                                                  new SimpleVname(
                                                    new Identifier(
                                                      "s",
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                              ),
                                            dummyPosition()
                                              ),
                                            dummyPosition()
                                              ),
                                            dummyPosition()
                                              );


    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }

  public void testPower() {
    String filename = "samples/source/power.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram =
      new Program(
          new LetCommand(
            new SequentialDeclaration(
              new SequentialDeclaration(
                new VarDeclaration(
                  new Identifier(
                    "m",
                    dummyPosition()
                    ),
                  new SimpleTypeDenoter(
                    new Identifier(
                      "Integer",
                      dummyPosition()
                      ),
                    dummyPosition()
                    ),
                  dummyPosition()
                  ),
                new VarDeclaration(
                  new Identifier(
                    "n",
                    dummyPosition()
                    ),
                  new SimpleTypeDenoter(
                    new Identifier(
                      "Integer",
                      dummyPosition()
                      ),
                    dummyPosition()
                    ),
                  dummyPosition()
                  ),
                dummyPosition()
                  ),
                new FuncDeclaration(
                    new Identifier(
                      "power",
                      dummyPosition()
                      ),
                    new MultipleFormalParameterSequence(
                      new ConstFormalParameter(
                        new Identifier(
                          "a",
                          dummyPosition()
                          ),
                        new SimpleTypeDenoter(
                          new Identifier(
                            "Integer",
                            dummyPosition()
                            ),
                          dummyPosition()
                          ),
                        dummyPosition()
                        ),
                      new SingleFormalParameterSequence(
                        new ConstFormalParameter(
                          new Identifier(
                            "b",
                            dummyPosition()
                            ),
                          new SimpleTypeDenoter(
                            new Identifier(
                              "Integer",
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                          dummyPosition()
                          ),
                        dummyPosition()
                        ),
                      dummyPosition()
                        ),
                      new SimpleTypeDenoter(
                          new Identifier(
                            "Integer",
                            dummyPosition()
                            ),
                          dummyPosition()
                          ),
                      new IfExpression(
                          new BinaryExpression(
                            new VnameExpression(
                              new SimpleVname(
                                new Identifier(
                                  "b",
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                              dummyPosition()
                              ),
                            new Operator(
                              "=",
                              dummyPosition()
                              ),
                            new IntegerExpression(
                              new IntegerLiteral(
                                "0",
                                dummyPosition()
                                ),
                              dummyPosition()
                              ),
                            dummyPosition()
                              ),
                            new IntegerExpression(
                                new IntegerLiteral(
                                  "1",
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                            new BinaryExpression(
                                new VnameExpression(
                                  new SimpleVname(
                                    new Identifier(
                                      "a",
                                      dummyPosition()
                                      ),
                                    dummyPosition()
                                    ),
                                  dummyPosition()
                                  ),
                                new Operator(
                                  "*",
                                  dummyPosition()
                                  ),
                                new CallExpression(
                                  new Identifier(
                                    "power",
                                    dummyPosition()
                                    ),
                                  new MultipleActualParameterSequence(
                                    new ConstActualParameter(
                                      new VnameExpression(
                                        new SimpleVname(
                                          new Identifier(
                                            "a",
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                      ),
                                    new SingleActualParameterSequence(
                                      new ConstActualParameter(
                                        new BinaryExpression(
                                          new VnameExpression(
                                            new SimpleVname(
                                              new Identifier(
                                                "b",
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          new Operator(
                                            "-",
                                            dummyPosition()
                                            ),
                                          new IntegerExpression(
                                            new IntegerLiteral(
                                              "1",
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                            ),
                                          dummyPosition()
                                            ),
                                          dummyPosition()
                                            ),
                                          dummyPosition()
                                            ),
                                          dummyPosition()
                                            ),
                                          dummyPosition()
                                            ),
                                          dummyPosition()
                                            ),
                                          dummyPosition()
                                            ),
                                          dummyPosition()
                                            ),
                                          new SequentialCommand(
                                              new SequentialCommand(
                                                new CallCommand(
                                                  new Identifier(
                                                    "getint",
                                                    dummyPosition()
                                                    ),
                                                  new SingleActualParameterSequence(
                                                    new VarActualParameter(
                                                      new SimpleVname(
                                                        new Identifier(
                                                          "m",
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                          new CallCommand(
                                              new Identifier(
                                                "getint",
                                                dummyPosition()
                                                ),
                                              new SingleActualParameterSequence(
                                                new VarActualParameter(
                                                  new SimpleVname(
                                                    new Identifier(
                                                      "n",
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                          dummyPosition()
                                            ),
                                          new CallCommand(
                                              new Identifier(
                                                "putint",
                                                dummyPosition()
                                                ),
                                              new SingleActualParameterSequence(
                                                new ConstActualParameter(
                                                  new CallExpression(
                                                    new Identifier(
                                                      "power",
                                                      dummyPosition()
                                                      ),
                                                    new MultipleActualParameterSequence(
                                                      new ConstActualParameter(
                                                        new VnameExpression(
                                                          new SimpleVname(
                                                            new Identifier(
                                                              "m",
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      new SingleActualParameterSequence(
                                                        new ConstActualParameter(
                                                          new VnameExpression(
                                                            new SimpleVname(
                                                              new Identifier(
                                                                "n",
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                        );

    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }

  public void testFactorial() {
    String filename = "samples/source/factorial.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram =
      new Program(
          new LetCommand(
            new SequentialDeclaration(
              new SequentialDeclaration(
                new VarDeclaration(
                  new Identifier(
                    "n",
                    dummyPosition()
                    ),
                  new SimpleTypeDenoter(
                    new Identifier(
                      "Integer",
                      dummyPosition()
                      ),
                    dummyPosition()
                    ),
                  dummyPosition()
                  ),
                new FuncDeclaration(
                  new Identifier(
                    "factorial",
                    dummyPosition()
                    ),
                  new SingleFormalParameterSequence(
                    new ConstFormalParameter(
                      new Identifier(
                        "n",
                        dummyPosition()
                        ),
                      new SimpleTypeDenoter(
                        new Identifier(
                          "Integer",
                          dummyPosition()
                          ),
                        dummyPosition()
                        ),
                      dummyPosition()
                      ),
                    dummyPosition()
                    ),
                  new SimpleTypeDenoter(
                      new Identifier(
                        "Integer",
                        dummyPosition()
                        ),
                      dummyPosition()
                      ),
                  new IfExpression(
                      new BinaryExpression(
                        new VnameExpression(
                          new SimpleVname(
                            new Identifier(
                              "n",
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                          dummyPosition()
                          ),
                        new Operator(
                          "<=",
                          dummyPosition()
                          ),
                        new IntegerExpression(
                          new IntegerLiteral(
                            "0",
                            dummyPosition()
                            ),
                          dummyPosition()
                          ),
                        dummyPosition()
                          ),
                        new IntegerExpression(
                            new IntegerLiteral(
                              "1",
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                        new BinaryExpression(
                            new VnameExpression(
                              new SimpleVname(
                                new Identifier(
                                  "n",
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                              dummyPosition()
                              ),
                            new Operator(
                              "*",
                              dummyPosition()
                              ),
                            new CallExpression(
                              new Identifier(
                                "factorial",
                                dummyPosition()
                                ),
                              new SingleActualParameterSequence(
                                new ConstActualParameter(
                                  new BinaryExpression(
                                    new VnameExpression(
                                      new SimpleVname(
                                        new Identifier(
                                          "n",
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                      ),
                                    new Operator(
                                      "-",
                                      dummyPosition()
                                      ),
                                    new IntegerExpression(
                                      new IntegerLiteral(
                                        "1",
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                      ),
                                    dummyPosition()
                                      ),
                                    dummyPosition()
                                      ),
                                    dummyPosition()
                                      ),
                                    dummyPosition()
                                      ),
                                    dummyPosition()
                                      ),
                                    dummyPosition()
                                      ),
                                    dummyPosition()
                                      ),
                                    dummyPosition()
                                      ),
                                    new ProcDeclaration(
                                        new Identifier(
                                          "readnumber",
                                          dummyPosition()
                                          ),
                                        new SingleFormalParameterSequence(
                                          new VarFormalParameter(
                                            new Identifier(
                                              "n",
                                              dummyPosition()
                                              ),
                                            new SimpleTypeDenoter(
                                              new Identifier(
                                                "Integer",
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                        new CallCommand(
                                            new Identifier(
                                              "getint",
                                              dummyPosition()
                                              ),
                                            new SingleActualParameterSequence(
                                              new VarActualParameter(
                                                new SimpleVname(
                                                  new Identifier(
                                                    "n",
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                        dummyPosition()
                                          ),
                                        dummyPosition()
                                          ),
                                        new SequentialCommand(
                                            new SequentialCommand(
                                              new SequentialCommand(
                                                new CallCommand(
                                                  new Identifier(
                                                    "readnumber",
                                                    dummyPosition()
                                                    ),
                                                  new SingleActualParameterSequence(
                                                    new VarActualParameter(
                                                      new SimpleVname(
                                                        new Identifier(
                                                          "n",
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                        new CallCommand(
                                            new Identifier(
                                              "puteol",
                                              dummyPosition()
                                              ),
                                            new EmptyActualParameterSequence(
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                        dummyPosition()
                                          ),
                                        new CallCommand(
                                            new Identifier(
                                              "puteol",
                                              dummyPosition()
                                              ),
                                            new EmptyActualParameterSequence(
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                        dummyPosition()
                                          ),
                                        new CallCommand(
                                            new Identifier(
                                              "putint",
                                              dummyPosition()
                                              ),
                                            new SingleActualParameterSequence(
                                              new ConstActualParameter(
                                                new CallExpression(
                                                  new Identifier(
                                                    "factorial",
                                                    dummyPosition()
                                                    ),
                                                  new SingleActualParameterSequence(
                                                    new ConstActualParameter(
                                                      new VnameExpression(
                                                        new SimpleVname(
                                                          new Identifier(
                                                            "n",
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                    );

    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }

  public void testRecord() {
    String filename = "samples/source/record.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram = 
      new Program(
          new LetCommand(
            new SequentialDeclaration(
              new SequentialDeclaration(
                new TypeDeclaration(
                  new Identifier(
                    "Date",
                    dummyPosition()
                    ),
                  new RecordTypeDenoter(
                    new MultipleFieldTypeDenoter(
                      new Identifier(
                        "y",
                        dummyPosition()
                        ),
                      new SimpleTypeDenoter(
                        new Identifier(
                          "Integer",
                          dummyPosition()
                          ),
                        dummyPosition()
                        ),
                      new MultipleFieldTypeDenoter(
                        new Identifier(
                          "m",
                          dummyPosition()
                          ),
                        new SimpleTypeDenoter(
                          new Identifier(
                            "Integer",
                            dummyPosition()
                            ),
                          dummyPosition()
                          ),
                        new SingleFieldTypeDenoter(
                          new Identifier(
                            "d",
                            dummyPosition()
                            ),
                          new SimpleTypeDenoter(
                            new Identifier(
                              "Integer",
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                          dummyPosition()
                          ),
                        dummyPosition()
                          ),
                        dummyPosition()
                          ),
                        dummyPosition()
                          ),
                        dummyPosition()
                          ),
                        new VarDeclaration(
                            new Identifier(
                              "today",
                              dummyPosition()
                              ),
                            new SimpleTypeDenoter(
                              new Identifier(
                                "Date",
                                dummyPosition()
                                ),
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                        dummyPosition()
                          ),
                        new VarDeclaration(
                            new Identifier(
                              "tomorrow",
                              dummyPosition()
                              ),
                            new SimpleTypeDenoter(
                              new Identifier(
                                "Date",
                                dummyPosition()
                                ),
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                        dummyPosition()
                          ),
                        new SequentialCommand(
                            new SequentialCommand(
                              new SequentialCommand(
                                new SequentialCommand(
                                  new SequentialCommand(
                                    new SequentialCommand(
                                      new SequentialCommand(
                                        new AssignCommand(
                                          new SimpleVname(
                                            new Identifier(
                                              "today",
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          new RecordExpression(
                                            new MultipleRecordAggregate(
                                              new Identifier(
                                                "y",
                                                dummyPosition()
                                                ),
                                              new IntegerExpression(
                                                new IntegerLiteral(
                                                  "2021",
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                ),
                                              new MultipleRecordAggregate(
                                                new Identifier(
                                                  "m",
                                                  dummyPosition()
                                                  ),
                                                new IntegerExpression(
                                                  new IntegerLiteral(
                                                    "1",
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                                new SingleRecordAggregate(
                                                  new Identifier(
                                                    "d",
                                                    dummyPosition()
                                                    ),
                                                  new IntegerExpression(
                                                    new IntegerLiteral(
                                                      "12",
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                  ),
                                                dummyPosition()
                                                  ),
                                                dummyPosition()
                                                  ),
                                                dummyPosition()
                                                  ),
                                                new CallCommand(
                                                    new Identifier(
                                                      "putint",
                                                      dummyPosition()
                                                      ),
                                                    new SingleActualParameterSequence(
                                                      new ConstActualParameter(
                                                        new VnameExpression(
                                                          new DotVname(
                                                            new SimpleVname(
                                                              new Identifier(
                                                                "today",
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            new Identifier(
                                                              "y",
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                dummyPosition()
                                                  ),
                                                dummyPosition()
                                                  ),
                                                dummyPosition()
                                                  ),
                                                new CallCommand(
                                                    new Identifier(
                                                      "putint",
                                                      dummyPosition()
                                                      ),
                                                    new SingleActualParameterSequence(
                                                      new ConstActualParameter(
                                                        new VnameExpression(
                                                          new DotVname(
                                                            new SimpleVname(
                                                              new Identifier(
                                                                "today",
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            new Identifier(
                                                              "m",
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                dummyPosition()
                                                  ),
                                                dummyPosition()
                                                  ),
                                                dummyPosition()
                                                  ),
                                                new CallCommand(
                                                    new Identifier(
                                                      "putint",
                                                      dummyPosition()
                                                      ),
                                                    new SingleActualParameterSequence(
                                                      new ConstActualParameter(
                                                        new VnameExpression(
                                                          new DotVname(
                                                            new SimpleVname(
                                                              new Identifier(
                                                                "today",
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            new Identifier(
                                                              "d",
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                dummyPosition()
                                                  ),
                                                dummyPosition()
                                                  ),
                                                dummyPosition()
                                                  ),
                                                new AssignCommand(
                                                    new SimpleVname(
                                                      new Identifier(
                                                        "tomorrow",
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                    new RecordExpression(
                                                      new MultipleRecordAggregate(
                                                        new Identifier(
                                                          "y",
                                                          dummyPosition()
                                                          ),
                                                        new VnameExpression(
                                                          new DotVname(
                                                            new SimpleVname(
                                                              new Identifier(
                                                                "today",
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            new Identifier(
                                                              "y",
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        new MultipleRecordAggregate(
                                                            new Identifier(
                                                              "m",
                                                              dummyPosition()
                                                              ),
                                                            new VnameExpression(
                                                              new DotVname(
                                                                new SimpleVname(
                                                                  new Identifier(
                                                                    "today",
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                  ),
                                                                new Identifier(
                                                                  "m",
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            new SingleRecordAggregate(
                                                                new Identifier(
                                                                  "d",
                                                                  dummyPosition()
                                                                  ),
                                                                new BinaryExpression(
                                                                  new VnameExpression(
                                                                    new DotVname(
                                                                      new SimpleVname(
                                                                        new Identifier(
                                                                          "today",
                                                                          dummyPosition()
                                                                          ),
                                                                        dummyPosition()
                                                                        ),
                                                                      new Identifier(
                                                                        "d",
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                  new Operator(
                                                                    "+",
                                                                    dummyPosition()
                                                                    ),
                                                                  new IntegerExpression(
                                                                      new IntegerLiteral(
                                                                        "1",
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                                  dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    ),
                                                                  new CallCommand(
                                                                      new Identifier(
                                                                        "putint",
                                                                        dummyPosition()
                                                                        ),
                                                                      new SingleActualParameterSequence(
                                                                        new ConstActualParameter(
                                                                          new VnameExpression(
                                                                            new DotVname(
                                                                              new SimpleVname(
                                                                                new Identifier(
                                                                                  "tomorrow",
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              new Identifier(
                                                                                "y",
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                            ),
                                                                          dummyPosition()
                                                                          ),
                                                                  dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    ),
                                                                  new CallCommand(
                                                                      new Identifier(
                                                                        "putint",
                                                                        dummyPosition()
                                                                        ),
                                                                      new SingleActualParameterSequence(
                                                                        new ConstActualParameter(
                                                                          new VnameExpression(
                                                                            new DotVname(
                                                                              new SimpleVname(
                                                                                new Identifier(
                                                                                  "tomorrow",
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              new Identifier(
                                                                                "m",
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                            ),
                                                                          dummyPosition()
                                                                          ),
                                                                  dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    ),
                                                                  new CallCommand(
                                                                      new Identifier(
                                                                        "putint",
                                                                        dummyPosition()
                                                                        ),
                                                                      new SingleActualParameterSequence(
                                                                        new ConstActualParameter(
                                                                          new VnameExpression(
                                                                            new DotVname(
                                                                              new SimpleVname(
                                                                                new Identifier(
                                                                                  "tomorrow",
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              new Identifier(
                                                                                "d",
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                            ),
                                                                          dummyPosition()
                                                                          ),
                                                                  dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    );
    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }

  public void testLeapYear() {
    String filename = "samples/source/leapyear.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram =
      new Program(
          new LetCommand(
            new SequentialDeclaration(
              new SequentialDeclaration(
                new SequentialDeclaration(
                  new TypeDeclaration(
                    new Identifier(
                      "Date",
                      dummyPosition()
                      ),
                    new RecordTypeDenoter(
                      new MultipleFieldTypeDenoter(
                        new Identifier(
                          "y",
                          dummyPosition()
                          ),
                        new SimpleTypeDenoter(
                          new Identifier(
                            "Integer",
                            dummyPosition()
                            ),
                          dummyPosition()
                          ),
                        new MultipleFieldTypeDenoter(
                          new Identifier(
                            "m",
                            dummyPosition()
                            ),
                          new SimpleTypeDenoter(
                            new Identifier(
                              "Integer",
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                          new SingleFieldTypeDenoter(
                            new Identifier(
                              "d",
                              dummyPosition()
                              ),
                            new SimpleTypeDenoter(
                              new Identifier(
                                "Integer",
                                dummyPosition()
                                ),
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                          dummyPosition()
                            ),
                          dummyPosition()
                            ),
                          dummyPosition()
                            ),
                          dummyPosition()
                            ),
                          new VarDeclaration(
                              new Identifier(
                                "d",
                                dummyPosition()
                                ),
                              new SimpleTypeDenoter(
                                new Identifier(
                                  "Date",
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                              dummyPosition()
                              ),
                          dummyPosition()
                            ),
                          new ProcDeclaration(
                              new Identifier(
                                "readdate",
                                dummyPosition()
                                ),
                              new SingleFormalParameterSequence(
                                new VarFormalParameter(
                                  new Identifier(
                                    "d",
                                    dummyPosition()
                                    ),
                                  new SimpleTypeDenoter(
                                    new Identifier(
                                      "Date",
                                      dummyPosition()
                                      ),
                                    dummyPosition()
                                    ),
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                              new SequentialCommand(
                                  new SequentialCommand(
                                    new CallCommand(
                                      new Identifier(
                                        "getint",
                                        dummyPosition()
                                        ),
                                      new SingleActualParameterSequence(
                                        new VarActualParameter(
                                          new DotVname(
                                            new SimpleVname(
                                              new Identifier(
                                                "d",
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            new Identifier(
                                              "y",
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                        ),
                                      new CallCommand(
                                          new Identifier(
                                            "getint",
                                            dummyPosition()
                                            ),
                                          new SingleActualParameterSequence(
                                            new VarActualParameter(
                                              new DotVname(
                                                new SimpleVname(
                                                  new Identifier(
                                                    "d",
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                                new Identifier(
                                                  "m",
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                            ),
                                          dummyPosition()
                                            ),
                                          new CallCommand(
                                              new Identifier(
                                                "getint",
                                                dummyPosition()
                                                ),
                                              new SingleActualParameterSequence(
                                                new VarActualParameter(
                                                  new DotVname(
                                                    new SimpleVname(
                                                      new Identifier(
                                                        "d",
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                    new Identifier(
                                                      "d",
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                                ),
                                              dummyPosition()
                                                ),
                                              dummyPosition()
                                                ),
                                              dummyPosition()
                                                ),
                                              new FuncDeclaration(
                                                  new Identifier(
                                                    "leapyear",
                                                    dummyPosition()
                                                    ),
                                                  new SingleFormalParameterSequence(
                                                    new ConstFormalParameter(
                                                      new Identifier(
                                                        "d",
                                                        dummyPosition()
                                                        ),
                                                      new SimpleTypeDenoter(
                                                        new Identifier(
                                                          "Date",
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                                  new SimpleTypeDenoter(
                                                      new Identifier(
                                                        "Boolean",
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                  new IfExpression(
                                                      new BinaryExpression(
                                                        new BinaryExpression(
                                                          new BinaryExpression(
                                                            new BinaryExpression(
                                                              new VnameExpression(
                                                                new DotVname(
                                                                  new SimpleVname(
                                                                    new Identifier(
                                                                      "d",
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                  new Identifier(
                                                                    "y",
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              new Operator(
                                                                "//",
                                                                dummyPosition()
                                                                ),
                                                              new IntegerExpression(
                                                                  new IntegerLiteral(
                                                                    "100",
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                  ),
                                                              dummyPosition()
                                                                ),
                                                              new Operator(
                                                                  "=",
                                                                  dummyPosition()
                                                                  ),
                                                              new IntegerExpression(
                                                                  new IntegerLiteral(
                                                                    "0",
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                  ),
                                                              dummyPosition()
                                                                ),
                                                              new Operator(
                                                                  "/\\",
                                                                  dummyPosition()
                                                                  ),
                                                              new BinaryExpression(
                                                                  new BinaryExpression(
                                                                    new VnameExpression(
                                                                      new DotVname(
                                                                        new SimpleVname(
                                                                          new Identifier(
                                                                            "d",
                                                                            dummyPosition()
                                                                            ),
                                                                          dummyPosition()
                                                                          ),
                                                                        new Identifier(
                                                                          "y",
                                                                          dummyPosition()
                                                                          ),
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                                    new Operator(
                                                                      "//",
                                                                      dummyPosition()
                                                                      ),
                                                                    new IntegerExpression(
                                                                        new IntegerLiteral(
                                                                          "400",
                                                                          dummyPosition()
                                                                          ),
                                                                        dummyPosition()
                                                                        ),
                                                                    dummyPosition()
                                                                      ),
                                                                    new Operator(
                                                                        "=",
                                                                        dummyPosition()
                                                                        ),
                                                                    new IntegerExpression(
                                                                        new IntegerLiteral(
                                                                          "0",
                                                                          dummyPosition()
                                                                          ),
                                                                        dummyPosition()
                                                                        ),
                                                                    dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                      ),
                                                                    new Operator(
                                                                        "\\/",
                                                                        dummyPosition()
                                                                        ),
                                                                    new BinaryExpression(
                                                                        new BinaryExpression(
                                                                          new VnameExpression(
                                                                            new DotVname(
                                                                              new SimpleVname(
                                                                                new Identifier(
                                                                                  "d",
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              new Identifier(
                                                                                "y",
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                            ),
                                                                          new Operator(
                                                                            "//",
                                                                            dummyPosition()
                                                                            ),
                                                                          new IntegerExpression(
                                                                              new IntegerLiteral(
                                                                                "4",
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                          dummyPosition()
                                                                            ),
                                                                          new Operator(
                                                                              "=",
                                                                              dummyPosition()
                                                                              ),
                                                                          new IntegerExpression(
                                                                              new IntegerLiteral(
                                                                                "0",
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                          dummyPosition()
                                                                            ),
                                                                          dummyPosition()
                                                                            ),
                                                                          new VnameExpression(
                                                                              new SimpleVname(
                                                                                new Identifier(
                                                                                  "true",
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                          new VnameExpression(
                                                                              new SimpleVname(
                                                                                new Identifier(
                                                                                  "false",
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                          dummyPosition()
                                                                            ),
                                                                          dummyPosition()
                                                                            ),
                                                                          dummyPosition()
                                                                            ),
                                                                          new SequentialCommand(
                                                                              new CallCommand(
                                                                                new Identifier(
                                                                                  "readdate",
                                                                                  dummyPosition()
                                                                                  ),
                                                                                new SingleActualParameterSequence(
                                                                                  new VarActualParameter(
                                                                                    new SimpleVname(
                                                                                      new Identifier(
                                                                                        "d",
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                          new IfCommand(
                                                                              new CallExpression(
                                                                                new Identifier(
                                                                                  "leapyear",
                                                                                  dummyPosition()
                                                                                  ),
                                                                                new SingleActualParameterSequence(
                                                                                  new ConstActualParameter(
                                                                                    new VnameExpression(
                                                                                      new SimpleVname(
                                                                                        new Identifier(
                                                                                          "d",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                  ),
                                                                                new CallCommand(
                                                                                    new Identifier(
                                                                                      "putint",
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    new SingleActualParameterSequence(
                                                                                      new ConstActualParameter(
                                                                                        new IntegerExpression(
                                                                                          new IntegerLiteral(
                                                                                            "1",
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                                new CallCommand(
                                                                                    new Identifier(
                                                                                      "putint",
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    new SingleActualParameterSequence(
                                                                                      new ConstActualParameter(
                                                                                        new IntegerExpression(
                                                                                          new IntegerLiteral(
                                                                                            "0",
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                                dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                  );

    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }

  public void testPrintArray() {
    String filename = "samples/source/print_array.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram =
      new Program(
          new LetCommand(
            new SequentialDeclaration(
              new SequentialDeclaration(
                new VarDeclaration(
                  new Identifier(
                    "arr",
                    dummyPosition()
                    ),
                  new ArrayTypeDenoter(
                    new IntegerLiteral(
                      "5",
                      dummyPosition()
                      ),
                    new SimpleTypeDenoter(
                      new Identifier(
                        "Integer",
                        dummyPosition()
                        ),
                      dummyPosition()
                      ),
                    dummyPosition()
                    ),
                  dummyPosition()
                  ),
                  new ProcDeclaration(
                      new Identifier(
                        "println",
                        dummyPosition()
                        ),
                      new SingleFormalParameterSequence(
                        new ConstFormalParameter(
                          new Identifier(
                            "x",
                            dummyPosition()
                            ),
                          new SimpleTypeDenoter(
                            new Identifier(
                              "Integer",
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                          dummyPosition()
                          ),
                        dummyPosition()
                        ),
                      new SequentialCommand(
                          new CallCommand(
                            new Identifier(
                              "putint",
                              dummyPosition()
                              ),
                            new SingleActualParameterSequence(
                              new ConstActualParameter(
                                new VnameExpression(
                                  new SimpleVname(
                                    new Identifier(
                                      "x",
                                      dummyPosition()
                                      ),
                                    dummyPosition()
                                    ),
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                              dummyPosition()
                              ),
                            dummyPosition()
                              ),
                            new CallCommand(
                                new Identifier(
                                  "puteol",
                                  dummyPosition()
                                  ),
                                new EmptyActualParameterSequence(
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                            dummyPosition()
                              ),
                            dummyPosition()
                              ),
                            dummyPosition()
                              ),
                            new ProcDeclaration(
                                new Identifier(
                                  "iterate",
                                  dummyPosition()
                                  ),
                                new MultipleFormalParameterSequence(
                                  new ProcFormalParameter(
                                    new Identifier(
                                      "f",
                                      dummyPosition()
                                      ),
                                    new SingleFormalParameterSequence(
                                      new ConstFormalParameter(
                                        new Identifier(
                                          "n",
                                          dummyPosition()
                                          ),
                                        new SimpleTypeDenoter(
                                          new Identifier(
                                            "Integer",
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                      ),
                                    dummyPosition()
                                      ),
                                    new SingleFormalParameterSequence(
                                        new ConstFormalParameter(
                                          new Identifier(
                                            "arr",
                                            dummyPosition()
                                            ),
                                          new ArrayTypeDenoter(
                                            new IntegerLiteral(
                                              "5",
                                              dummyPosition()
                                              ),
                                            new SimpleTypeDenoter(
                                              new Identifier(
                                                "Integer",
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                          dummyPosition()
                                            ),
                                          dummyPosition()
                                            ),
                                          new LetCommand(
                                              new VarDeclaration(
                                                new Identifier(
                                                  "i",
                                                  dummyPosition()
                                                  ),
                                                new SimpleTypeDenoter(
                                                  new Identifier(
                                                    "Integer",
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                ),
                                              new SequentialCommand(
                                                new AssignCommand(
                                                  new SimpleVname(
                                                    new Identifier(
                                                      "i",
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                                  new IntegerExpression(
                                                    new IntegerLiteral(
                                                      "0",
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                                new WhileCommand(
                                                  new BinaryExpression(
                                                    new VnameExpression(
                                                      new SimpleVname(
                                                        new Identifier(
                                                          "i",
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                    new Operator(
                                                      "<",
                                                      dummyPosition()
                                                      ),
                                                    new IntegerExpression(
                                                      new IntegerLiteral(
                                                        "5",
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                      ),
                                                    new SequentialCommand(
                                                        new CallCommand(
                                                          new Identifier(
                                                            "f",
                                                            dummyPosition()
                                                            ),
                                                          new SingleActualParameterSequence(
                                                            new ConstActualParameter(
                                                              new VnameExpression(
                                                                new SubscriptVname(
                                                                  new SimpleVname(
                                                                    new Identifier(
                                                                      "arr",
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                  new VnameExpression(
                                                                    new SimpleVname(
                                                                      new Identifier(
                                                                        "i",
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                  ),
                                                    dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                      ),
                                                    new AssignCommand(
                                                        new SimpleVname(
                                                          new Identifier(
                                                            "i",
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        new BinaryExpression(
                                                          new VnameExpression(
                                                            new SimpleVname(
                                                              new Identifier(
                                                                "i",
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                          new Operator(
                                                            "+",
                                                            dummyPosition()
                                                            ),
                                                          new IntegerExpression(
                                                            new IntegerLiteral(
                                                              "1",
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                            ),
                                                          new LetCommand(
                                                              new VarDeclaration(
                                                                new Identifier(
                                                                  "i",
                                                                  dummyPosition()
                                                                  ),
                                                                new SimpleTypeDenoter(
                                                                  new Identifier(
                                                                    "Integer",
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              new SequentialCommand(
                                                                new SequentialCommand(
                                                                  new AssignCommand(
                                                                    new SimpleVname(
                                                                      new Identifier(
                                                                        "i",
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                                    new IntegerExpression(
                                                                      new IntegerLiteral(
                                                                        "0",
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                  new WhileCommand(
                                                                    new BinaryExpression(
                                                                      new VnameExpression(
                                                                        new SimpleVname(
                                                                          new Identifier(
                                                                            "i",
                                                                            dummyPosition()
                                                                            ),
                                                                          dummyPosition()
                                                                          ),
                                                                        dummyPosition()
                                                                        ),
                                                                      new Operator(
                                                                        "<",
                                                                        dummyPosition()
                                                                        ),
                                                                      new IntegerExpression(
                                                                        new IntegerLiteral(
                                                                          "5",
                                                                          dummyPosition()
                                                                          ),
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                        ),
                                                                      new SequentialCommand(
                                                                          new AssignCommand(
                                                                            new SubscriptVname(
                                                                              new SimpleVname(
                                                                                new Identifier(
                                                                                  "arr",
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              new VnameExpression(
                                                                                new SimpleVname(
                                                                                  new Identifier(
                                                                                    "i",
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                      new BinaryExpression(
                                                                          new BinaryExpression(
                                                                            new VnameExpression(
                                                                              new SimpleVname(
                                                                                new Identifier(
                                                                                  "i",
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            new Operator(
                                                                              "+",
                                                                              dummyPosition()
                                                                              ),
                                                                            new IntegerExpression(
                                                                              new IntegerLiteral(
                                                                                "1",
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                              ),
                                                                            new Operator(
                                                                                "*",
                                                                                dummyPosition()
                                                                                ),
                                                                            new IntegerExpression(
                                                                                new IntegerLiteral(
                                                                                  "100",
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                            dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                              ),
                                                                            new AssignCommand(
                                                                                new SimpleVname(
                                                                                  new Identifier(
                                                                                    "i",
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                  ),
                                                                                new BinaryExpression(
                                                                                  new VnameExpression(
                                                                                    new SimpleVname(
                                                                                      new Identifier(
                                                                                        "i",
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  new Operator(
                                                                                    "+",
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  new IntegerExpression(
                                                                                    new IntegerLiteral(
                                                                                      "1",
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  new CallCommand(
                                                                                      new Identifier(
                                                                                        "iterate",
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      new MultipleActualParameterSequence(
                                                                                        new ProcActualParameter(
                                                                                          new Identifier(
                                                                                            "println",
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        new SingleActualParameterSequence(
                                                                                          new ConstActualParameter(
                                                                                            new VnameExpression(
                                                                                              new SimpleVname(
                                                                                                new Identifier(
                                                                                                  "arr",
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                          );

    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }

  public void testDate() {
    String filename = "samples/source/date.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram =
      new Program(
          new LetCommand(
            new SequentialDeclaration(
              new SequentialDeclaration(
                new SequentialDeclaration(
                  new TypeDeclaration(
                    new Identifier(
                      "Date",
                      dummyPosition()
                      ),
                    new RecordTypeDenoter(
                      new MultipleFieldTypeDenoter(
                        new Identifier(
                          "y",
                          dummyPosition()
                          ),
                        new SimpleTypeDenoter(
                          new Identifier(
                            "Integer",
                            dummyPosition()
                            ),
                          dummyPosition()
                          ),
                        new MultipleFieldTypeDenoter(
                          new Identifier(
                            "m",
                            dummyPosition()
                            ),
                          new SimpleTypeDenoter(
                            new Identifier(
                              "Integer",
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                          new SingleFieldTypeDenoter(
                            new Identifier(
                              "d",
                              dummyPosition()
                              ),
                            new SimpleTypeDenoter(
                              new Identifier(
                                "Integer",
                                dummyPosition()
                                ),
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                          dummyPosition()
                            ),
                          dummyPosition()
                            ),
                          dummyPosition()
                            ),
                          dummyPosition()
                            ),
                          new ProcDeclaration(
                              new Identifier(
                                "displaydate",
                                dummyPosition()
                                ),
                              new SingleFormalParameterSequence(
                                new ConstFormalParameter(
                                  new Identifier(
                                    "d",
                                    dummyPosition()
                                    ),
                                  new SimpleTypeDenoter(
                                    new Identifier(
                                      "Date",
                                      dummyPosition()
                                      ),
                                    dummyPosition()
                                    ),
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                              new SequentialCommand(
                                  new SequentialCommand(
                                    new SequentialCommand(
                                      new SequentialCommand(
                                        new SequentialCommand(
                                          new SequentialCommand(
                                            new CallCommand(
                                              new Identifier(
                                                "puteol",
                                                dummyPosition()
                                                ),
                                              new EmptyActualParameterSequence(
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            new CallCommand(
                                              new Identifier(
                                                "puteol",
                                                dummyPosition()
                                                ),
                                              new EmptyActualParameterSequence(
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                              ),
                                            new CallCommand(
                                                new Identifier(
                                                  "putint",
                                                  dummyPosition()
                                                  ),
                                                new SingleActualParameterSequence(
                                                  new ConstActualParameter(
                                                    new VnameExpression(
                                                      new DotVname(
                                                        new SimpleVname(
                                                          new Identifier(
                                                            "d",
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        new Identifier(
                                                          "y",
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                            dummyPosition()
                                              ),
                                            dummyPosition()
                                              ),
                                            dummyPosition()
                                              ),
                                            new CallCommand(
                                                new Identifier(
                                                  "puteol",
                                                  dummyPosition()
                                                  ),
                                                new EmptyActualParameterSequence(
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                ),
                                            dummyPosition()
                                              ),
                                            new CallCommand(
                                                new Identifier(
                                                  "putint",
                                                  dummyPosition()
                                                  ),
                                                new SingleActualParameterSequence(
                                                  new ConstActualParameter(
                                                    new VnameExpression(
                                                      new DotVname(
                                                        new SimpleVname(
                                                          new Identifier(
                                                            "d",
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        new Identifier(
                                                          "m",
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                            dummyPosition()
                                              ),
                                            dummyPosition()
                                              ),
                                            dummyPosition()
                                              ),
                                            new CallCommand(
                                                new Identifier(
                                                  "puteol",
                                                  dummyPosition()
                                                  ),
                                                new EmptyActualParameterSequence(
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                ),
                                            dummyPosition()
                                              ),
                                            new CallCommand(
                                                new Identifier(
                                                  "putint",
                                                  dummyPosition()
                                                  ),
                                                new SingleActualParameterSequence(
                                                  new ConstActualParameter(
                                                    new VnameExpression(
                                                      new DotVname(
                                                        new SimpleVname(
                                                          new Identifier(
                                                            "d",
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        new Identifier(
                                                          "d",
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                            dummyPosition()
                                              ),
                                            dummyPosition()
                                              ),
                                            dummyPosition()
                                              ),
                                            dummyPosition()
                                              ),
                                            dummyPosition()
                                              ),
                                            new ProcDeclaration(
                                                new Identifier(
                                                  "getdate",
                                                  dummyPosition()
                                                  ),
                                                new SingleFormalParameterSequence(
                                                  new VarFormalParameter(
                                                    new Identifier(
                                                      "d",
                                                      dummyPosition()
                                                      ),
                                                    new SimpleTypeDenoter(
                                                      new Identifier(
                                                        "Date",
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                                new SequentialCommand(
                                                    new SequentialCommand(
                                                      new CallCommand(
                                                        new Identifier(
                                                          "getint",
                                                          dummyPosition()
                                                          ),
                                                        new SingleActualParameterSequence(
                                                          new VarActualParameter(
                                                            new DotVname(
                                                              new SimpleVname(
                                                                new Identifier(
                                                                  "d",
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              new Identifier(
                                                                "y",
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                          ),
                                                        new CallCommand(
                                                            new Identifier(
                                                              "getint",
                                                              dummyPosition()
                                                              ),
                                                            new SingleActualParameterSequence(
                                                              new VarActualParameter(
                                                                new DotVname(
                                                                  new SimpleVname(
                                                                    new Identifier(
                                                                      "d",
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                  new Identifier(
                                                                    "m",
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                              ),
                                                            new CallCommand(
                                                                new Identifier(
                                                                  "getint",
                                                                  dummyPosition()
                                                                  ),
                                                                new SingleActualParameterSequence(
                                                                  new VarActualParameter(
                                                                    new DotVname(
                                                                      new SimpleVname(
                                                                        new Identifier(
                                                                          "d",
                                                                          dummyPosition()
                                                                          ),
                                                                        dummyPosition()
                                                                        ),
                                                                      new Identifier(
                                                                        "d",
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                  ),
                                                                new VarDeclaration(
                                                                    new Identifier(
                                                                      "d",
                                                                      dummyPosition()
                                                                      ),
                                                                    new SimpleTypeDenoter(
                                                                      new Identifier(
                                                                        "Date",
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                dummyPosition()
                                                                  ),
                                                                new SequentialCommand(
                                                                    new SequentialCommand(
                                                                      new SequentialCommand(
                                                                        new SequentialCommand(
                                                                          new CallCommand(
                                                                            new Identifier(
                                                                              "getdate",
                                                                              dummyPosition()
                                                                              ),
                                                                            new SingleActualParameterSequence(
                                                                              new VarActualParameter(
                                                                                new SimpleVname(
                                                                                  new Identifier(
                                                                                    "d",
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                            ),
                                                                new CallCommand(
                                                                    new Identifier(
                                                                      "displaydate",
                                                                      dummyPosition()
                                                                      ),
                                                                    new SingleActualParameterSequence(
                                                                      new ConstActualParameter(
                                                                        new VnameExpression(
                                                                          new SimpleVname(
                                                                            new Identifier(
                                                                              "d",
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                            ),
                                                                          dummyPosition()
                                                                          ),
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                      ),
                                                                    new AssignCommand(
                                                                        new SimpleVname(
                                                                          new Identifier(
                                                                            "d",
                                                                            dummyPosition()
                                                                            ),
                                                                          dummyPosition()
                                                                          ),
                                                                        new RecordExpression(
                                                                          new MultipleRecordAggregate(
                                                                            new Identifier(
                                                                              "y",
                                                                              dummyPosition()
                                                                              ),
                                                                            new BinaryExpression(
                                                                              new VnameExpression(
                                                                                new DotVname(
                                                                                  new SimpleVname(
                                                                                    new Identifier(
                                                                                      "d",
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  new Identifier(
                                                                                    "y",
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              new Operator(
                                                                                "+",
                                                                                dummyPosition()
                                                                                ),
                                                                              new IntegerExpression(
                                                                                  new IntegerLiteral(
                                                                                    "1",
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                  ),
                                                                              dummyPosition()
                                                                                ),
                                                                              new MultipleRecordAggregate(
                                                                                  new Identifier(
                                                                                    "m",
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  new BinaryExpression(
                                                                                    new VnameExpression(
                                                                                      new DotVname(
                                                                                        new SimpleVname(
                                                                                          new Identifier(
                                                                                            "d",
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        new Identifier(
                                                                                          "m",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    new Operator(
                                                                                      "+",
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    new IntegerExpression(
                                                                                        new IntegerLiteral(
                                                                                          "1",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                    dummyPosition()
                                                                                      ),
                                                                                    new SingleRecordAggregate(
                                                                                        new Identifier(
                                                                                          "d",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        new BinaryExpression(
                                                                                          new VnameExpression(
                                                                                            new DotVname(
                                                                                              new SimpleVname(
                                                                                                new Identifier(
                                                                                                  "d",
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              new Identifier(
                                                                                                "d",
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          new Operator(
                                                                                            "+",
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          new IntegerExpression(
                                                                                              new IntegerLiteral(
                                                                                                "1",
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                              ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          new CallCommand(
                                                                                              new Identifier(
                                                                                                "displaydate",
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              new SingleActualParameterSequence(
                                                                                                new ConstActualParameter(
                                                                                                  new VnameExpression(
                                                                                                    new SimpleVname(
                                                                                                      new Identifier(
                                                                                                        "d",
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                                ),
                                                                                              new EmptyCommand(
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                              dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                                );

    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }

  public void testString() {
    String filename = "samples/source/string.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram =
      new Program(
          new LetCommand(
            new SequentialDeclaration(
              new SequentialDeclaration(
                new TypeDeclaration(
                  new Identifier(
                    "String",
                    dummyPosition()
                    ),
                  new RecordTypeDenoter(
                    new MultipleFieldTypeDenoter(
                      new Identifier(
                        "buf",
                        dummyPosition()
                        ),
                      new ArrayTypeDenoter(
                        new IntegerLiteral(
                          "100",
                          dummyPosition()
                          ),
                        new SimpleTypeDenoter(
                          new Identifier(
                            "Char",
                            dummyPosition()
                            ),
                          dummyPosition()
                          ),
                        dummyPosition()
                        ),
                      new SingleFieldTypeDenoter(
                        new Identifier(
                          "idx",
                          dummyPosition()
                          ),
                        new SimpleTypeDenoter(
                          new Identifier(
                            "Integer",
                            dummyPosition()
                            ),
                          dummyPosition()
                          ),
                        dummyPosition()
                        ),
                      dummyPosition()
                        ),
                      dummyPosition()
                        ),
                      dummyPosition()
                        ),
                      new ProcDeclaration(
                          new Identifier(
                            "displaystring",
                            dummyPosition()
                            ),
                          new SingleFormalParameterSequence(
                            new ConstFormalParameter(
                              new Identifier(
                                "s",
                                dummyPosition()
                                ),
                              new SimpleTypeDenoter(
                                new Identifier(
                                  "String",
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                          new LetCommand(
                              new VarDeclaration(
                                new Identifier(
                                  "i",
                                  dummyPosition()
                                  ),
                                new SimpleTypeDenoter(
                                  new Identifier(
                                    "Integer",
                                    dummyPosition()
                                    ),
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                              new SequentialCommand(
                                new SequentialCommand(
                                  new SequentialCommand(
                                    new CallCommand(
                                      new Identifier(
                                        "puteol",
                                        dummyPosition()
                                        ),
                                      new EmptyActualParameterSequence(
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                      ),
                                    new AssignCommand(
                                      new SimpleVname(
                                        new Identifier(
                                          "i",
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                        ),
                                      new IntegerExpression(
                                        new IntegerLiteral(
                                          "0",
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                      ),
                                    dummyPosition()
                                      ),
                                    new WhileCommand(
                                        new BinaryExpression(
                                          new VnameExpression(
                                            new SimpleVname(
                                              new Identifier(
                                                "i",
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          new Operator(
                                            "<",
                                            dummyPosition()
                                            ),
                                          new VnameExpression(
                                            new DotVname(
                                              new SimpleVname(
                                                new Identifier(
                                                  "s",
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                ),
                                              new Identifier(
                                                "idx",
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                            ),
                                          new SequentialCommand(
                                              new CallCommand(
                                                new Identifier(
                                                  "put",
                                                  dummyPosition()
                                                  ),
                                                new SingleActualParameterSequence(
                                                  new ConstActualParameter(
                                                    new VnameExpression(
                                                      new SubscriptVname(
                                                        new DotVname(
                                                          new SimpleVname(
                                                            new Identifier(
                                                              "s",
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                          new Identifier(
                                                            "buf",
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        new VnameExpression(
                                                          new SimpleVname(
                                                            new Identifier(
                                                              "i",
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                          ),
                                                        new AssignCommand(
                                                            new SimpleVname(
                                                              new Identifier(
                                                                "i",
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            new BinaryExpression(
                                                              new VnameExpression(
                                                                new SimpleVname(
                                                                  new Identifier(
                                                                    "i",
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              new Operator(
                                                                "+",
                                                                dummyPosition()
                                                                ),
                                                              new IntegerExpression(
                                                                new IntegerLiteral(
                                                                  "1",
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                                ),
                                                              new EmptyCommand(
                                                                  dummyPosition()
                                                                  ),
                                                              dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                                ),
                                                              new ProcDeclaration(
                                                                  new Identifier(
                                                                    "readstring",
                                                                    dummyPosition()
                                                                    ),
                                                                  new SingleFormalParameterSequence(
                                                                    new VarFormalParameter(
                                                                      new Identifier(
                                                                        "s",
                                                                        dummyPosition()
                                                                        ),
                                                                      new SimpleTypeDenoter(
                                                                        new Identifier(
                                                                          "String",
                                                                          dummyPosition()
                                                                          ),
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                  new WhileCommand(
                                                                      new UnaryExpression(
                                                                        new Operator(
                                                                          "\\",
                                                                          dummyPosition()
                                                                          ),
                                                                        new CallExpression(
                                                                          new Identifier(
                                                                            "eol",
                                                                            dummyPosition()
                                                                            ),
                                                                          new EmptyActualParameterSequence(
                                                                            dummyPosition()
                                                                            ),
                                                                          dummyPosition()
                                                                          ),
                                                                        dummyPosition()
                                                                        ),
                                                                      new SequentialCommand(
                                                                        new SequentialCommand(
                                                                          new CallCommand(
                                                                            new Identifier(
                                                                              "get",
                                                                              dummyPosition()
                                                                              ),
                                                                            new SingleActualParameterSequence(
                                                                              new VarActualParameter(
                                                                                new SubscriptVname(
                                                                                  new DotVname(
                                                                                    new SimpleVname(
                                                                                      new Identifier(
                                                                                        "s",
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    new Identifier(
                                                                                      "buf",
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  new VnameExpression(
                                                                                    new DotVname(
                                                                                      new SimpleVname(
                                                                                        new Identifier(
                                                                                          "s",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      new Identifier(
                                                                                        "idx",
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  new AssignCommand(
                                                                                      new DotVname(
                                                                                        new SimpleVname(
                                                                                          new Identifier(
                                                                                            "s",
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        new Identifier(
                                                                                          "idx",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      new BinaryExpression(
                                                                                        new VnameExpression(
                                                                                          new DotVname(
                                                                                            new SimpleVname(
                                                                                              new Identifier(
                                                                                                "s",
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            new Identifier(
                                                                                              "idx",
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        new Operator(
                                                                                          "+",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        new IntegerExpression(
                                                                                            new IntegerLiteral(
                                                                                              "1",
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                            ),
                                                                                        dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                          ),
                                                                                        new EmptyCommand(
                                                                                            dummyPosition()
                                                                                            ),
                                                                                        dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                          ),
                                                                                        new LetCommand(
                                                                                            new VarDeclaration(
                                                                                              new Identifier(
                                                                                                "s",
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              new SimpleTypeDenoter(
                                                                                                new Identifier(
                                                                                                  "String",
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            new SequentialCommand(
                                                                                              new CallCommand(
                                                                                                new Identifier(
                                                                                                  "readstring",
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                new SingleActualParameterSequence(
                                                                                                  new VarActualParameter(
                                                                                                    new SimpleVname(
                                                                                                      new Identifier(
                                                                                                        "s",
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                dummyPosition()
                                                                                                ),
                                                                                        new CallCommand(
                                                                                            new Identifier(
                                                                                              "displaystring",
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            new SingleActualParameterSequence(
                                                                                              new ConstActualParameter(
                                                                                                new VnameExpression(
                                                                                                  new SimpleVname(
                                                                                                    new Identifier(
                                                                                                      "s",
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                              );

    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }

  public void testIteratively() {
    String filename = "samples/source/iteratively.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram =
      new Program(
          new LetCommand(
            new SequentialDeclaration(
              new SequentialDeclaration(
                new SequentialDeclaration(
                  new ProcDeclaration(
                    new Identifier(
                      "iteratively",
                      dummyPosition()
                      ),
                    new MultipleFormalParameterSequence(
                      new ProcFormalParameter(
                        new Identifier(
                          "p",
                          dummyPosition()
                          ),
                        new SingleFormalParameterSequence(
                          new ConstFormalParameter(
                            new Identifier(
                              "n",
                              dummyPosition()
                              ),
                            new SimpleTypeDenoter(
                              new Identifier(
                                "Integer",
                                dummyPosition()
                                ),
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                          dummyPosition()
                          ),
                        dummyPosition()
                          ),
                        new SingleFormalParameterSequence(
                            new VarFormalParameter(
                              new Identifier(
                                "arr",
                                dummyPosition()
                                ),
                              new ArrayTypeDenoter(
                                new IntegerLiteral(
                                  "10",
                                  dummyPosition()
                                  ),
                                new SimpleTypeDenoter(
                                  new Identifier(
                                    "Integer",
                                    dummyPosition()
                                    ),
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                              dummyPosition()
                              ),
                              dummyPosition()
                                ),
                              dummyPosition()
                                ),
                              new LetCommand(
                                  new VarDeclaration(
                                    new Identifier(
                                      "i",
                                      dummyPosition()
                                      ),
                                    new SimpleTypeDenoter(
                                      new Identifier(
                                        "Integer",
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                      ),
                                    dummyPosition()
                                    ),
                                  new SequentialCommand(
                                    new AssignCommand(
                                      new SimpleVname(
                                        new Identifier(
                                          "i",
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                        ),
                                      new IntegerExpression(
                                        new IntegerLiteral(
                                          "0",
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                      ),
                                    new WhileCommand(
                                      new BinaryExpression(
                                        new VnameExpression(
                                          new SimpleVname(
                                            new Identifier(
                                              "i",
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                        new Operator(
                                          "<",
                                          dummyPosition()
                                          ),
                                        new IntegerExpression(
                                          new IntegerLiteral(
                                            "10",
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                          ),
                                        new SequentialCommand(
                                            new CallCommand(
                                              new Identifier(
                                                "p",
                                                dummyPosition()
                                                ),
                                              new SingleActualParameterSequence(
                                                new ConstActualParameter(
                                                  new VnameExpression(
                                                    new SubscriptVname(
                                                      new SimpleVname(
                                                        new Identifier(
                                                          "arr",
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      new VnameExpression(
                                                        new SimpleVname(
                                                          new Identifier(
                                                            "i",
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                        dummyPosition()
                                          ),
                                        dummyPosition()
                                          ),
                                        dummyPosition()
                                          ),
                                        dummyPosition()
                                          ),
                                        new AssignCommand(
                                            new SimpleVname(
                                              new Identifier(
                                                "i",
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            new BinaryExpression(
                                              new VnameExpression(
                                                new SimpleVname(
                                                  new Identifier(
                                                    "i",
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                ),
                                              new Operator(
                                                "+",
                                                dummyPosition()
                                                ),
                                              new IntegerExpression(
                                                new IntegerLiteral(
                                                  "1",
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                                ),
                                              dummyPosition()
                                                ),
                                              dummyPosition()
                                                ),
                                              dummyPosition()
                                                ),
                                              dummyPosition()
                                                ),
                                              dummyPosition()
                                                ),
                                              dummyPosition()
                                                ),
                                              new ProcDeclaration(
                                                  new Identifier(
                                                    "readnums",
                                                    dummyPosition()
                                                    ),
                                                  new SingleFormalParameterSequence(
                                                    new VarFormalParameter(
                                                      new Identifier(
                                                        "a",
                                                        dummyPosition()
                                                        ),
                                                      new ArrayTypeDenoter(
                                                        new IntegerLiteral(
                                                          "10",
                                                          dummyPosition()
                                                          ),
                                                        new SimpleTypeDenoter(
                                                          new Identifier(
                                                            "Integer",
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                      dummyPosition()
                                                        ),
                                                      new LetCommand(
                                                          new VarDeclaration(
                                                            new Identifier(
                                                              "i",
                                                              dummyPosition()
                                                              ),
                                                            new SimpleTypeDenoter(
                                                              new Identifier(
                                                                "Integer",
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                          new SequentialCommand(
                                                            new AssignCommand(
                                                              new SimpleVname(
                                                                new Identifier(
                                                                  "i",
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              new IntegerExpression(
                                                                new IntegerLiteral(
                                                                  "0",
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            new WhileCommand(
                                                              new BinaryExpression(
                                                                new VnameExpression(
                                                                  new SimpleVname(
                                                                    new Identifier(
                                                                      "i",
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                  ),
                                                                new Operator(
                                                                  "<",
                                                                  dummyPosition()
                                                                  ),
                                                                new IntegerExpression(
                                                                  new IntegerLiteral(
                                                                    "10",
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                  ),
                                                                new SequentialCommand(
                                                                    new CallCommand(
                                                                      new Identifier(
                                                                        "getint",
                                                                        dummyPosition()
                                                                        ),
                                                                      new SingleActualParameterSequence(
                                                                        new VarActualParameter(
                                                                          new SubscriptVname(
                                                                            new SimpleVname(
                                                                              new Identifier(
                                                                                "a",
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            new VnameExpression(
                                                                              new SimpleVname(
                                                                                new Identifier(
                                                                                  "i",
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                            ),
                                                                      dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                        ),
                                                                      new AssignCommand(
                                                                          new SimpleVname(
                                                                            new Identifier(
                                                                              "i",
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                            ),
                                                                          new BinaryExpression(
                                                                            new VnameExpression(
                                                                              new SimpleVname(
                                                                                new Identifier(
                                                                                  "i",
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            new Operator(
                                                                              "+",
                                                                              dummyPosition()
                                                                              ),
                                                                            new IntegerExpression(
                                                                              new IntegerLiteral(
                                                                                "1",
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                              ),
                                                                            new ProcDeclaration(
                                                                                new Identifier(
                                                                                  "putintln",
                                                                                  dummyPosition()
                                                                                  ),
                                                                                new SingleFormalParameterSequence(
                                                                                  new ConstFormalParameter(
                                                                                    new Identifier(
                                                                                      "n",
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    new SimpleTypeDenoter(
                                                                                      new Identifier(
                                                                                        "Integer",
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                  ),
                                                                                new SequentialCommand(
                                                                                    new CallCommand(
                                                                                      new Identifier(
                                                                                        "putint",
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      new SingleActualParameterSequence(
                                                                                        new ConstActualParameter(
                                                                                          new VnameExpression(
                                                                                            new SimpleVname(
                                                                                              new Identifier(
                                                                                                "n",
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                        ),
                                                                                      new CallCommand(
                                                                                          new Identifier(
                                                                                            "puteol",
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          new EmptyActualParameterSequence(
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                          ),
                                                                                      dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                        ),
                                                                                      new VarDeclaration(
                                                                                          new Identifier(
                                                                                            "a",
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          new ArrayTypeDenoter(
                                                                                            new IntegerLiteral(
                                                                                              "10",
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            new SimpleTypeDenoter(
                                                                                              new Identifier(
                                                                                                "Integer",
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                          ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          new SequentialCommand(
                                                                                              new SequentialCommand(
                                                                                                new SequentialCommand(
                                                                                                  new CallCommand(
                                                                                                    new Identifier(
                                                                                                      "readnums",
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    new SingleActualParameterSequence(
                                                                                                      new VarActualParameter(
                                                                                                        new SimpleVname(
                                                                                                          new Identifier(
                                                                                                            "a",
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                          new CallCommand(
                                                                                              new Identifier(
                                                                                                "iteratively",
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              new MultipleActualParameterSequence(
                                                                                                new ProcActualParameter(
                                                                                                  new Identifier(
                                                                                                    "putint",
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                new SingleActualParameterSequence(
                                                                                                  new VarActualParameter(
                                                                                                    new SimpleVname(
                                                                                                      new Identifier(
                                                                                                        "a",
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                dummyPosition()
                                                                                                  ),
                                                                                                dummyPosition()
                                                                                                  ),
                                                                                                dummyPosition()
                                                                                                  ),
                                                                                                new CallCommand(
                                                                                                    new Identifier(
                                                                                                      "puteol",
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    new EmptyActualParameterSequence(
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                dummyPosition()
                                                                                                  ),
                                                                                                new CallCommand(
                                                                                                    new Identifier(
                                                                                                      "iteratively",
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    new MultipleActualParameterSequence(
                                                                                                      new ProcActualParameter(
                                                                                                        new Identifier(
                                                                                                          "putintln",
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      new SingleActualParameterSequence(
                                                                                                        new VarActualParameter(
                                                                                                          new SimpleVname(
                                                                                                            new Identifier(
                                                                                                              "a",
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        );

    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }

  public void testReverseLine() {
    String filename = "samples/source/reverse_line.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram =
      new Program(
          new LetCommand(
            new SequentialDeclaration(
              new SequentialDeclaration(
                new SequentialDeclaration(
                  new TypeDeclaration(
                    new Identifier(
                      "Line",
                      dummyPosition()
                      ),
                    new RecordTypeDenoter(
                      new MultipleFieldTypeDenoter(
                        new Identifier(
                          "length",
                          dummyPosition()
                          ),
                        new SimpleTypeDenoter(
                          new Identifier(
                            "Integer",
                            dummyPosition()
                            ),
                          dummyPosition()
                          ),
                        new SingleFieldTypeDenoter(
                          new Identifier(
                            "content",
                            dummyPosition()
                            ),
                          new ArrayTypeDenoter(
                            new IntegerLiteral(
                              "80",
                              dummyPosition()
                              ),
                            new SimpleTypeDenoter(
                              new Identifier(
                                "Char",
                                dummyPosition()
                                ),
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                          dummyPosition()
                          ),
                          dummyPosition()
                            ),
                          dummyPosition()
                            ),
                          dummyPosition()
                            ),
                          new ProcDeclaration(
                              new Identifier(
                                "getline",
                                dummyPosition()
                                ),
                              new SingleFormalParameterSequence(
                                new VarFormalParameter(
                                  new Identifier(
                                    "l",
                                    dummyPosition()
                                    ),
                                  new SimpleTypeDenoter(
                                    new Identifier(
                                      "Line",
                                      dummyPosition()
                                      ),
                                    dummyPosition()
                                    ),
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                              new SequentialCommand(
                                  new SequentialCommand(
                                    new AssignCommand(
                                      new DotVname(
                                        new SimpleVname(
                                          new Identifier(
                                            "l",
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                        new Identifier(
                                          "length",
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                        ),
                                      new IntegerExpression(
                                        new IntegerLiteral(
                                          "0",
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                        ),
                                      new WhileCommand(
                                          new UnaryExpression(
                                            new Operator(
                                              "\\",
                                              dummyPosition()
                                              ),
                                            new CallExpression(
                                              new Identifier(
                                                "eol",
                                                dummyPosition()
                                                ),
                                              new EmptyActualParameterSequence(
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          new SequentialCommand(
                                            new CallCommand(
                                              new Identifier(
                                                "get",
                                                dummyPosition()
                                                ),
                                              new SingleActualParameterSequence(
                                                new VarActualParameter(
                                                  new SubscriptVname(
                                                    new DotVname(
                                                      new SimpleVname(
                                                        new Identifier(
                                                          "l",
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      new Identifier(
                                                        "content",
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                    new VnameExpression(
                                                      new DotVname(
                                                        new SimpleVname(
                                                          new Identifier(
                                                            "l",
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        new Identifier(
                                                          "length",
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                      ),
                                                    new AssignCommand(
                                                        new DotVname(
                                                          new SimpleVname(
                                                            new Identifier(
                                                              "l",
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                          new Identifier(
                                                            "length",
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        new BinaryExpression(
                                                          new VnameExpression(
                                                            new DotVname(
                                                              new SimpleVname(
                                                                new Identifier(
                                                                  "l",
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              new Identifier(
                                                                "length",
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                          new Operator(
                                                            "+",
                                                            dummyPosition()
                                                            ),
                                                          new IntegerExpression(
                                                              new IntegerLiteral(
                                                                "1",
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                          dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                            ),
                                                          new CallCommand(
                                                              new Identifier(
                                                                "geteol",
                                                                dummyPosition()
                                                                ),
                                                              new EmptyActualParameterSequence(
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                          dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                            ),
                                                          new ProcDeclaration(
                                                              new Identifier(
                                                                "putreversedline",
                                                                dummyPosition()
                                                                ),
                                                              new SingleFormalParameterSequence(
                                                                new ConstFormalParameter(
                                                                  new Identifier(
                                                                    "l",
                                                                    dummyPosition()
                                                                    ),
                                                                  new SimpleTypeDenoter(
                                                                    new Identifier(
                                                                      "Line",
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              new LetCommand(
                                                                  new VarDeclaration(
                                                                    new Identifier(
                                                                      "i",
                                                                      dummyPosition()
                                                                      ),
                                                                    new SimpleTypeDenoter(
                                                                      new Identifier(
                                                                        "Integer",
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                  new SequentialCommand(
                                                                    new SequentialCommand(
                                                                      new SequentialCommand(
                                                                        new AssignCommand(
                                                                          new SimpleVname(
                                                                            new Identifier(
                                                                              "i",
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                            ),
                                                                          new VnameExpression(
                                                                            new DotVname(
                                                                              new SimpleVname(
                                                                                new Identifier(
                                                                                  "l",
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              new Identifier(
                                                                                "length",
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                            ),
                                                                          dummyPosition()
                                                                            ),
                                                                          new WhileCommand(
                                                                              new BinaryExpression(
                                                                                new VnameExpression(
                                                                                  new SimpleVname(
                                                                                    new Identifier(
                                                                                      "i",
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                  ),
                                                                                new Operator(
                                                                                  ">",
                                                                                  dummyPosition()
                                                                                  ),
                                                                                new IntegerExpression(
                                                                                  new IntegerLiteral(
                                                                                    "0",
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                  ),
                                                                                new SequentialCommand(
                                                                                    new AssignCommand(
                                                                                      new SimpleVname(
                                                                                        new Identifier(
                                                                                          "i",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      new BinaryExpression(
                                                                                        new VnameExpression(
                                                                                          new SimpleVname(
                                                                                            new Identifier(
                                                                                              "i",
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        new Operator(
                                                                                          "-",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        new IntegerExpression(
                                                                                          new IntegerLiteral(
                                                                                            "1",
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                          ),
                                                                                        new CallCommand(
                                                                                            new Identifier(
                                                                                              "put",
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            new SingleActualParameterSequence(
                                                                                              new ConstActualParameter(
                                                                                                new VnameExpression(
                                                                                                  new SubscriptVname(
                                                                                                    new DotVname(
                                                                                                      new SimpleVname(
                                                                                                        new Identifier(
                                                                                                          "l",
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      new Identifier(
                                                                                                        "content",
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    new VnameExpression(
                                                                                                      new SimpleVname(
                                                                                                        new Identifier(
                                                                                                          "i",
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                      ),
                                                                                                    new CallCommand(
                                                                                                        new Identifier(
                                                                                                          "puteol",
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        new EmptyActualParameterSequence(
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                    dummyPosition()
                                                                                                      ),
                                                                                                    new EmptyCommand(
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                    dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                      ),
                                                                                                    new VarDeclaration(
                                                                                                        new Identifier(
                                                                                                          "currentline",
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        new SimpleTypeDenoter(
                                                                                                          new Identifier(
                                                                                                            "Line",
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                    dummyPosition()
                                                                                                      ),
                                                                                                    new WhileCommand(
                                                                                                        new UnaryExpression(
                                                                                                          new Operator(
                                                                                                            "\\",
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          new CallExpression(
                                                                                                            new Identifier(
                                                                                                              "eof",
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            new EmptyActualParameterSequence(
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        new SequentialCommand(
                                                                                                          new CallCommand(
                                                                                                            new Identifier(
                                                                                                              "getline",
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            new SingleActualParameterSequence(
                                                                                                              new VarActualParameter(
                                                                                                                new SimpleVname(
                                                                                                                  new Identifier(
                                                                                                                    "currentline",
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                  ),
                                                                                                                dummyPosition()
                                                                                                                ),
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                    new CallCommand(
                                                                                                        new Identifier(
                                                                                                          "putreversedline",
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        new SingleActualParameterSequence(
                                                                                                          new ConstActualParameter(
                                                                                                            new VnameExpression(
                                                                                                              new SimpleVname(
                                                                                                                new Identifier(
                                                                                                                  "currentline",
                                                                                                                  dummyPosition()
                                                                                                                  ),
                                                                                                                dummyPosition()
                                                                                                                ),
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                          );
    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }

  public void testLine() {
    String filename = "samples/source/line.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram =
      new Program(
          new LetCommand(
            new SequentialDeclaration(
              new SequentialDeclaration(
                new SequentialDeclaration(
                  new SequentialDeclaration(
                    new TypeDeclaration(
                      new Identifier(
                        "Line",
                        dummyPosition()
                        ),
                      new RecordTypeDenoter(
                        new MultipleFieldTypeDenoter(
                          new Identifier(
                            "length",
                            dummyPosition()
                            ),
                          new SimpleTypeDenoter(
                            new Identifier(
                              "Integer",
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                          new SingleFieldTypeDenoter(
                            new Identifier(
                              "content",
                              dummyPosition()
                              ),
                            new ArrayTypeDenoter(
                              new IntegerLiteral(
                                "80",
                                dummyPosition()
                                ),
                              new SimpleTypeDenoter(
                                new Identifier(
                                  "Char",
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                            dummyPosition()
                              ),
                            dummyPosition()
                              ),
                            dummyPosition()
                              ),
                            new ProcDeclaration(
                                new Identifier(
                                  "getline",
                                  dummyPosition()
                                  ),
                                new SingleFormalParameterSequence(
                                  new VarFormalParameter(
                                    new Identifier(
                                      "l",
                                      dummyPosition()
                                      ),
                                    new SimpleTypeDenoter(
                                      new Identifier(
                                        "Line",
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                      ),
                                    dummyPosition()
                                    ),
                                  dummyPosition()
                                  ),
                                new SequentialCommand(
                                    new SequentialCommand(
                                      new AssignCommand(
                                        new DotVname(
                                          new SimpleVname(
                                            new Identifier(
                                              "l",
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          new Identifier(
                                            "length",
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                        new IntegerExpression(
                                          new IntegerLiteral(
                                            "0",
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                          ),
                                        new WhileCommand(
                                            new UnaryExpression(
                                              new Operator(
                                                "\\",
                                                dummyPosition()
                                                ),
                                              new CallExpression(
                                                new Identifier(
                                                  "eol",
                                                  dummyPosition()
                                                  ),
                                                new EmptyActualParameterSequence(
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            new SequentialCommand(
                                              new SequentialCommand(
                                                new CallCommand(
                                                  new Identifier(
                                                    "get",
                                                    dummyPosition()
                                                    ),
                                                  new SingleActualParameterSequence(
                                                    new VarActualParameter(
                                                      new SubscriptVname(
                                                        new DotVname(
                                                          new SimpleVname(
                                                            new Identifier(
                                                              "l",
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                          new Identifier(
                                                            "content",
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        new VnameExpression(
                                                          new DotVname(
                                                            new SimpleVname(
                                                              new Identifier(
                                                                "l",
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            new Identifier(
                                                              "length",
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                          ),
                                                        new AssignCommand(
                                                            new DotVname(
                                                              new SimpleVname(
                                                                new Identifier(
                                                                  "l",
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              new Identifier(
                                                                "length",
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            new BinaryExpression(
                                                              new VnameExpression(
                                                                new DotVname(
                                                                  new SimpleVname(
                                                                    new Identifier(
                                                                      "l",
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                  new Identifier(
                                                                    "length",
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              new Operator(
                                                                "+",
                                                                dummyPosition()
                                                                ),
                                                              new IntegerExpression(
                                                                  new IntegerLiteral(
                                                                    "1",
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                  ),
                                                              dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                                ),
                                                              new EmptyCommand(
                                                                  dummyPosition()
                                                                  ),
                                                              dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                                ),
                                                              new EmptyCommand(
                                                                  dummyPosition()
                                                                  ),
                                                              dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                                ),
                                                              new ProcDeclaration(
                                                                  new Identifier(
                                                                    "putline",
                                                                    dummyPosition()
                                                                    ),
                                                                  new SingleFormalParameterSequence(
                                                                    new ConstFormalParameter(
                                                                      new Identifier(
                                                                        "l",
                                                                        dummyPosition()
                                                                        ),
                                                                      new SimpleTypeDenoter(
                                                                        new Identifier(
                                                                          "Line",
                                                                          dummyPosition()
                                                                          ),
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                  new LetCommand(
                                                                      new VarDeclaration(
                                                                        new Identifier(
                                                                          "i",
                                                                          dummyPosition()
                                                                          ),
                                                                        new SimpleTypeDenoter(
                                                                          new Identifier(
                                                                            "Integer",
                                                                            dummyPosition()
                                                                            ),
                                                                          dummyPosition()
                                                                          ),
                                                                        dummyPosition()
                                                                        ),
                                                                      new SequentialCommand(
                                                                        new SequentialCommand(
                                                                          new AssignCommand(
                                                                            new SimpleVname(
                                                                              new Identifier(
                                                                                "i",
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            new IntegerExpression(
                                                                              new IntegerLiteral(
                                                                                "0",
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                            ),
                                                                          new WhileCommand(
                                                                            new BinaryExpression(
                                                                              new VnameExpression(
                                                                                new SimpleVname(
                                                                                  new Identifier(
                                                                                    "i",
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              new Operator(
                                                                                "<",
                                                                                dummyPosition()
                                                                                ),
                                                                              new VnameExpression(
                                                                                new DotVname(
                                                                                  new SimpleVname(
                                                                                    new Identifier(
                                                                                      "l",
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  new Identifier(
                                                                                    "length",
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                                ),
                                                                              new SequentialCommand(
                                                                                  new CallCommand(
                                                                                    new Identifier(
                                                                                      "put",
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    new SingleActualParameterSequence(
                                                                                      new ConstActualParameter(
                                                                                        new VnameExpression(
                                                                                          new SubscriptVname(
                                                                                            new DotVname(
                                                                                              new SimpleVname(
                                                                                                new Identifier(
                                                                                                  "l",
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              new Identifier(
                                                                                                "content",
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            new VnameExpression(
                                                                                              new SimpleVname(
                                                                                                new Identifier(
                                                                                                  "i",
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                              ),
                                                                                            new AssignCommand(
                                                                                                new SimpleVname(
                                                                                                  new Identifier(
                                                                                                    "i",
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                new BinaryExpression(
                                                                                                  new VnameExpression(
                                                                                                    new SimpleVname(
                                                                                                      new Identifier(
                                                                                                        "i",
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  new Operator(
                                                                                                    "+",
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  new IntegerExpression(
                                                                                                    new IntegerLiteral(
                                                                                                      "1",
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                    ),
                                                                                                  new EmptyCommand(
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                  dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                    ),
                                                                                                  new ProcDeclaration(
                                                                                                      new Identifier(
                                                                                                        "putreversedline",
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      new SingleFormalParameterSequence(
                                                                                                        new ConstFormalParameter(
                                                                                                          new Identifier(
                                                                                                            "l",
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          new SimpleTypeDenoter(
                                                                                                            new Identifier(
                                                                                                              "Line",
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      new LetCommand(
                                                                                                          new VarDeclaration(
                                                                                                            new Identifier(
                                                                                                              "i",
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            new SimpleTypeDenoter(
                                                                                                              new Identifier(
                                                                                                                "Integer",
                                                                                                                dummyPosition()
                                                                                                                ),
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          new SequentialCommand(
                                                                                                            new SequentialCommand(
                                                                                                              new AssignCommand(
                                                                                                                new SimpleVname(
                                                                                                                  new Identifier(
                                                                                                                    "i",
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                  ),
                                                                                                                new BinaryExpression(
                                                                                                                  new VnameExpression(
                                                                                                                    new DotVname(
                                                                                                                      new SimpleVname(
                                                                                                                        new Identifier(
                                                                                                                          "l",
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      new Identifier(
                                                                                                                        "length",
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  new Operator(
                                                                                                                    "-",
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  new IntegerExpression(
                                                                                                                      new IntegerLiteral(
                                                                                                                        "1",
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  new WhileCommand(
                                                                                                                      new BinaryExpression(
                                                                                                                        new VnameExpression(
                                                                                                                          new SimpleVname(
                                                                                                                            new Identifier(
                                                                                                                              "i",
                                                                                                                              dummyPosition()
                                                                                                                              ),
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        new Operator(
                                                                                                                          ">=",
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        new IntegerExpression(
                                                                                                                          new IntegerLiteral(
                                                                                                                            "0",
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        dummyPosition()
                                                                                                                          ),
                                                                                                                        new SequentialCommand(
                                                                                                                            new CallCommand(
                                                                                                                              new Identifier(
                                                                                                                                "put",
                                                                                                                                dummyPosition()
                                                                                                                                ),
                                                                                                                              new SingleActualParameterSequence(
                                                                                                                                new ConstActualParameter(
                                                                                                                                  new VnameExpression(
                                                                                                                                    new SubscriptVname(
                                                                                                                                      new DotVname(
                                                                                                                                        new SimpleVname(
                                                                                                                                          new Identifier(
                                                                                                                                            "l",
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                          dummyPosition()
                                                                                                                                          ),
                                                                                                                                        new Identifier(
                                                                                                                                          "content",
                                                                                                                                          dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                        ),
                                                                                                                                      new VnameExpression(
                                                                                                                                        new SimpleVname(
                                                                                                                                          new Identifier(
                                                                                                                                            "i",
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                          dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                        ),
                                                                                                                                      dummyPosition()
                                                                                                                                        ),
                                                                                                                                      dummyPosition()
                                                                                                                                        ),
                                                                                                                                      dummyPosition()
                                                                                                                                        ),
                                                                                                                                      dummyPosition()
                                                                                                                                        ),
                                                                                                                                      dummyPosition()
                                                                                                                                        ),
                                                                                                                                      new AssignCommand(
                                                                                                                                          new SimpleVname(
                                                                                                                                            new Identifier(
                                                                                                                                              "i",
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                          new BinaryExpression(
                                                                                                                                            new VnameExpression(
                                                                                                                                              new SimpleVname(
                                                                                                                                                new Identifier(
                                                                                                                                                  "i",
                                                                                                                                                  dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            new Operator(
                                                                                                                                              "-",
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            new IntegerExpression(
                                                                                                                                              new IntegerLiteral(
                                                                                                                                                "1",
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            dummyPosition()
                                                                                                                                              ),
                                                                                                                                            dummyPosition()
                                                                                                                                              ),
                                                                                                                                            dummyPosition()
                                                                                                                                              ),
                                                                                                                                            dummyPosition()
                                                                                                                                              ),
                                                                                                                                            dummyPosition()
                                                                                                                                              ),
                                                                                                                                            new EmptyCommand(
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                            dummyPosition()
                                                                                                                                              ),
                                                                                                                                            dummyPosition()
                                                                                                                                              ),
                                                                                                                                            dummyPosition()
                                                                                                                                              ),
                                                                                                                                            dummyPosition()
                                                                                                                                              ),
                                                                                                                                            new VarDeclaration(
                                                                                                                                                new Identifier(
                                                                                                                                                  "currentline",
                                                                                                                                                  dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                new SimpleTypeDenoter(
                                                                                                                                                  new Identifier(
                                                                                                                                                    "Line",
                                                                                                                                                    dummyPosition()
                                                                                                                                                    ),
                                                                                                                                                  dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                            dummyPosition()
                                                                                                                                              ),
                                                                                                                                            new SequentialCommand(
                                                                                                                                                new SequentialCommand(
                                                                                                                                                  new CallCommand(
                                                                                                                                                    new Identifier(
                                                                                                                                                      "getline",
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    new SingleActualParameterSequence(
                                                                                                                                                      new VarActualParameter(
                                                                                                                                                        new SimpleVname(
                                                                                                                                                          new Identifier(
                                                                                                                                                            "currentline",
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                    ),
                                                                                                                                            new CallCommand(
                                                                                                                                                new Identifier(
                                                                                                                                                  "putline",
                                                                                                                                                  dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                new SingleActualParameterSequence(
                                                                                                                                                  new ConstActualParameter(
                                                                                                                                                    new VnameExpression(
                                                                                                                                                      new SimpleVname(
                                                                                                                                                        new Identifier(
                                                                                                                                                          "currentline",
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                    ),
                                                                                                                                                  dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                new CallCommand(
                                                                                                                                                    new Identifier(
                                                                                                                                                      "putreversedline",
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    new SingleActualParameterSequence(
                                                                                                                                                      new ConstActualParameter(
                                                                                                                                                        new VnameExpression(
                                                                                                                                                          new SimpleVname(
                                                                                                                                                            new Identifier(
                                                                                                                                                              "currentline",
                                                                                                                                                              dummyPosition()
                                                                                                                                                              ),
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                      );

    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }

  public void testDates() {
    String filename = "samples/source/dates.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram =
      new Program(
          new LetCommand(
            new SequentialDeclaration(
              new SequentialDeclaration(
                new SequentialDeclaration(
                  new SequentialDeclaration(
                    new SequentialDeclaration(
                      new SequentialDeclaration(
                        new TypeDeclaration(
                          new Identifier(
                            "Date",
                            dummyPosition()
                            ),
                          new RecordTypeDenoter(
                            new MultipleFieldTypeDenoter(
                              new Identifier(
                                "m",
                                dummyPosition()
                                ),
                              new SimpleTypeDenoter(
                                new Identifier(
                                  "Integer",
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                              new SingleFieldTypeDenoter(
                                new Identifier(
                                  "d",
                                  dummyPosition()
                                  ),
                                new SimpleTypeDenoter(
                                  new Identifier(
                                    "Integer",
                                    dummyPosition()
                                    ),
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                              dummyPosition()
                                ),
                              dummyPosition()
                                ),
                              dummyPosition()
                                ),
                              new ConstDeclaration(
                                  new Identifier(
                                    "xmas",
                                    dummyPosition()
                                    ),
                                  new RecordExpression(
                                    new MultipleRecordAggregate(
                                      new Identifier(
                                        "m",
                                        dummyPosition()
                                        ),
                                      new IntegerExpression(
                                        new IntegerLiteral(
                                          "12",
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                        ),
                                      new SingleRecordAggregate(
                                        new Identifier(
                                          "d",
                                          dummyPosition()
                                          ),
                                        new IntegerExpression(
                                          new IntegerLiteral(
                                            "25",
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                        ),
                                      dummyPosition()
                                        ),
                                      dummyPosition()
                                        ),
                                      dummyPosition()
                                        ),
                                      new VarDeclaration(
                                          new Identifier(
                                            "easter",
                                            dummyPosition()
                                            ),
                                          new SimpleTypeDenoter(
                                            new Identifier(
                                              "Date",
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                      dummyPosition()
                                        ),
                                      new VarDeclaration(
                                          new Identifier(
                                            "holidays",
                                            dummyPosition()
                                            ),
                                          new ArrayTypeDenoter(
                                            new IntegerLiteral(
                                              "3",
                                              dummyPosition()
                                              ),
                                            new SimpleTypeDenoter(
                                              new Identifier(
                                                "Date",
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                          dummyPosition()
                                            ),
                                          new ProcDeclaration(
                                              new Identifier(
                                                "displaydate",
                                                dummyPosition()
                                                ),
                                              new SingleFormalParameterSequence(
                                                new ConstFormalParameter(
                                                  new Identifier(
                                                    "d",
                                                    dummyPosition()
                                                    ),
                                                  new SimpleTypeDenoter(
                                                    new Identifier(
                                                      "Date",
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                ),
                                              new SequentialCommand(
                                                  new SequentialCommand(
                                                    new SequentialCommand(
                                                      new CallCommand(
                                                        new Identifier(
                                                          "putint",
                                                          dummyPosition()
                                                          ),
                                                        new SingleActualParameterSequence(
                                                          new ConstActualParameter(
                                                            new VnameExpression(
                                                              new DotVname(
                                                                new SimpleVname(
                                                                  new Identifier(
                                                                    "d",
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                  ),
                                                                new Identifier(
                                                                  "m",
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                              dummyPosition()
                                                ),
                                              dummyPosition()
                                                ),
                                              new CallCommand(
                                                  new Identifier(
                                                    "put",
                                                    dummyPosition()
                                                    ),
                                                  new SingleActualParameterSequence(
                                                    new ConstActualParameter(
                                                      new CharacterExpression(
                                                        new CharacterLiteral(
                                                          "-",
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                              dummyPosition()
                                                ),
                                              new CallCommand(
                                                  new Identifier(
                                                    "putint",
                                                    dummyPosition()
                                                    ),
                                                  new SingleActualParameterSequence(
                                                    new ConstActualParameter(
                                                      new VnameExpression(
                                                        new DotVname(
                                                          new SimpleVname(
                                                            new Identifier(
                                                              "d",
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                          new Identifier(
                                                            "d",
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                              dummyPosition()
                                                ),
                                              dummyPosition()
                                                ),
                                              dummyPosition()
                                                ),
                                              new CallCommand(
                                                  new Identifier(
                                                    "puteol",
                                                    dummyPosition()
                                                    ),
                                                  new EmptyActualParameterSequence(
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                              dummyPosition()
                                                ),
                                              dummyPosition()
                                                ),
                                              dummyPosition()
                                                ),
                                              new ProcDeclaration(
                                                  new Identifier(
                                                    "readdate",
                                                    dummyPosition()
                                                    ),
                                                  new SingleFormalParameterSequence(
                                                    new VarFormalParameter(
                                                      new Identifier(
                                                        "d",
                                                        dummyPosition()
                                                        ),
                                                      new SimpleTypeDenoter(
                                                        new Identifier(
                                                          "Date",
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                                  new SequentialCommand(
                                                      new CallCommand(
                                                        new Identifier(
                                                          "getint",
                                                          dummyPosition()
                                                          ),
                                                        new SingleActualParameterSequence(
                                                          new VarActualParameter(
                                                            new DotVname(
                                                              new SimpleVname(
                                                                new Identifier(
                                                                  "d",
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              new Identifier(
                                                                "m",
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                          ),
                                                        new CallCommand(
                                                            new Identifier(
                                                              "getint",
                                                              dummyPosition()
                                                              ),
                                                            new SingleActualParameterSequence(
                                                              new VarActualParameter(
                                                                new DotVname(
                                                                  new SimpleVname(
                                                                    new Identifier(
                                                                      "d",
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                  new Identifier(
                                                                    "d",
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                              ),
                                                            new ProcDeclaration(
                                                                new Identifier(
                                                                  "readdates",
                                                                  dummyPosition()
                                                                  ),
                                                                new SingleFormalParameterSequence(
                                                                  new VarFormalParameter(
                                                                    new Identifier(
                                                                      "a",
                                                                      dummyPosition()
                                                                      ),
                                                                    new ArrayTypeDenoter(
                                                                      new IntegerLiteral(
                                                                        "3",
                                                                        dummyPosition()
                                                                        ),
                                                                      new SimpleTypeDenoter(
                                                                        new Identifier(
                                                                          "Date",
                                                                          dummyPosition()
                                                                          ),
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                    dummyPosition()
                                                                      ),
                                                                    new LetCommand(
                                                                        new VarDeclaration(
                                                                          new Identifier(
                                                                            "i",
                                                                            dummyPosition()
                                                                            ),
                                                                          new SimpleTypeDenoter(
                                                                            new Identifier(
                                                                              "Integer",
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                            ),
                                                                          dummyPosition()
                                                                          ),
                                                                        new SequentialCommand(
                                                                          new AssignCommand(
                                                                            new SimpleVname(
                                                                              new Identifier(
                                                                                "i",
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            new IntegerExpression(
                                                                              new IntegerLiteral(
                                                                                "0",
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                            ),
                                                                          new WhileCommand(
                                                                            new BinaryExpression(
                                                                              new VnameExpression(
                                                                                new SimpleVname(
                                                                                  new Identifier(
                                                                                    "i",
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              new Operator(
                                                                                "<",
                                                                                dummyPosition()
                                                                                ),
                                                                              new IntegerExpression(
                                                                                new IntegerLiteral(
                                                                                  "3",
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                                ),
                                                                              new SequentialCommand(
                                                                                  new CallCommand(
                                                                                    new Identifier(
                                                                                      "readdate",
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    new SingleActualParameterSequence(
                                                                                      new VarActualParameter(
                                                                                        new SubscriptVname(
                                                                                          new SimpleVname(
                                                                                            new Identifier(
                                                                                              "a",
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          new VnameExpression(
                                                                                            new SimpleVname(
                                                                                              new Identifier(
                                                                                                "i",
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                          ),
                                                                                    dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                      ),
                                                                                    new AssignCommand(
                                                                                        new SimpleVname(
                                                                                          new Identifier(
                                                                                            "i",
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        new BinaryExpression(
                                                                                          new VnameExpression(
                                                                                            new SimpleVname(
                                                                                              new Identifier(
                                                                                                "i",
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          new Operator(
                                                                                            "+",
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          new IntegerExpression(
                                                                                            new IntegerLiteral(
                                                                                              "1",
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          new SequentialCommand(
                                                                                              new SequentialCommand(
                                                                                                new SequentialCommand(
                                                                                                  new SequentialCommand(
                                                                                                    new SequentialCommand(
                                                                                                      new SequentialCommand(
                                                                                                        new CallCommand(
                                                                                                          new Identifier(
                                                                                                            "readdate",
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          new SingleActualParameterSequence(
                                                                                                            new VarActualParameter(
                                                                                                              new SimpleVname(
                                                                                                                new Identifier(
                                                                                                                  "easter",
                                                                                                                  dummyPosition()
                                                                                                                  ),
                                                                                                                dummyPosition()
                                                                                                                ),
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                          new CallCommand(
                                                                                              new Identifier(
                                                                                                "readdates",
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              new SingleActualParameterSequence(
                                                                                                new VarActualParameter(
                                                                                                  new SimpleVname(
                                                                                                    new Identifier(
                                                                                                      "holidays",
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                              ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          new CallCommand(
                                                                                              new Identifier(
                                                                                                "displaydate",
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              new SingleActualParameterSequence(
                                                                                                new ConstActualParameter(
                                                                                                  new VnameExpression(
                                                                                                    new SimpleVname(
                                                                                                      new Identifier(
                                                                                                        "xmas",
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                                ),
                                                                                              new CallCommand(
                                                                                                  new Identifier(
                                                                                                    "displaydate",
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  new SingleActualParameterSequence(
                                                                                                    new ConstActualParameter(
                                                                                                      new VnameExpression(
                                                                                                        new SimpleVname(
                                                                                                          new Identifier(
                                                                                                            "easter",
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                    ),
                                                                                                  new LetCommand(
                                                                                                      new VarDeclaration(
                                                                                                        new Identifier(
                                                                                                          "i",
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        new SimpleTypeDenoter(
                                                                                                          new Identifier(
                                                                                                            "Integer",
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      new SequentialCommand(
                                                                                                        new AssignCommand(
                                                                                                          new SimpleVname(
                                                                                                            new Identifier(
                                                                                                              "i",
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          new IntegerExpression(
                                                                                                            new IntegerLiteral(
                                                                                                              "0",
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        new WhileCommand(
                                                                                                          new BinaryExpression(
                                                                                                            new VnameExpression(
                                                                                                              new SimpleVname(
                                                                                                                new Identifier(
                                                                                                                  "i",
                                                                                                                  dummyPosition()
                                                                                                                  ),
                                                                                                                dummyPosition()
                                                                                                                ),
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            new Operator(
                                                                                                              "<",
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            new IntegerExpression(
                                                                                                              new IntegerLiteral(
                                                                                                                "3",
                                                                                                                dummyPosition()
                                                                                                                ),
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                              ),
                                                                                                            new SequentialCommand(
                                                                                                                new CallCommand(
                                                                                                                  new Identifier(
                                                                                                                    "displaydate",
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  new SingleActualParameterSequence(
                                                                                                                    new ConstActualParameter(
                                                                                                                      new VnameExpression(
                                                                                                                        new SubscriptVname(
                                                                                                                          new SimpleVname(
                                                                                                                            new Identifier(
                                                                                                                              "holidays",
                                                                                                                              dummyPosition()
                                                                                                                              ),
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          new VnameExpression(
                                                                                                                            new SimpleVname(
                                                                                                                              new Identifier(
                                                                                                                                "i",
                                                                                                                                dummyPosition()
                                                                                                                                ),
                                                                                                                              dummyPosition()
                                                                                                                              ),
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                            dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                              ),
                                                                                                            new AssignCommand(
                                                                                                                new SimpleVname(
                                                                                                                  new Identifier(
                                                                                                                    "i",
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                  ),
                                                                                                                new BinaryExpression(
                                                                                                                  new VnameExpression(
                                                                                                                    new SimpleVname(
                                                                                                                      new Identifier(
                                                                                                                        "i",
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  new Operator(
                                                                                                                    "+",
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  new IntegerExpression(
                                                                                                                    new IntegerLiteral(
                                                                                                                      "1",
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  new CallCommand(
                                                                                                                      new Identifier(
                                                                                                                        "displaydate",
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      new SingleActualParameterSequence(
                                                                                                                        new ConstActualParameter(
                                                                                                                          new VnameExpression(
                                                                                                                            new SubscriptVname(
                                                                                                                              new SimpleVname(
                                                                                                                                new Identifier(
                                                                                                                                  "holidays",
                                                                                                                                  dummyPosition()
                                                                                                                                  ),
                                                                                                                                dummyPosition()
                                                                                                                                ),
                                                                                                                              new IntegerExpression(
                                                                                                                                new IntegerLiteral(
                                                                                                                                  "0",
                                                                                                                                  dummyPosition()
                                                                                                                                  ),
                                                                                                                                dummyPosition()
                                                                                                                                ),
                                                                                                                              dummyPosition()
                                                                                                                              ),
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                      dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                        ),
                                                                                                                      new EmptyCommand(
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                      dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                        );

    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }

  public void testMonthsOfYear() {
    String filename = "samples/source/monthsofyear.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram =
      new Program(
          new LetCommand(
            new SequentialDeclaration(
              new SequentialDeclaration(
                new SequentialDeclaration(
                  new SequentialDeclaration(
                    new SequentialDeclaration(
                      new SequentialDeclaration(
                        new TypeDeclaration(
                          new Identifier(
                            "Date",
                            dummyPosition()
                            ),
                          new RecordTypeDenoter(
                            new MultipleFieldTypeDenoter(
                              new Identifier(
                                "y",
                                dummyPosition()
                                ),
                              new SimpleTypeDenoter(
                                new Identifier(
                                  "Integer",
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                              new MultipleFieldTypeDenoter(
                                new Identifier(
                                  "m",
                                  dummyPosition()
                                  ),
                                new SimpleTypeDenoter(
                                  new Identifier(
                                    "Integer",
                                    dummyPosition()
                                    ),
                                  dummyPosition()
                                  ),
                                new SingleFieldTypeDenoter(
                                  new Identifier(
                                    "d",
                                    dummyPosition()
                                    ),
                                  new SimpleTypeDenoter(
                                    new Identifier(
                                      "Integer",
                                      dummyPosition()
                                      ),
                                    dummyPosition()
                                    ),
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                  ),
                                dummyPosition()
                                  ),
                                dummyPosition()
                                  ),
                                dummyPosition()
                                  ),
                                new VarDeclaration(
                                    new Identifier(
                                      "d",
                                      dummyPosition()
                                      ),
                                    new SimpleTypeDenoter(
                                      new Identifier(
                                        "Date",
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                      ),
                                    dummyPosition()
                                    ),
                                dummyPosition()
                                  ),
                                new VarDeclaration(
                                    new Identifier(
                                      "months",
                                      dummyPosition()
                                      ),
                                    new ArrayTypeDenoter(
                                      new IntegerLiteral(
                                        "12",
                                        dummyPosition()
                                        ),
                                      new SimpleTypeDenoter(
                                        new Identifier(
                                          "Integer",
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                      ),
                                    dummyPosition()
                                    ),
                                    dummyPosition()
                                      ),
                                    new ProcDeclaration(
                                        new Identifier(
                                          "printmonths",
                                          dummyPosition()
                                          ),
                                        new SingleFormalParameterSequence(
                                          new ConstFormalParameter(
                                            new Identifier(
                                              "ms",
                                              dummyPosition()
                                              ),
                                            new ArrayTypeDenoter(
                                              new IntegerLiteral(
                                                "12",
                                                dummyPosition()
                                                ),
                                              new SimpleTypeDenoter(
                                                new Identifier(
                                                  "Integer",
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                            dummyPosition()
                                              ),
                                            new LetCommand(
                                                new VarDeclaration(
                                                  new Identifier(
                                                    "i",
                                                    dummyPosition()
                                                    ),
                                                  new SimpleTypeDenoter(
                                                    new Identifier(
                                                      "Integer",
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                                new SequentialCommand(
                                                  new AssignCommand(
                                                    new SimpleVname(
                                                      new Identifier(
                                                        "i",
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                    new IntegerExpression(
                                                      new IntegerLiteral(
                                                        "0",
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                                  new WhileCommand(
                                                    new BinaryExpression(
                                                      new VnameExpression(
                                                        new SimpleVname(
                                                          new Identifier(
                                                            "i",
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      new Operator(
                                                        "<",
                                                        dummyPosition()
                                                        ),
                                                      new IntegerExpression(
                                                        new IntegerLiteral(
                                                          "12",
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                        ),
                                                      new SequentialCommand(
                                                          new SequentialCommand(
                                                            new CallCommand(
                                                              new Identifier(
                                                                "putint",
                                                                dummyPosition()
                                                                ),
                                                              new SingleActualParameterSequence(
                                                                new ConstActualParameter(
                                                                  new VnameExpression(
                                                                    new SubscriptVname(
                                                                      new SimpleVname(
                                                                        new Identifier(
                                                                          "ms",
                                                                          dummyPosition()
                                                                          ),
                                                                        dummyPosition()
                                                                        ),
                                                                      new VnameExpression(
                                                                        new SimpleVname(
                                                                          new Identifier(
                                                                            "i",
                                                                            dummyPosition()
                                                                            ),
                                                                          dummyPosition()
                                                                          ),
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                      dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                        ),
                                                      new CallCommand(
                                                          new Identifier(
                                                            "puteol",
                                                            dummyPosition()
                                                            ),
                                                          new EmptyActualParameterSequence(
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                      dummyPosition()
                                                        ),
                                                      new AssignCommand(
                                                          new SimpleVname(
                                                            new Identifier(
                                                              "i",
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                          new BinaryExpression(
                                                            new VnameExpression(
                                                              new SimpleVname(
                                                                new Identifier(
                                                                  "i",
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            new Operator(
                                                              "+",
                                                              dummyPosition()
                                                              ),
                                                            new IntegerExpression(
                                                              new IntegerLiteral(
                                                                "1",
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                              ),
                                                            new ProcDeclaration(
                                                                new Identifier(
                                                                  "readdate",
                                                                  dummyPosition()
                                                                  ),
                                                                new SingleFormalParameterSequence(
                                                                  new VarFormalParameter(
                                                                    new Identifier(
                                                                      "d",
                                                                      dummyPosition()
                                                                      ),
                                                                    new SimpleTypeDenoter(
                                                                      new Identifier(
                                                                        "Date",
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                  ),
                                                                new SequentialCommand(
                                                                    new SequentialCommand(
                                                                      new CallCommand(
                                                                        new Identifier(
                                                                          "getint",
                                                                          dummyPosition()
                                                                          ),
                                                                        new SingleActualParameterSequence(
                                                                          new VarActualParameter(
                                                                            new DotVname(
                                                                              new SimpleVname(
                                                                                new Identifier(
                                                                                  "d",
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              new Identifier(
                                                                                "y",
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                            ),
                                                                          dummyPosition()
                                                                          ),
                                                                        dummyPosition()
                                                                          ),
                                                                        new CallCommand(
                                                                            new Identifier(
                                                                              "getint",
                                                                              dummyPosition()
                                                                              ),
                                                                            new SingleActualParameterSequence(
                                                                              new VarActualParameter(
                                                                                new DotVname(
                                                                                  new SimpleVname(
                                                                                    new Identifier(
                                                                                      "d",
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  new Identifier(
                                                                                    "m",
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                              ),
                                                                            new CallCommand(
                                                                                new Identifier(
                                                                                  "getint",
                                                                                  dummyPosition()
                                                                                  ),
                                                                                new SingleActualParameterSequence(
                                                                                  new VarActualParameter(
                                                                                    new DotVname(
                                                                                      new SimpleVname(
                                                                                        new Identifier(
                                                                                          "d",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      new Identifier(
                                                                                        "d",
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                  ),
                                                                                new FuncDeclaration(
                                                                                    new Identifier(
                                                                                      "leap",
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    new SingleFormalParameterSequence(
                                                                                      new ConstFormalParameter(
                                                                                        new Identifier(
                                                                                          "y",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        new SimpleTypeDenoter(
                                                                                          new Identifier(
                                                                                            "Integer",
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    new SimpleTypeDenoter(
                                                                                        new Identifier(
                                                                                          "Boolean",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                    new IfExpression(
                                                                                        new BinaryExpression(
                                                                                          new BinaryExpression(
                                                                                            new BinaryExpression(
                                                                                              new BinaryExpression(
                                                                                                new VnameExpression(
                                                                                                  new SimpleVname(
                                                                                                    new Identifier(
                                                                                                      "y",
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                new Operator(
                                                                                                  "//",
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                new IntegerExpression(
                                                                                                  new IntegerLiteral(
                                                                                                    "100",
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                dummyPosition()
                                                                                                  ),
                                                                                                new Operator(
                                                                                                    "=",
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                new IntegerExpression(
                                                                                                    new IntegerLiteral(
                                                                                                      "0",
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                dummyPosition()
                                                                                                  ),
                                                                                                new Operator(
                                                                                                    "/\\",
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                new BinaryExpression(
                                                                                                    new BinaryExpression(
                                                                                                      new VnameExpression(
                                                                                                        new SimpleVname(
                                                                                                          new Identifier(
                                                                                                            "y",
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      new Operator(
                                                                                                        "//",
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      new IntegerExpression(
                                                                                                        new IntegerLiteral(
                                                                                                          "400",
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      new Operator(
                                                                                                          "=",
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                      new IntegerExpression(
                                                                                                          new IntegerLiteral(
                                                                                                            "0",
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      new Operator(
                                                                                                          "\\/",
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                      new BinaryExpression(
                                                                                                          new BinaryExpression(
                                                                                                            new VnameExpression(
                                                                                                              new SimpleVname(
                                                                                                                new Identifier(
                                                                                                                  "y",
                                                                                                                  dummyPosition()
                                                                                                                  ),
                                                                                                                dummyPosition()
                                                                                                                ),
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            new Operator(
                                                                                                              "//",
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            new IntegerExpression(
                                                                                                              new IntegerLiteral(
                                                                                                                "4",
                                                                                                                dummyPosition()
                                                                                                                ),
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                              ),
                                                                                                            new Operator(
                                                                                                                "=",
                                                                                                                dummyPosition()
                                                                                                                ),
                                                                                                            new IntegerExpression(
                                                                                                                new IntegerLiteral(
                                                                                                                  "0",
                                                                                                                  dummyPosition()
                                                                                                                  ),
                                                                                                                dummyPosition()
                                                                                                                ),
                                                                                                            dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                              ),
                                                                                                            new VnameExpression(
                                                                                                                new SimpleVname(
                                                                                                                  new Identifier(
                                                                                                                    "true",
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                  ),
                                                                                                                dummyPosition()
                                                                                                                ),
                                                                                                            new VnameExpression(
                                                                                                                new SimpleVname(
                                                                                                                  new Identifier(
                                                                                                                    "false",
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                  ),
                                                                                                                dummyPosition()
                                                                                                                ),
                                                                                                            dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                              ),
                                                                                                            new FuncDeclaration(
                                                                                                                new Identifier(
                                                                                                                  "getmonths",
                                                                                                                  dummyPosition()
                                                                                                                  ),
                                                                                                                new SingleFormalParameterSequence(
                                                                                                                  new ConstFormalParameter(
                                                                                                                    new Identifier(
                                                                                                                      "d",
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                    new SimpleTypeDenoter(
                                                                                                                      new Identifier(
                                                                                                                        "Date",
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                  ),
                                                                                                                new ArrayTypeDenoter(
                                                                                                                    new IntegerLiteral(
                                                                                                                      "12",
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                    new SimpleTypeDenoter(
                                                                                                                      new Identifier(
                                                                                                                        "Integer",
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                new ArrayExpression(
                                                                                                                    new MultipleArrayAggregate(
                                                                                                                      new IntegerExpression(
                                                                                                                        new IntegerLiteral(
                                                                                                                          "31",
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      new MultipleArrayAggregate(
                                                                                                                        new IfExpression(
                                                                                                                          new CallExpression(
                                                                                                                            new Identifier(
                                                                                                                              "leap",
                                                                                                                              dummyPosition()
                                                                                                                              ),
                                                                                                                            new SingleActualParameterSequence(
                                                                                                                              new ConstActualParameter(
                                                                                                                                new VnameExpression(
                                                                                                                                  new DotVname(
                                                                                                                                    new SimpleVname(
                                                                                                                                      new Identifier(
                                                                                                                                        "d",
                                                                                                                                        dummyPosition()
                                                                                                                                        ),
                                                                                                                                      dummyPosition()
                                                                                                                                      ),
                                                                                                                                    new Identifier(
                                                                                                                                      "y",
                                                                                                                                      dummyPosition()
                                                                                                                                      ),
                                                                                                                                    dummyPosition()
                                                                                                                                    ),
                                                                                                                                  dummyPosition()
                                                                                                                                  ),
                                                                                                                                dummyPosition()
                                                                                                                                ),
                                                                                                                      dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                        ),
                                                                                                                      new IntegerExpression(
                                                                                                                          new IntegerLiteral(
                                                                                                                            "29",
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                      new IntegerExpression(
                                                                                                                          new IntegerLiteral(
                                                                                                                            "28",
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                      dummyPosition()
                                                                                                                        ),
                                                                                                                      new MultipleArrayAggregate(
                                                                                                                          new IntegerExpression(
                                                                                                                            new IntegerLiteral(
                                                                                                                              "31",
                                                                                                                              dummyPosition()
                                                                                                                              ),
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          new MultipleArrayAggregate(
                                                                                                                            new IntegerExpression(
                                                                                                                              new IntegerLiteral(
                                                                                                                                "30",
                                                                                                                                dummyPosition()
                                                                                                                                ),
                                                                                                                              dummyPosition()
                                                                                                                              ),
                                                                                                                            new MultipleArrayAggregate(
                                                                                                                              new IntegerExpression(
                                                                                                                                new IntegerLiteral(
                                                                                                                                  "31",
                                                                                                                                  dummyPosition()
                                                                                                                                  ),
                                                                                                                                dummyPosition()
                                                                                                                                ),
                                                                                                                              new MultipleArrayAggregate(
                                                                                                                                new IntegerExpression(
                                                                                                                                  new IntegerLiteral(
                                                                                                                                    "30",
                                                                                                                                    dummyPosition()
                                                                                                                                    ),
                                                                                                                                  dummyPosition()
                                                                                                                                  ),
                                                                                                                                new MultipleArrayAggregate(
                                                                                                                                  new IntegerExpression(
                                                                                                                                    new IntegerLiteral(
                                                                                                                                      "31",
                                                                                                                                      dummyPosition()
                                                                                                                                      ),
                                                                                                                                    dummyPosition()
                                                                                                                                    ),
                                                                                                                                  new MultipleArrayAggregate(
                                                                                                                                    new IntegerExpression(
                                                                                                                                      new IntegerLiteral(
                                                                                                                                        "31",
                                                                                                                                        dummyPosition()
                                                                                                                                        ),
                                                                                                                                      dummyPosition()
                                                                                                                                      ),
                                                                                                                                    new MultipleArrayAggregate(
                                                                                                                                      new IntegerExpression(
                                                                                                                                        new IntegerLiteral(
                                                                                                                                          "30",
                                                                                                                                          dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                        ),
                                                                                                                                      new MultipleArrayAggregate(
                                                                                                                                        new IntegerExpression(
                                                                                                                                          new IntegerLiteral(
                                                                                                                                            "31",
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                          dummyPosition()
                                                                                                                                          ),
                                                                                                                                        new MultipleArrayAggregate(
                                                                                                                                          new IntegerExpression(
                                                                                                                                            new IntegerLiteral(
                                                                                                                                              "30",
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                          new SingleArrayAggregate(
                                                                                                                                            new IntegerExpression(
                                                                                                                                              new IntegerLiteral(
                                                                                                                                                "31",
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                          dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        new SequentialCommand(
                                                                                                                                            new CallCommand(
                                                                                                                                              new Identifier(
                                                                                                                                                "readdate",
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              new SingleActualParameterSequence(
                                                                                                                                                new VarActualParameter(
                                                                                                                                                  new SimpleVname(
                                                                                                                                                    new Identifier(
                                                                                                                                                      "d",
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                    ),
                                                                                                                                                  dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                        new LetCommand(
                                                                                                                                            new VarDeclaration(
                                                                                                                                              new Identifier(
                                                                                                                                                "ms",
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              new ArrayTypeDenoter(
                                                                                                                                                new IntegerLiteral(
                                                                                                                                                  "12",
                                                                                                                                                  dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                new SimpleTypeDenoter(
                                                                                                                                                  new Identifier(
                                                                                                                                                    "Integer",
                                                                                                                                                    dummyPosition()
                                                                                                                                                    ),
                                                                                                                                                  dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                              new SequentialCommand(
                                                                                                                                                  new AssignCommand(
                                                                                                                                                    new SimpleVname(
                                                                                                                                                      new Identifier(
                                                                                                                                                        "ms",
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    new CallExpression(
                                                                                                                                                      new Identifier(
                                                                                                                                                        "getmonths",
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      new SingleActualParameterSequence(
                                                                                                                                                        new ConstActualParameter(
                                                                                                                                                          new VnameExpression(
                                                                                                                                                            new SimpleVname(
                                                                                                                                                              new Identifier(
                                                                                                                                                                "d",
                                                                                                                                                                dummyPosition()
                                                                                                                                                                ),
                                                                                                                                                              dummyPosition()
                                                                                                                                                              ),
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      new CallCommand(
                                                                                                                                                          new Identifier(
                                                                                                                                                            "printmonths",
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          new SingleActualParameterSequence(
                                                                                                                                                            new ConstActualParameter(
                                                                                                                                                              new VnameExpression(
                                                                                                                                                                new SimpleVname(
                                                                                                                                                                  new Identifier(
                                                                                                                                                                    "ms",
                                                                                                                                                                    dummyPosition()
                                                                                                                                                                    ),
                                                                                                                                                                  dummyPosition()
                                                                                                                                                                  ),
                                                                                                                                                                dummyPosition()
                                                                                                                                                                ),
                                                                                                                                                              dummyPosition()
                                                                                                                                                              ),
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                            );
    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }

  public void testCapitalise() {
    String filename = "samples/source/capitalise.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram =
      new Program(
          new LetCommand(
            new SequentialDeclaration(
              new SequentialDeclaration(
                new SequentialDeclaration(
                  new SequentialDeclaration(
                    new SequentialDeclaration(
                      new VarDeclaration(
                        new Identifier(
                          "s",
                          dummyPosition()
                          ),
                        new ArrayTypeDenoter(
                          new IntegerLiteral(
                            "5",
                            dummyPosition()
                            ),
                          new SimpleTypeDenoter(
                            new Identifier(
                              "Char",
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                          dummyPosition()
                          ),
                        dummyPosition()
                        ),
                        new ConstDeclaration(
                            new Identifier(
                              "shift",
                              dummyPosition()
                              ),
                            new BinaryExpression(
                              new CallExpression(
                                new Identifier(
                                  "ord",
                                  dummyPosition()
                                  ),
                                new SingleActualParameterSequence(
                                  new ConstActualParameter(
                                    new CharacterExpression(
                                      new CharacterLiteral(
                                        "a",
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                      ),
                                    dummyPosition()
                                    ),
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                        new Operator(
                            "-",
                            dummyPosition()
                            ),
                        new CallExpression(
                            new Identifier(
                              "ord",
                              dummyPosition()
                              ),
                            new SingleActualParameterSequence(
                              new ConstActualParameter(
                                new CharacterExpression(
                                  new CharacterLiteral(
                                    "A",
                                    dummyPosition()
                                    ),
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                        dummyPosition()
                          ),
                        dummyPosition()
                          ),
                        dummyPosition()
                          ),
                        new ProcDeclaration(
                            new Identifier(
                              "capitalisechar",
                              dummyPosition()
                              ),
                            new SingleFormalParameterSequence(
                              new VarFormalParameter(
                                new Identifier(
                                  "ch",
                                  dummyPosition()
                                  ),
                                new SimpleTypeDenoter(
                                  new Identifier(
                                    "Char",
                                    dummyPosition()
                                    ),
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                              dummyPosition()
                              ),
                            new IfCommand(
                                new BinaryExpression(
                                  new BinaryExpression(
                                    new CallExpression(
                                      new Identifier(
                                        "ord",
                                        dummyPosition()
                                        ),
                                      new SingleActualParameterSequence(
                                        new ConstActualParameter(
                                          new VnameExpression(
                                            new SimpleVname(
                                              new Identifier(
                                                "ch",
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                        ),
                                      new Operator(
                                          ">=",
                                          dummyPosition()
                                          ),
                                      new CallExpression(
                                          new Identifier(
                                            "ord",
                                            dummyPosition()
                                            ),
                                          new SingleActualParameterSequence(
                                            new ConstActualParameter(
                                              new CharacterExpression(
                                                new CharacterLiteral(
                                                  "a",
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                      dummyPosition()
                                        ),
                                      new Operator(
                                          "/\\",
                                          dummyPosition()
                                          ),
                                      new BinaryExpression(
                                          new CallExpression(
                                            new Identifier(
                                              "ord",
                                              dummyPosition()
                                              ),
                                            new SingleActualParameterSequence(
                                              new ConstActualParameter(
                                                new VnameExpression(
                                                  new SimpleVname(
                                                    new Identifier(
                                                      "ch",
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                              ),
                                            new Operator(
                                                "<=",
                                                dummyPosition()
                                                ),
                                            new CallExpression(
                                                new Identifier(
                                                  "ord",
                                                  dummyPosition()
                                                  ),
                                                new SingleActualParameterSequence(
                                                  new ConstActualParameter(
                                                    new CharacterExpression(
                                                      new CharacterLiteral(
                                                        "z",
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                ),
                                            dummyPosition()
                                              ),
                                            dummyPosition()
                                              ),
                                            new AssignCommand(
                                                new SimpleVname(
                                                  new Identifier(
                                                    "ch",
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                                new CallExpression(
                                                  new Identifier(
                                                    "chr",
                                                    dummyPosition()
                                                    ),
                                                  new SingleActualParameterSequence(
                                                    new ConstActualParameter(
                                                      new BinaryExpression(
                                                        new CallExpression(
                                                          new Identifier(
                                                            "ord",
                                                            dummyPosition()
                                                            ),
                                                          new SingleActualParameterSequence(
                                                            new ConstActualParameter(
                                                              new VnameExpression(
                                                                new SimpleVname(
                                                                  new Identifier(
                                                                    "ch",
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                            ),
                                                          new Operator(
                                                              "-",
                                                              dummyPosition()
                                                              ),
                                                          new VnameExpression(
                                                              new SimpleVname(
                                                                new Identifier(
                                                                  "shift",
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                          dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                            ),
                                                          new AssignCommand(
                                                              new SimpleVname(
                                                                new Identifier(
                                                                  "ch",
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              new VnameExpression(
                                                                new SimpleVname(
                                                                  new Identifier(
                                                                    "ch",
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                          dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                            ),
                                                          new ProcDeclaration(
                                                              new Identifier(
                                                                "capitalise",
                                                                dummyPosition()
                                                                ),
                                                              new SingleFormalParameterSequence(
                                                                new VarFormalParameter(
                                                                  new Identifier(
                                                                    "s",
                                                                    dummyPosition()
                                                                    ),
                                                                  new ArrayTypeDenoter(
                                                                    new IntegerLiteral(
                                                                      "5",
                                                                      dummyPosition()
                                                                      ),
                                                                    new SimpleTypeDenoter(
                                                                      new Identifier(
                                                                        "Char",
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                  ),
                                                                  dummyPosition()
                                                                    ),
                                                                  new LetCommand(
                                                                      new VarDeclaration(
                                                                        new Identifier(
                                                                          "i",
                                                                          dummyPosition()
                                                                          ),
                                                                        new SimpleTypeDenoter(
                                                                          new Identifier(
                                                                            "Integer",
                                                                            dummyPosition()
                                                                            ),
                                                                          dummyPosition()
                                                                          ),
                                                                        dummyPosition()
                                                                        ),
                                                                      new SequentialCommand(
                                                                        new AssignCommand(
                                                                          new SimpleVname(
                                                                            new Identifier(
                                                                              "i",
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                            ),
                                                                          new IntegerExpression(
                                                                            new IntegerLiteral(
                                                                              "0",
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                            ),
                                                                          dummyPosition()
                                                                          ),
                                                                        new WhileCommand(
                                                                          new BinaryExpression(
                                                                            new VnameExpression(
                                                                              new SimpleVname(
                                                                                new Identifier(
                                                                                  "i",
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            new Operator(
                                                                              "<",
                                                                              dummyPosition()
                                                                              ),
                                                                            new IntegerExpression(
                                                                              new IntegerLiteral(
                                                                                "5",
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                              ),
                                                                            new SequentialCommand(
                                                                                new CallCommand(
                                                                                  new Identifier(
                                                                                    "capitalisechar",
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  new SingleActualParameterSequence(
                                                                                    new VarActualParameter(
                                                                                      new SubscriptVname(
                                                                                        new SimpleVname(
                                                                                          new Identifier(
                                                                                            "s",
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        new VnameExpression(
                                                                                          new SimpleVname(
                                                                                            new Identifier(
                                                                                              "i",
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  new AssignCommand(
                                                                                      new SimpleVname(
                                                                                        new Identifier(
                                                                                          "i",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      new BinaryExpression(
                                                                                        new VnameExpression(
                                                                                          new SimpleVname(
                                                                                            new Identifier(
                                                                                              "i",
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        new Operator(
                                                                                          "+",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        new IntegerExpression(
                                                                                          new IntegerLiteral(
                                                                                            "1",
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                          ),
                                                                                        new ProcDeclaration(
                                                                                            new Identifier(
                                                                                              "readstring",
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            new SingleFormalParameterSequence(
                                                                                              new VarFormalParameter(
                                                                                                new Identifier(
                                                                                                  "s",
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                new ArrayTypeDenoter(
                                                                                                  new IntegerLiteral(
                                                                                                    "5",
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  new SimpleTypeDenoter(
                                                                                                    new Identifier(
                                                                                                      "Char",
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                dummyPosition()
                                                                                                ),
                                                                                                dummyPosition()
                                                                                                  ),
                                                                                                new LetCommand(
                                                                                                    new VarDeclaration(
                                                                                                      new Identifier(
                                                                                                        "i",
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      new SimpleTypeDenoter(
                                                                                                        new Identifier(
                                                                                                          "Integer",
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    new SequentialCommand(
                                                                                                      new AssignCommand(
                                                                                                        new SimpleVname(
                                                                                                          new Identifier(
                                                                                                            "i",
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        new IntegerExpression(
                                                                                                          new IntegerLiteral(
                                                                                                            "0",
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      new WhileCommand(
                                                                                                        new BinaryExpression(
                                                                                                          new VnameExpression(
                                                                                                            new SimpleVname(
                                                                                                              new Identifier(
                                                                                                                "i",
                                                                                                                dummyPosition()
                                                                                                                ),
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          new Operator(
                                                                                                            "<",
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          new IntegerExpression(
                                                                                                            new IntegerLiteral(
                                                                                                              "5",
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                            ),
                                                                                                          new SequentialCommand(
                                                                                                              new CallCommand(
                                                                                                                new Identifier(
                                                                                                                  "get",
                                                                                                                  dummyPosition()
                                                                                                                  ),
                                                                                                                new SingleActualParameterSequence(
                                                                                                                  new VarActualParameter(
                                                                                                                    new SubscriptVname(
                                                                                                                      new SimpleVname(
                                                                                                                        new Identifier(
                                                                                                                          "s",
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      new VnameExpression(
                                                                                                                        new SimpleVname(
                                                                                                                          new Identifier(
                                                                                                                            "i",
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                dummyPosition()
                                                                                                                  ),
                                                                                                                dummyPosition()
                                                                                                                  ),
                                                                                                                dummyPosition()
                                                                                                                  ),
                                                                                                                new AssignCommand(
                                                                                                                    new SimpleVname(
                                                                                                                      new Identifier(
                                                                                                                        "i",
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                    new BinaryExpression(
                                                                                                                      new VnameExpression(
                                                                                                                        new SimpleVname(
                                                                                                                          new Identifier(
                                                                                                                            "i",
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      new Operator(
                                                                                                                        "+",
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      new IntegerExpression(
                                                                                                                        new IntegerLiteral(
                                                                                                                          "1",
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                        ),
                                                                                                                      new ProcDeclaration(
                                                                                                                          new Identifier(
                                                                                                                            "displaystring",
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          new SingleFormalParameterSequence(
                                                                                                                            new ConstFormalParameter(
                                                                                                                              new Identifier(
                                                                                                                                "s",
                                                                                                                                dummyPosition()
                                                                                                                                ),
                                                                                                                              new ArrayTypeDenoter(
                                                                                                                                new IntegerLiteral(
                                                                                                                                  "5",
                                                                                                                                  dummyPosition()
                                                                                                                                  ),
                                                                                                                                new SimpleTypeDenoter(
                                                                                                                                  new Identifier(
                                                                                                                                    "Char",
                                                                                                                                    dummyPosition()
                                                                                                                                    ),
                                                                                                                                  dummyPosition()
                                                                                                                                  ),
                                                                                                                                dummyPosition()
                                                                                                                                ),
                                                                                                                              dummyPosition()
                                                                                                                              ),
                                                                                                                              dummyPosition()
                                                                                                                                ),
                                                                                                                              new LetCommand(
                                                                                                                                  new VarDeclaration(
                                                                                                                                    new Identifier(
                                                                                                                                      "i",
                                                                                                                                      dummyPosition()
                                                                                                                                      ),
                                                                                                                                    new SimpleTypeDenoter(
                                                                                                                                      new Identifier(
                                                                                                                                        "Integer",
                                                                                                                                        dummyPosition()
                                                                                                                                        ),
                                                                                                                                      dummyPosition()
                                                                                                                                      ),
                                                                                                                                    dummyPosition()
                                                                                                                                    ),
                                                                                                                                  new SequentialCommand(
                                                                                                                                    new SequentialCommand(
                                                                                                                                      new AssignCommand(
                                                                                                                                        new SimpleVname(
                                                                                                                                          new Identifier(
                                                                                                                                            "i",
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                          dummyPosition()
                                                                                                                                          ),
                                                                                                                                        new IntegerExpression(
                                                                                                                                          new IntegerLiteral(
                                                                                                                                            "0",
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                          dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                        ),
                                                                                                                                      new WhileCommand(
                                                                                                                                        new BinaryExpression(
                                                                                                                                          new VnameExpression(
                                                                                                                                            new SimpleVname(
                                                                                                                                              new Identifier(
                                                                                                                                                "i",
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                          new Operator(
                                                                                                                                            "<",
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                          new IntegerExpression(
                                                                                                                                            new IntegerLiteral(
                                                                                                                                              "5",
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                          dummyPosition()
                                                                                                                                            ),
                                                                                                                                          new SequentialCommand(
                                                                                                                                              new CallCommand(
                                                                                                                                                new Identifier(
                                                                                                                                                  "put",
                                                                                                                                                  dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                new SingleActualParameterSequence(
                                                                                                                                                  new ConstActualParameter(
                                                                                                                                                    new VnameExpression(
                                                                                                                                                      new SubscriptVname(
                                                                                                                                                        new SimpleVname(
                                                                                                                                                          new Identifier(
                                                                                                                                                            "s",
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        new VnameExpression(
                                                                                                                                                          new SimpleVname(
                                                                                                                                                            new Identifier(
                                                                                                                                                              "i",
                                                                                                                                                              dummyPosition()
                                                                                                                                                              ),
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                          dummyPosition()
                                                                                                                                            ),
                                                                                                                                          dummyPosition()
                                                                                                                                            ),
                                                                                                                                          dummyPosition()
                                                                                                                                            ),
                                                                                                                                          dummyPosition()
                                                                                                                                            ),
                                                                                                                                          new AssignCommand(
                                                                                                                                              new SimpleVname(
                                                                                                                                                new Identifier(
                                                                                                                                                  "i",
                                                                                                                                                  dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              new BinaryExpression(
                                                                                                                                                new VnameExpression(
                                                                                                                                                  new SimpleVname(
                                                                                                                                                    new Identifier(
                                                                                                                                                      "i",
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                    ),
                                                                                                                                                  dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                new Operator(
                                                                                                                                                  "+",
                                                                                                                                                  dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                new IntegerExpression(
                                                                                                                                                  new IntegerLiteral(
                                                                                                                                                    "1",
                                                                                                                                                    dummyPosition()
                                                                                                                                                    ),
                                                                                                                                                  dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                new CallCommand(
                                                                                                                                                    new Identifier(
                                                                                                                                                      "puteol",
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    new EmptyActualParameterSequence(
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                    ),
                                                                                                                                                dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                new SequentialCommand(
                                                                                                                                                    new SequentialCommand(
                                                                                                                                                      new SequentialCommand(
                                                                                                                                                        new SequentialCommand(
                                                                                                                                                          new SequentialCommand(
                                                                                                                                                            new CallCommand(
                                                                                                                                                              new Identifier(
                                                                                                                                                                "readstring",
                                                                                                                                                                dummyPosition()
                                                                                                                                                                ),
                                                                                                                                                              new SingleActualParameterSequence(
                                                                                                                                                                new VarActualParameter(
                                                                                                                                                                  new SimpleVname(
                                                                                                                                                                    new Identifier(
                                                                                                                                                                      "s",
                                                                                                                                                                      dummyPosition()
                                                                                                                                                                      ),
                                                                                                                                                                    dummyPosition()
                                                                                                                                                                    ),
                                                                                                                                                                  dummyPosition()
                                                                                                                                                                  ),
                                                                                                                                                                dummyPosition()
                                                                                                                                                                ),
                                                                                                                                                              dummyPosition()
                                                                                                                                                              ),
                                                                                                                                                new CallCommand(
                                                                                                                                                    new Identifier(
                                                                                                                                                      "displaystring",
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    new SingleActualParameterSequence(
                                                                                                                                                      new ConstActualParameter(
                                                                                                                                                        new VnameExpression(
                                                                                                                                                          new SimpleVname(
                                                                                                                                                            new Identifier(
                                                                                                                                                              "s",
                                                                                                                                                              dummyPosition()
                                                                                                                                                              ),
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    new CallCommand(
                                                                                                                                                        new Identifier(
                                                                                                                                                          "puteol",
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        new EmptyActualParameterSequence(
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    new CallCommand(
                                                                                                                                                        new Identifier(
                                                                                                                                                          "capitalise",
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        new SingleActualParameterSequence(
                                                                                                                                                          new VarActualParameter(
                                                                                                                                                            new SimpleVname(
                                                                                                                                                              new Identifier(
                                                                                                                                                                "s",
                                                                                                                                                                dummyPosition()
                                                                                                                                                                ),
                                                                                                                                                              dummyPosition()
                                                                                                                                                              ),
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    new CallCommand(
                                                                                                                                                        new Identifier(
                                                                                                                                                          "displaystring",
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        new SingleActualParameterSequence(
                                                                                                                                                          new ConstActualParameter(
                                                                                                                                                            new VnameExpression(
                                                                                                                                                              new SimpleVname(
                                                                                                                                                                new Identifier(
                                                                                                                                                                  "s",
                                                                                                                                                                  dummyPosition()
                                                                                                                                                                  ),
                                                                                                                                                                dummyPosition()
                                                                                                                                                                ),
                                                                                                                                                              dummyPosition()
                                                                                                                                                              ),
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        new EmptyCommand(
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                          );

    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }

  public void testFreq() {
    String filename = "samples/source/freq.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram =
      new Program(
          new LetCommand(
            new SequentialDeclaration(
              new SequentialDeclaration(
                new SequentialDeclaration(
                  new ProcDeclaration(
                    new Identifier(
                      "initialize",
                      dummyPosition()
                      ),
                    new SingleFormalParameterSequence(
                      new VarFormalParameter(
                        new Identifier(
                          "arr",
                          dummyPosition()
                          ),
                        new ArrayTypeDenoter(
                          new IntegerLiteral(
                            "26",
                            dummyPosition()
                            ),
                          new SimpleTypeDenoter(
                            new Identifier(
                              "Integer",
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                          dummyPosition()
                          ),
                        dummyPosition()
                        ),
                        dummyPosition()
                          ),
                        new LetCommand(
                            new VarDeclaration(
                              new Identifier(
                                "i",
                                dummyPosition()
                                ),
                              new SimpleTypeDenoter(
                                new Identifier(
                                  "Integer",
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                              dummyPosition()
                              ),
                            new SequentialCommand(
                              new AssignCommand(
                                new SimpleVname(
                                  new Identifier(
                                    "i",
                                    dummyPosition()
                                    ),
                                  dummyPosition()
                                  ),
                                new IntegerExpression(
                                  new IntegerLiteral(
                                    "0",
                                    dummyPosition()
                                    ),
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                              new WhileCommand(
                                new BinaryExpression(
                                  new VnameExpression(
                                    new SimpleVname(
                                      new Identifier(
                                        "i",
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                      ),
                                    dummyPosition()
                                    ),
                                  new Operator(
                                    "<",
                                    dummyPosition()
                                    ),
                                  new IntegerExpression(
                                    new IntegerLiteral(
                                      "26",
                                      dummyPosition()
                                      ),
                                    dummyPosition()
                                    ),
                                  dummyPosition()
                                    ),
                                  new SequentialCommand(
                                      new AssignCommand(
                                        new SubscriptVname(
                                          new SimpleVname(
                                            new Identifier(
                                              "arr",
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          new VnameExpression(
                                            new SimpleVname(
                                              new Identifier(
                                                "i",
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                  new IntegerExpression(
                                      new IntegerLiteral(
                                        "0",
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                      ),
                                  dummyPosition()
                                    ),
                                  new AssignCommand(
                                      new SimpleVname(
                                        new Identifier(
                                          "i",
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                        ),
                                      new BinaryExpression(
                                        new VnameExpression(
                                          new SimpleVname(
                                            new Identifier(
                                              "i",
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                        new Operator(
                                          "+",
                                          dummyPosition()
                                          ),
                                        new IntegerExpression(
                                          new IntegerLiteral(
                                            "1",
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                          ),
                                        dummyPosition()
                                          ),
                                        dummyPosition()
                                          ),
                                        dummyPosition()
                                          ),
                                        dummyPosition()
                                          ),
                                        dummyPosition()
                                          ),
                                        dummyPosition()
                                          ),
                                        new ProcDeclaration(
                                            new Identifier(
                                              "increment",
                                              dummyPosition()
                                              ),
                                            new MultipleFormalParameterSequence(
                                              new ConstFormalParameter(
                                                new Identifier(
                                                  "ch",
                                                  dummyPosition()
                                                  ),
                                                new SimpleTypeDenoter(
                                                  new Identifier(
                                                    "Char",
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                ),
                                              new SingleFormalParameterSequence(
                                                new VarFormalParameter(
                                                  new Identifier(
                                                    "freq",
                                                    dummyPosition()
                                                    ),
                                                  new ArrayTypeDenoter(
                                                    new IntegerLiteral(
                                                      "26",
                                                      dummyPosition()
                                                      ),
                                                    new SimpleTypeDenoter(
                                                      new Identifier(
                                                        "Integer",
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                                  dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                    ),
                                                  new LetCommand(
                                                      new VarDeclaration(
                                                        new Identifier(
                                                          "idx",
                                                          dummyPosition()
                                                          ),
                                                        new SimpleTypeDenoter(
                                                          new Identifier(
                                                            "Integer",
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      new SequentialCommand(
                                                        new AssignCommand(
                                                          new SimpleVname(
                                                            new Identifier(
                                                              "idx",
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                          new BinaryExpression(
                                                            new CallExpression(
                                                              new Identifier(
                                                                "ord",
                                                                dummyPosition()
                                                                ),
                                                              new SingleActualParameterSequence(
                                                                new ConstActualParameter(
                                                                  new VnameExpression(
                                                                    new SimpleVname(
                                                                      new Identifier(
                                                                        "ch",
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                                ),
                                                              new Operator(
                                                                  "-",
                                                                  dummyPosition()
                                                                  ),
                                                              new CallExpression(
                                                                  new Identifier(
                                                                    "ord",
                                                                    dummyPosition()
                                                                    ),
                                                                  new SingleActualParameterSequence(
                                                                    new ConstActualParameter(
                                                                      new CharacterExpression(
                                                                        new CharacterLiteral(
                                                                          "a",
                                                                          dummyPosition()
                                                                          ),
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                  ),
                                                              dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                                ),
                                                              new IfCommand(
                                                                  new BinaryExpression(
                                                                    new BinaryExpression(
                                                                      new CallExpression(
                                                                        new Identifier(
                                                                          "ord",
                                                                          dummyPosition()
                                                                          ),
                                                                        new SingleActualParameterSequence(
                                                                          new ConstActualParameter(
                                                                            new VnameExpression(
                                                                              new SimpleVname(
                                                                                new Identifier(
                                                                                  "ch",
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                            ),
                                                                          dummyPosition()
                                                                          ),
                                                                        dummyPosition()
                                                                          ),
                                                                        new Operator(
                                                                            ">=",
                                                                            dummyPosition()
                                                                            ),
                                                                        new CallExpression(
                                                                            new Identifier(
                                                                              "ord",
                                                                              dummyPosition()
                                                                              ),
                                                                            new SingleActualParameterSequence(
                                                                              new ConstActualParameter(
                                                                                new CharacterExpression(
                                                                                  new CharacterLiteral(
                                                                                    "a",
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                            ),
                                                                        dummyPosition()
                                                                          ),
                                                                        new Operator(
                                                                            "/\\",
                                                                            dummyPosition()
                                                                            ),
                                                                        new BinaryExpression(
                                                                            new CallExpression(
                                                                              new Identifier(
                                                                                "ord",
                                                                                dummyPosition()
                                                                                ),
                                                                              new SingleActualParameterSequence(
                                                                                new ConstActualParameter(
                                                                                  new VnameExpression(
                                                                                    new SimpleVname(
                                                                                      new Identifier(
                                                                                        "ch",
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                                ),
                                                                              new Operator(
                                                                                  "<=",
                                                                                  dummyPosition()
                                                                                  ),
                                                                              new CallExpression(
                                                                                  new Identifier(
                                                                                    "ord",
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  new SingleActualParameterSequence(
                                                                                    new ConstActualParameter(
                                                                                      new CharacterExpression(
                                                                                        new CharacterLiteral(
                                                                                          "z",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                  ),
                                                                              dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                                ),
                                                                              new AssignCommand(
                                                                                  new SubscriptVname(
                                                                                    new SimpleVname(
                                                                                      new Identifier(
                                                                                        "freq",
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    new VnameExpression(
                                                                                      new SimpleVname(
                                                                                        new Identifier(
                                                                                          "idx",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                              new BinaryExpression(
                                                                                  new VnameExpression(
                                                                                    new SubscriptVname(
                                                                                      new SimpleVname(
                                                                                        new Identifier(
                                                                                          "freq",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      new VnameExpression(
                                                                                        new SimpleVname(
                                                                                          new Identifier(
                                                                                            "idx",
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                              dummyPosition()
                                                                                ),
                                                                              new Operator(
                                                                                  "+",
                                                                                  dummyPosition()
                                                                                  ),
                                                                              new IntegerExpression(
                                                                                  new IntegerLiteral(
                                                                                    "1",
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                  ),
                                                                              dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                                ),
                                                                              new AssignCommand(
                                                                                  new SubscriptVname(
                                                                                    new SimpleVname(
                                                                                      new Identifier(
                                                                                        "freq",
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    new IntegerExpression(
                                                                                      new IntegerLiteral(
                                                                                        "0",
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  new VnameExpression(
                                                                                    new SubscriptVname(
                                                                                      new SimpleVname(
                                                                                        new Identifier(
                                                                                          "freq",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      new IntegerExpression(
                                                                                        new IntegerLiteral(
                                                                                          "0",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  new ProcDeclaration(
                                                                                      new Identifier(
                                                                                        "calculatefreqs",
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      new SingleFormalParameterSequence(
                                                                                        new VarFormalParameter(
                                                                                          new Identifier(
                                                                                            "freq",
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          new ArrayTypeDenoter(
                                                                                            new IntegerLiteral(
                                                                                              "26",
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            new SimpleTypeDenoter(
                                                                                              new Identifier(
                                                                                                "Integer",
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                          ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          new LetCommand(
                                                                                              new VarDeclaration(
                                                                                                new Identifier(
                                                                                                  "ch",
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                new SimpleTypeDenoter(
                                                                                                  new Identifier(
                                                                                                    "Char",
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              new WhileCommand(
                                                                                                new UnaryExpression(
                                                                                                  new Operator(
                                                                                                    "\\",
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  new CallExpression(
                                                                                                    new Identifier(
                                                                                                      "eol",
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    new EmptyActualParameterSequence(
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                new SequentialCommand(
                                                                                                  new SequentialCommand(
                                                                                                    new CallCommand(
                                                                                                      new Identifier(
                                                                                                        "get",
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      new SingleActualParameterSequence(
                                                                                                        new VarActualParameter(
                                                                                                          new SimpleVname(
                                                                                                            new Identifier(
                                                                                                              "ch",
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                new CallCommand(
                                                                                                    new Identifier(
                                                                                                      "increment",
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    new MultipleActualParameterSequence(
                                                                                                      new ConstActualParameter(
                                                                                                        new VnameExpression(
                                                                                                          new SimpleVname(
                                                                                                            new Identifier(
                                                                                                              "ch",
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      new SingleActualParameterSequence(
                                                                                                        new VarActualParameter(
                                                                                                          new SimpleVname(
                                                                                                            new Identifier(
                                                                                                              "freq",
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      new EmptyCommand(
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      new ProcDeclaration(
                                                                                                          new Identifier(
                                                                                                            "displayfreqs",
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          new SingleFormalParameterSequence(
                                                                                                            new ConstFormalParameter(
                                                                                                              new Identifier(
                                                                                                                "freq",
                                                                                                                dummyPosition()
                                                                                                                ),
                                                                                                              new ArrayTypeDenoter(
                                                                                                                new IntegerLiteral(
                                                                                                                  "26",
                                                                                                                  dummyPosition()
                                                                                                                  ),
                                                                                                                new SimpleTypeDenoter(
                                                                                                                  new Identifier(
                                                                                                                    "Integer",
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                  ),
                                                                                                                dummyPosition()
                                                                                                                ),
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                              dummyPosition()
                                                                                                                ),
                                                                                                              new LetCommand(
                                                                                                                  new VarDeclaration(
                                                                                                                    new Identifier(
                                                                                                                      "i",
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                    new SimpleTypeDenoter(
                                                                                                                      new Identifier(
                                                                                                                        "Integer",
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  new SequentialCommand(
                                                                                                                    new SequentialCommand(
                                                                                                                      new AssignCommand(
                                                                                                                        new SimpleVname(
                                                                                                                          new Identifier(
                                                                                                                            "i",
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        new IntegerExpression(
                                                                                                                          new IntegerLiteral(
                                                                                                                            "0",
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      new WhileCommand(
                                                                                                                        new BinaryExpression(
                                                                                                                          new VnameExpression(
                                                                                                                            new SimpleVname(
                                                                                                                              new Identifier(
                                                                                                                                "i",
                                                                                                                                dummyPosition()
                                                                                                                                ),
                                                                                                                              dummyPosition()
                                                                                                                              ),
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          new Operator(
                                                                                                                            "<",
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          new IntegerExpression(
                                                                                                                            new IntegerLiteral(
                                                                                                                              "26",
                                                                                                                              dummyPosition()
                                                                                                                              ),
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          dummyPosition()
                                                                                                                            ),
                                                                                                                          new SequentialCommand(
                                                                                                                              new SequentialCommand(
                                                                                                                                new SequentialCommand(
                                                                                                                                  new SequentialCommand(
                                                                                                                                    new SequentialCommand(
                                                                                                                                      new CallCommand(
                                                                                                                                        new Identifier(
                                                                                                                                          "put",
                                                                                                                                          dummyPosition()
                                                                                                                                          ),
                                                                                                                                        new SingleActualParameterSequence(
                                                                                                                                          new ConstActualParameter(
                                                                                                                                            new CallExpression(
                                                                                                                                              new Identifier(
                                                                                                                                                "chr",
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              new SingleActualParameterSequence(
                                                                                                                                                new ConstActualParameter(
                                                                                                                                                  new BinaryExpression(
                                                                                                                                                    new CallExpression(
                                                                                                                                                      new Identifier(
                                                                                                                                                        "ord",
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      new SingleActualParameterSequence(
                                                                                                                                                        new ConstActualParameter(
                                                                                                                                                          new CharacterExpression(
                                                                                                                                                            new CharacterLiteral(
                                                                                                                                                              "a",
                                                                                                                                                              dummyPosition()
                                                                                                                                                              ),
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                        new Operator(
                                                                                                                                            "+",
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                        new VnameExpression(
                                                                                                                                            new SimpleVname(
                                                                                                                                              new Identifier(
                                                                                                                                                "i",
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        new CallCommand(
                                                                                                                                            new Identifier(
                                                                                                                                              "put",
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            new SingleActualParameterSequence(
                                                                                                                                              new ConstActualParameter(
                                                                                                                                                new CharacterExpression(
                                                                                                                                                  new CharacterLiteral(
                                                                                                                                                    "=",
                                                                                                                                                    dummyPosition()
                                                                                                                                                    ),
                                                                                                                                                  dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        new CallCommand(
                                                                                                                                            new Identifier(
                                                                                                                                              "put",
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            new SingleActualParameterSequence(
                                                                                                                                              new ConstActualParameter(
                                                                                                                                                new CharacterExpression(
                                                                                                                                                  new CharacterLiteral(
                                                                                                                                                    ">",
                                                                                                                                                    dummyPosition()
                                                                                                                                                    ),
                                                                                                                                                  dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        new CallCommand(
                                                                                                                                            new Identifier(
                                                                                                                                              "putint",
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            new SingleActualParameterSequence(
                                                                                                                                              new ConstActualParameter(
                                                                                                                                                new VnameExpression(
                                                                                                                                                  new SubscriptVname(
                                                                                                                                                    new SimpleVname(
                                                                                                                                                      new Identifier(
                                                                                                                                                        "freq",
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    new VnameExpression(
                                                                                                                                                      new SimpleVname(
                                                                                                                                                        new Identifier(
                                                                                                                                                          "i",
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                    ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        new CallCommand(
                                                                                                                                            new Identifier(
                                                                                                                                              "puteol",
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            new EmptyActualParameterSequence(
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        new AssignCommand(
                                                                                                                                            new SimpleVname(
                                                                                                                                              new Identifier(
                                                                                                                                                "i",
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            new BinaryExpression(
                                                                                                                                              new VnameExpression(
                                                                                                                                                new SimpleVname(
                                                                                                                                                  new Identifier(
                                                                                                                                                    "i",
                                                                                                                                                    dummyPosition()
                                                                                                                                                    ),
                                                                                                                                                  dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              new Operator(
                                                                                                                                                "+",
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              new IntegerExpression(
                                                                                                                                                new IntegerLiteral(
                                                                                                                                                  "1",
                                                                                                                                                  dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                                ),
                                                                                                                                              new EmptyCommand(
                                                                                                                                                  dummyPosition()
                                                                                                                                                  ),
                                                                                                                                              dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                                ),
                                                                                                                                              new LetCommand(
                                                                                                                                                  new VarDeclaration(
                                                                                                                                                    new Identifier(
                                                                                                                                                      "freq",
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    new ArrayTypeDenoter(
                                                                                                                                                      new IntegerLiteral(
                                                                                                                                                        "26",
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      new SimpleTypeDenoter(
                                                                                                                                                        new Identifier(
                                                                                                                                                          "Integer",
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                    ),
                                                                                                                                                    new SequentialCommand(
                                                                                                                                                        new SequentialCommand(
                                                                                                                                                          new CallCommand(
                                                                                                                                                            new Identifier(
                                                                                                                                                              "initialize",
                                                                                                                                                              dummyPosition()
                                                                                                                                                              ),
                                                                                                                                                            new SingleActualParameterSequence(
                                                                                                                                                              new VarActualParameter(
                                                                                                                                                                new SimpleVname(
                                                                                                                                                                  new Identifier(
                                                                                                                                                                    "freq",
                                                                                                                                                                    dummyPosition()
                                                                                                                                                                    ),
                                                                                                                                                                  dummyPosition()
                                                                                                                                                                  ),
                                                                                                                                                                dummyPosition()
                                                                                                                                                                ),
                                                                                                                                                              dummyPosition()
                                                                                                                                                              ),
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                    new CallCommand(
                                                                                                                                                        new Identifier(
                                                                                                                                                          "calculatefreqs",
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        new SingleActualParameterSequence(
                                                                                                                                                          new VarActualParameter(
                                                                                                                                                            new SimpleVname(
                                                                                                                                                              new Identifier(
                                                                                                                                                                "freq",
                                                                                                                                                                dummyPosition()
                                                                                                                                                                ),
                                                                                                                                                              dummyPosition()
                                                                                                                                                              ),
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    new CallCommand(
                                                                                                                                                        new Identifier(
                                                                                                                                                          "displayfreqs",
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        new SingleActualParameterSequence(
                                                                                                                                                          new ConstActualParameter(
                                                                                                                                                            new VnameExpression(
                                                                                                                                                              new SimpleVname(
                                                                                                                                                                new Identifier(
                                                                                                                                                                  "freq",
                                                                                                                                                                  dummyPosition()
                                                                                                                                                                  ),
                                                                                                                                                                dummyPosition()
                                                                                                                                                                ),
                                                                                                                                                              dummyPosition()
                                                                                                                                                              ),
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                          );

    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }

  public void testInsertionSort() {
    String filename = "samples/source/insertion_sort.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram =
      new Program(
          new LetCommand(
            new SequentialDeclaration(
              new SequentialDeclaration(
                new SequentialDeclaration(
                  new SequentialDeclaration(
                    new SequentialDeclaration(
                      new VarDeclaration(
                        new Identifier(
                          "s",
                          dummyPosition()
                          ),
                        new ArrayTypeDenoter(
                          new IntegerLiteral(
                            "10",
                            dummyPosition()
                            ),
                          new SimpleTypeDenoter(
                            new Identifier(
                              "Integer",
                              dummyPosition()
                              ),
                            dummyPosition()
                            ),
                          dummyPosition()
                          ),
                        dummyPosition()
                        ),
                        new ProcDeclaration(
                            new Identifier(
                              "readNumsSub",
                              dummyPosition()
                              ),
                            new MultipleFormalParameterSequence(
                              new VarFormalParameter(
                                new Identifier(
                                  "a",
                                  dummyPosition()
                                  ),
                                new ArrayTypeDenoter(
                                  new IntegerLiteral(
                                    "10",
                                    dummyPosition()
                                    ),
                                  new SimpleTypeDenoter(
                                    new Identifier(
                                      "Integer",
                                      dummyPosition()
                                      ),
                                    dummyPosition()
                                    ),
                                  dummyPosition()
                                  ),
                                dummyPosition()
                                ),
                                new MultipleFormalParameterSequence(
                                    new ConstFormalParameter(
                                      new Identifier(
                                        "idx",
                                        dummyPosition()
                                        ),
                                      new SimpleTypeDenoter(
                                        new Identifier(
                                          "Integer",
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                      ),
                                    new SingleFormalParameterSequence(
                                      new ConstFormalParameter(
                                        new Identifier(
                                          "stop",
                                          dummyPosition()
                                          ),
                                        new SimpleTypeDenoter(
                                          new Identifier(
                                            "Integer",
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                      ),
                                    dummyPosition()
                                      ),
                                    dummyPosition()
                                      ),
                                    new IfCommand(
                                        new BinaryExpression(
                                          new VnameExpression(
                                            new SimpleVname(
                                              new Identifier(
                                                "idx",
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          new Operator(
                                            "=",
                                            dummyPosition()
                                            ),
                                          new BinaryExpression(
                                            new VnameExpression(
                                              new SimpleVname(
                                                new Identifier(
                                                  "stop",
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            new Operator(
                                              "-",
                                              dummyPosition()
                                              ),
                                            new IntegerExpression(
                                              new IntegerLiteral(
                                                "1",
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                              ),
                                            dummyPosition()
                                              ),
                                            new CallCommand(
                                                new Identifier(
                                                  "getint",
                                                  dummyPosition()
                                                  ),
                                                new SingleActualParameterSequence(
                                                  new VarActualParameter(
                                                    new SubscriptVname(
                                                      new SimpleVname(
                                                        new Identifier(
                                                          "a",
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      new VnameExpression(
                                                        new SimpleVname(
                                                          new Identifier(
                                                            "idx",
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                dummyPosition()
                                                  ),
                                                dummyPosition()
                                                  ),
                                                dummyPosition()
                                                  ),
                                                new SequentialCommand(
                                                    new CallCommand(
                                                      new Identifier(
                                                        "getint",
                                                        dummyPosition()
                                                        ),
                                                      new SingleActualParameterSequence(
                                                        new VarActualParameter(
                                                          new SubscriptVname(
                                                            new SimpleVname(
                                                              new Identifier(
                                                                "a",
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            new VnameExpression(
                                                              new SimpleVname(
                                                                new Identifier(
                                                                  "idx",
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                      dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                        ),
                                                      new CallCommand(
                                                          new Identifier(
                                                            "readNumsSub",
                                                            dummyPosition()
                                                            ),
                                                          new MultipleActualParameterSequence(
                                                            new VarActualParameter(
                                                              new SimpleVname(
                                                                new Identifier(
                                                                  "a",
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            new MultipleActualParameterSequence(
                                                              new ConstActualParameter(
                                                                new BinaryExpression(
                                                                  new VnameExpression(
                                                                    new SimpleVname(
                                                                      new Identifier(
                                                                        "idx",
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                  new Operator(
                                                                    "+",
                                                                    dummyPosition()
                                                                    ),
                                                                  new IntegerExpression(
                                                                    new IntegerLiteral(
                                                                      "1",
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    ),
                                                                  new SingleActualParameterSequence(
                                                                      new ConstActualParameter(
                                                                        new VnameExpression(
                                                                          new SimpleVname(
                                                                            new Identifier(
                                                                              "stop",
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                            ),
                                                                          dummyPosition()
                                                                          ),
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                                  dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    ),
                                                                  new ProcDeclaration(
                                                                      new Identifier(
                                                                        "readNums",
                                                                        dummyPosition()
                                                                        ),
                                                                      new SingleFormalParameterSequence(
                                                                        new VarFormalParameter(
                                                                          new Identifier(
                                                                            "a",
                                                                            dummyPosition()
                                                                            ),
                                                                          new ArrayTypeDenoter(
                                                                            new IntegerLiteral(
                                                                              "10",
                                                                              dummyPosition()
                                                                              ),
                                                                            new SimpleTypeDenoter(
                                                                              new Identifier(
                                                                                "Integer",
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                            ),
                                                                          dummyPosition()
                                                                          ),
                                                                          dummyPosition()
                                                                            ),
                                                                          new CallCommand(
                                                                              new Identifier(
                                                                                "readNumsSub",
                                                                                dummyPosition()
                                                                                ),
                                                                              new MultipleActualParameterSequence(
                                                                                new VarActualParameter(
                                                                                  new SimpleVname(
                                                                                    new Identifier(
                                                                                      "a",
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                  ),
                                                                                new MultipleActualParameterSequence(
                                                                                  new ConstActualParameter(
                                                                                    new IntegerExpression(
                                                                                      new IntegerLiteral(
                                                                                        "0",
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  new SingleActualParameterSequence(
                                                                                    new ConstActualParameter(
                                                                                      new IntegerExpression(
                                                                                        new IntegerLiteral(
                                                                                          "10",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                    ),
                                                                                  new ProcDeclaration(
                                                                                      new Identifier(
                                                                                        "displaySub",
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      new MultipleFormalParameterSequence(
                                                                                        new ConstFormalParameter(
                                                                                          new Identifier(
                                                                                            "a",
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          new ArrayTypeDenoter(
                                                                                            new IntegerLiteral(
                                                                                              "10",
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            new SimpleTypeDenoter(
                                                                                              new Identifier(
                                                                                                "Integer",
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                          ),
                                                                                          new MultipleFormalParameterSequence(
                                                                                              new ConstFormalParameter(
                                                                                                new Identifier(
                                                                                                  "idx",
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                new SimpleTypeDenoter(
                                                                                                  new Identifier(
                                                                                                    "Integer",
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              new SingleFormalParameterSequence(
                                                                                                new ConstFormalParameter(
                                                                                                  new Identifier(
                                                                                                    "stop",
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  new SimpleTypeDenoter(
                                                                                                    new Identifier(
                                                                                                      "Integer",
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                                ),
                                                                                              new IfCommand(
                                                                                                  new BinaryExpression(
                                                                                                    new VnameExpression(
                                                                                                      new SimpleVname(
                                                                                                        new Identifier(
                                                                                                          "idx",
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    new Operator(
                                                                                                      "=",
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    new BinaryExpression(
                                                                                                      new VnameExpression(
                                                                                                        new SimpleVname(
                                                                                                          new Identifier(
                                                                                                            "stop",
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      new Operator(
                                                                                                        "-",
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      new IntegerExpression(
                                                                                                        new IntegerLiteral(
                                                                                                          "1",
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      new CallCommand(
                                                                                                          new Identifier(
                                                                                                            "putint",
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          new SingleActualParameterSequence(
                                                                                                            new ConstActualParameter(
                                                                                                              new VnameExpression(
                                                                                                                new SubscriptVname(
                                                                                                                  new SimpleVname(
                                                                                                                    new Identifier(
                                                                                                                      "a",
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  new VnameExpression(
                                                                                                                    new SimpleVname(
                                                                                                                      new Identifier(
                                                                                                                        "idx",
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                  ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      new SequentialCommand(
                                                                                                          new SequentialCommand(
                                                                                                            new CallCommand(
                                                                                                              new Identifier(
                                                                                                                "putint",
                                                                                                                dummyPosition()
                                                                                                                ),
                                                                                                              new SingleActualParameterSequence(
                                                                                                                new ConstActualParameter(
                                                                                                                  new VnameExpression(
                                                                                                                    new SubscriptVname(
                                                                                                                      new SimpleVname(
                                                                                                                        new Identifier(
                                                                                                                          "a",
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      new VnameExpression(
                                                                                                                        new SimpleVname(
                                                                                                                          new Identifier(
                                                                                                                            "idx",
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      new CallCommand(
                                                                                                          new Identifier(
                                                                                                            "puteol",
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          new EmptyActualParameterSequence(
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      new CallCommand(
                                                                                                          new Identifier(
                                                                                                            "displaySub",
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          new MultipleActualParameterSequence(
                                                                                                            new ConstActualParameter(
                                                                                                              new VnameExpression(
                                                                                                                new SimpleVname(
                                                                                                                  new Identifier(
                                                                                                                    "a",
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                  ),
                                                                                                                dummyPosition()
                                                                                                                ),
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            new MultipleActualParameterSequence(
                                                                                                              new ConstActualParameter(
                                                                                                                new BinaryExpression(
                                                                                                                  new VnameExpression(
                                                                                                                    new SimpleVname(
                                                                                                                      new Identifier(
                                                                                                                        "idx",
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  new Operator(
                                                                                                                    "+",
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  new IntegerExpression(
                                                                                                                    new IntegerLiteral(
                                                                                                                      "1",
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  new SingleActualParameterSequence(
                                                                                                                      new ConstActualParameter(
                                                                                                                        new VnameExpression(
                                                                                                                          new SimpleVname(
                                                                                                                            new Identifier(
                                                                                                                              "stop",
                                                                                                                              dummyPosition()
                                                                                                                              ),
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  new ProcDeclaration(
                                                                                                                      new Identifier(
                                                                                                                        "display",
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      new SingleFormalParameterSequence(
                                                                                                                        new ConstFormalParameter(
                                                                                                                          new Identifier(
                                                                                                                            "a",
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          new ArrayTypeDenoter(
                                                                                                                            new IntegerLiteral(
                                                                                                                              "10",
                                                                                                                              dummyPosition()
                                                                                                                              ),
                                                                                                                            new SimpleTypeDenoter(
                                                                                                                              new Identifier(
                                                                                                                                "Integer",
                                                                                                                                dummyPosition()
                                                                                                                                ),
                                                                                                                              dummyPosition()
                                                                                                                              ),
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                          dummyPosition()
                                                                                                                            ),
                                                                                                                          new CallCommand(
                                                                                                                              new Identifier(
                                                                                                                                "displaySub",
                                                                                                                                dummyPosition()
                                                                                                                                ),
                                                                                                                              new MultipleActualParameterSequence(
                                                                                                                                new ConstActualParameter(
                                                                                                                                  new VnameExpression(
                                                                                                                                    new SimpleVname(
                                                                                                                                      new Identifier(
                                                                                                                                        "a",
                                                                                                                                        dummyPosition()
                                                                                                                                        ),
                                                                                                                                      dummyPosition()
                                                                                                                                      ),
                                                                                                                                    dummyPosition()
                                                                                                                                    ),
                                                                                                                                  dummyPosition()
                                                                                                                                  ),
                                                                                                                                new MultipleActualParameterSequence(
                                                                                                                                  new ConstActualParameter(
                                                                                                                                    new IntegerExpression(
                                                                                                                                      new IntegerLiteral(
                                                                                                                                        "0",
                                                                                                                                        dummyPosition()
                                                                                                                                        ),
                                                                                                                                      dummyPosition()
                                                                                                                                      ),
                                                                                                                                    dummyPosition()
                                                                                                                                    ),
                                                                                                                                  new SingleActualParameterSequence(
                                                                                                                                    new ConstActualParameter(
                                                                                                                                      new IntegerExpression(
                                                                                                                                        new IntegerLiteral(
                                                                                                                                          "10",
                                                                                                                                          dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                        ),
                                                                                                                                      dummyPosition()
                                                                                                                                      ),
                                                                                                                                    dummyPosition()
                                                                                                                                    ),
                                                                                                                                  dummyPosition()
                                                                                                                                    ),
                                                                                                                                  dummyPosition()
                                                                                                                                    ),
                                                                                                                                  dummyPosition()
                                                                                                                                    ),
                                                                                                                                  dummyPosition()
                                                                                                                                    ),
                                                                                                                                  dummyPosition()
                                                                                                                                    ),
                                                                                                                                  new ProcDeclaration(
                                                                                                                                      new Identifier(
                                                                                                                                        "insertionSort",
                                                                                                                                        dummyPosition()
                                                                                                                                        ),
                                                                                                                                      new SingleFormalParameterSequence(
                                                                                                                                        new VarFormalParameter(
                                                                                                                                          new Identifier(
                                                                                                                                            "a",
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                          new ArrayTypeDenoter(
                                                                                                                                            new IntegerLiteral(
                                                                                                                                              "10",
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            new SimpleTypeDenoter(
                                                                                                                                              new Identifier(
                                                                                                                                                "Integer",
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                          dummyPosition()
                                                                                                                                          ),
                                                                                                                                          dummyPosition()
                                                                                                                                            ),
                                                                                                                                          new LetCommand(
                                                                                                                                              new SequentialDeclaration(
                                                                                                                                                new SequentialDeclaration(
                                                                                                                                                  new VarDeclaration(
                                                                                                                                                    new Identifier(
                                                                                                                                                      "i",
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    new SimpleTypeDenoter(
                                                                                                                                                      new Identifier(
                                                                                                                                                        "Integer",
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                    ),
                                                                                                                                                  new VarDeclaration(
                                                                                                                                                    new Identifier(
                                                                                                                                                      "key",
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    new SimpleTypeDenoter(
                                                                                                                                                      new Identifier(
                                                                                                                                                        "Integer",
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                    ),
                                                                                                                                                  dummyPosition()
                                                                                                                                                    ),
                                                                                                                                                  new VarDeclaration(
                                                                                                                                                      new Identifier(
                                                                                                                                                        "j",
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      new SimpleTypeDenoter(
                                                                                                                                                        new Identifier(
                                                                                                                                                          "Integer",
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                  dummyPosition()
                                                                                                                                                    ),
                                                                                                                                                  new SequentialCommand(
                                                                                                                                                      new AssignCommand(
                                                                                                                                                        new SimpleVname(
                                                                                                                                                          new Identifier(
                                                                                                                                                            "i",
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        new IntegerExpression(
                                                                                                                                                          new IntegerLiteral(
                                                                                                                                                            "1",
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      new WhileCommand(
                                                                                                                                                        new BinaryExpression(
                                                                                                                                                          new VnameExpression(
                                                                                                                                                            new SimpleVname(
                                                                                                                                                              new Identifier(
                                                                                                                                                                "i",
                                                                                                                                                                dummyPosition()
                                                                                                                                                                ),
                                                                                                                                                              dummyPosition()
                                                                                                                                                              ),
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          new Operator(
                                                                                                                                                            "<",
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          new IntegerExpression(
                                                                                                                                                            new IntegerLiteral(
                                                                                                                                                              "10",
                                                                                                                                                              dummyPosition()
                                                                                                                                                              ),
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          new SequentialCommand(
                                                                                                                                                              new SequentialCommand(
                                                                                                                                                                new SequentialCommand(
                                                                                                                                                                  new SequentialCommand(
                                                                                                                                                                    new SequentialCommand(
                                                                                                                                                                      new AssignCommand(
                                                                                                                                                                        new SimpleVname(
                                                                                                                                                                          new Identifier(
                                                                                                                                                                            "key",
                                                                                                                                                                            dummyPosition()
                                                                                                                                                                            ),
                                                                                                                                                                          dummyPosition()
                                                                                                                                                                          ),
                                                                                                                                                                        new VnameExpression(
                                                                                                                                                                          new SubscriptVname(
                                                                                                                                                                            new SimpleVname(
                                                                                                                                                                              new Identifier(
                                                                                                                                                                                "a",
                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                ),
                                                                                                                                                                              dummyPosition()
                                                                                                                                                                              ),
                                                                                                                                                                            new VnameExpression(
                                                                                                                                                                              new SimpleVname(
                                                                                                                                                                                new Identifier(
                                                                                                                                                                                  "i",
                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                  ),
                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                ),
                                                                                                                                                                              dummyPosition()
                                                                                                                                                                              ),
                                                                                                                                                                            dummyPosition()
                                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          new AssignCommand(
                                                                                                                                                              new SimpleVname(
                                                                                                                                                                new Identifier(
                                                                                                                                                                  "j",
                                                                                                                                                                  dummyPosition()
                                                                                                                                                                  ),
                                                                                                                                                                dummyPosition()
                                                                                                                                                                ),
                                                                                                                                                              new BinaryExpression(
                                                                                                                                                                new VnameExpression(
                                                                                                                                                                  new SimpleVname(
                                                                                                                                                                    new Identifier(
                                                                                                                                                                      "i",
                                                                                                                                                                      dummyPosition()
                                                                                                                                                                      ),
                                                                                                                                                                    dummyPosition()
                                                                                                                                                                    ),
                                                                                                                                                                  dummyPosition()
                                                                                                                                                                  ),
                                                                                                                                                                new Operator(
                                                                                                                                                                  "-",
                                                                                                                                                                  dummyPosition()
                                                                                                                                                                  ),
                                                                                                                                                                new IntegerExpression(
                                                                                                                                                                  new IntegerLiteral(
                                                                                                                                                                    "1",
                                                                                                                                                                    dummyPosition()
                                                                                                                                                                    ),
                                                                                                                                                                  dummyPosition()
                                                                                                                                                                  ),
                                                                                                                                                                dummyPosition()
                                                                                                                                                                  ),
                                                                                                                                                                dummyPosition()
                                                                                                                                                                  ),
                                                                                                                                                                dummyPosition()
                                                                                                                                                                  ),
                                                                                                                                                                new WhileCommand(
                                                                                                                                                                    new BinaryExpression(
                                                                                                                                                                      new BinaryExpression(
                                                                                                                                                                        new VnameExpression(
                                                                                                                                                                          new SimpleVname(
                                                                                                                                                                            new Identifier(
                                                                                                                                                                              "j",
                                                                                                                                                                              dummyPosition()
                                                                                                                                                                              ),
                                                                                                                                                                            dummyPosition()
                                                                                                                                                                            ),
                                                                                                                                                                          dummyPosition()
                                                                                                                                                                          ),
                                                                                                                                                                        new Operator(
                                                                                                                                                                          ">=",
                                                                                                                                                                          dummyPosition()
                                                                                                                                                                          ),
                                                                                                                                                                        new IntegerExpression(
                                                                                                                                                                          new IntegerLiteral(
                                                                                                                                                                            "0",
                                                                                                                                                                            dummyPosition()
                                                                                                                                                                            ),
                                                                                                                                                                          dummyPosition()
                                                                                                                                                                          ),
                                                                                                                                                                        dummyPosition()
                                                                                                                                                                          ),
                                                                                                                                                                        new Operator(
                                                                                                                                                                            "/\\",
                                                                                                                                                                            dummyPosition()
                                                                                                                                                                            ),
                                                                                                                                                                        new BinaryExpression(
                                                                                                                                                                            new VnameExpression(
                                                                                                                                                                              new SubscriptVname(
                                                                                                                                                                                new SimpleVname(
                                                                                                                                                                                  new Identifier(
                                                                                                                                                                                    "a",
                                                                                                                                                                                    dummyPosition()
                                                                                                                                                                                    ),
                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                  ),
                                                                                                                                                                                new VnameExpression(
                                                                                                                                                                                  new SimpleVname(
                                                                                                                                                                                    new Identifier(
                                                                                                                                                                                      "j",
                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                      ),
                                                                                                                                                                                    dummyPosition()
                                                                                                                                                                                    ),
                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                  ),
                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                ),
                                                                                                                                                                        dummyPosition()
                                                                                                                                                                          ),
                                                                                                                                                                        new Operator(
                                                                                                                                                                            ">",
                                                                                                                                                                            dummyPosition()
                                                                                                                                                                            ),
                                                                                                                                                                        new VnameExpression(
                                                                                                                                                                            new SimpleVname(
                                                                                                                                                                              new Identifier(
                                                                                                                                                                                "key",
                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                ),
                                                                                                                                                                              dummyPosition()
                                                                                                                                                                              ),
                                                                                                                                                                            dummyPosition()
                                                                                                                                                                            ),
                                                                                                                                                                        dummyPosition()
                                                                                                                                                                          ),
                                                                                                                                                                        dummyPosition()
                                                                                                                                                                          ),
                                                                                                                                                                        new SequentialCommand(
                                                                                                                                                                            new AssignCommand(
                                                                                                                                                                              new SubscriptVname(
                                                                                                                                                                                new SimpleVname(
                                                                                                                                                                                  new Identifier(
                                                                                                                                                                                    "a",
                                                                                                                                                                                    dummyPosition()
                                                                                                                                                                                    ),
                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                  ),
                                                                                                                                                                                new BinaryExpression(
                                                                                                                                                                                  new VnameExpression(
                                                                                                                                                                                    new SimpleVname(
                                                                                                                                                                                      new Identifier(
                                                                                                                                                                                        "j",
                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                        ),
                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                      ),
                                                                                                                                                                                    dummyPosition()
                                                                                                                                                                                    ),
                                                                                                                                                                                  new Operator(
                                                                                                                                                                                    "+",
                                                                                                                                                                                    dummyPosition()
                                                                                                                                                                                    ),
                                                                                                                                                                                  new IntegerExpression(
                                                                                                                                                                                    new IntegerLiteral(
                                                                                                                                                                                      "1",
                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                      ),
                                                                                                                                                                                    dummyPosition()
                                                                                                                                                                                    ),
                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                    ),
                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                    ),
                                                                                                                                                                                  new VnameExpression(
                                                                                                                                                                                      new SubscriptVname(
                                                                                                                                                                                        new SimpleVname(
                                                                                                                                                                                          new Identifier(
                                                                                                                                                                                            "a",
                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                            ),
                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                          ),
                                                                                                                                                                                        new VnameExpression(
                                                                                                                                                                                          new SimpleVname(
                                                                                                                                                                                            new Identifier(
                                                                                                                                                                                              "j",
                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                              ),
                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                            ),
                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                          ),
                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                        ),
                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                    ),
                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                    ),
                                                                                                                                                                                  new AssignCommand(
                                                                                                                                                                                      new SimpleVname(
                                                                                                                                                                                        new Identifier(
                                                                                                                                                                                          "j",
                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                          ),
                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                        ),
                                                                                                                                                                                      new BinaryExpression(
                                                                                                                                                                                        new VnameExpression(
                                                                                                                                                                                          new SimpleVname(
                                                                                                                                                                                            new Identifier(
                                                                                                                                                                                              "j",
                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                              ),
                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                            ),
                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                          ),
                                                                                                                                                                                        new Operator(
                                                                                                                                                                                          "-",
                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                          ),
                                                                                                                                                                                        new IntegerExpression(
                                                                                                                                                                                          new IntegerLiteral(
                                                                                                                                                                                            "1",
                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                            ),
                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                          ),
                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                          ),
                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                          ),
                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                          ),
                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                          ),
                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                          ),
                                                                                                                                                                                        new AssignCommand(
                                                                                                                                                                                            new SubscriptVname(
                                                                                                                                                                                              new SimpleVname(
                                                                                                                                                                                                new Identifier(
                                                                                                                                                                                                  "a",
                                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                                  ),
                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                ),
                                                                                                                                                                                              new BinaryExpression(
                                                                                                                                                                                                new VnameExpression(
                                                                                                                                                                                                  new SimpleVname(
                                                                                                                                                                                                    new Identifier(
                                                                                                                                                                                                      "j",
                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                      ),
                                                                                                                                                                                                    dummyPosition()
                                                                                                                                                                                                    ),
                                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                                  ),
                                                                                                                                                                                                new Operator(
                                                                                                                                                                                                  "+",
                                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                                  ),
                                                                                                                                                                                                new IntegerExpression(
                                                                                                                                                                                                  new IntegerLiteral(
                                                                                                                                                                                                    "1",
                                                                                                                                                                                                    dummyPosition()
                                                                                                                                                                                                    ),
                                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                                  ),
                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                  ),
                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                  ),
                                                                                                                                                                                                new VnameExpression(
                                                                                                                                                                                                    new SimpleVname(
                                                                                                                                                                                                      new Identifier(
                                                                                                                                                                                                        "key",
                                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                      ),
                                                                                                                                                                                                    dummyPosition()
                                                                                                                                                                                                    ),
                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                  ),
                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                  ),
                                                                                                                                                                                                new AssignCommand(
                                                                                                                                                                                                    new SimpleVname(
                                                                                                                                                                                                      new Identifier(
                                                                                                                                                                                                        "i",
                                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                      ),
                                                                                                                                                                                                    new BinaryExpression(
                                                                                                                                                                                                      new VnameExpression(
                                                                                                                                                                                                        new SimpleVname(
                                                                                                                                                                                                          new Identifier(
                                                                                                                                                                                                            "i",
                                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                                            ),
                                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                                          ),
                                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      new Operator(
                                                                                                                                                                                                        "+",
                                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      new IntegerExpression(
                                                                                                                                                                                                        new IntegerLiteral(
                                                                                                                                                                                                          "1",
                                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                                          ),
                                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      new EmptyCommand(
                                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                                          ),
                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      new SequentialCommand(
                                                                                                                                                                                                          new SequentialCommand(
                                                                                                                                                                                                            new SequentialCommand(
                                                                                                                                                                                                              new SequentialCommand(
                                                                                                                                                                                                                new SequentialCommand(
                                                                                                                                                                                                                  new SequentialCommand(
                                                                                                                                                                                                                    new SequentialCommand(
                                                                                                                                                                                                                      new CallCommand(
                                                                                                                                                                                                                        new Identifier(
                                                                                                                                                                                                                          "readNums",
                                                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                                                          ),
                                                                                                                                                                                                                        new SingleActualParameterSequence(
                                                                                                                                                                                                                          new VarActualParameter(
                                                                                                                                                                                                                            new SimpleVname(
                                                                                                                                                                                                                              new Identifier(
                                                                                                                                                                                                                                "s",
                                                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                                                ),
                                                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                                                              ),
                                                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                                                            ),
                                                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                                                          ),
                                                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                                                        ),
                                                                                                                                                                                                      new CallCommand(
                                                                                                                                                                                                          new Identifier(
                                                                                                                                                                                                            "puteol",
                                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                                            ),
                                                                                                                                                                                                          new EmptyActualParameterSequence(
                                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                                            ),
                                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                                          ),
                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      new CallCommand(
                                                                                                                                                                                                          new Identifier(
                                                                                                                                                                                                            "puteol",
                                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                                            ),
                                                                                                                                                                                                          new EmptyActualParameterSequence(
                                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                                            ),
                                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                                          ),
                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      new CallCommand(
                                                                                                                                                                                                          new Identifier(
                                                                                                                                                                                                            "display",
                                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                                            ),
                                                                                                                                                                                                          new SingleActualParameterSequence(
                                                                                                                                                                                                            new ConstActualParameter(
                                                                                                                                                                                                              new VnameExpression(
                                                                                                                                                                                                                new SimpleVname(
                                                                                                                                                                                                                  new Identifier(
                                                                                                                                                                                                                    "s",
                                                                                                                                                                                                                    dummyPosition()
                                                                                                                                                                                                                    ),
                                                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                                                  ),
                                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                                ),
                                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                                              ),
                                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                                            ),
                                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                                            ),
                                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                                            ),
                                                                                                                                                                                                          new CallCommand(
                                                                                                                                                                                                              new Identifier(
                                                                                                                                                                                                                "puteol",
                                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                                ),
                                                                                                                                                                                                              new EmptyActualParameterSequence(
                                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                                ),
                                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                                              ),
                                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                                            ),
                                                                                                                                                                                                          new CallCommand(
                                                                                                                                                                                                              new Identifier(
                                                                                                                                                                                                                "puteol",
                                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                                ),
                                                                                                                                                                                                              new EmptyActualParameterSequence(
                                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                                ),
                                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                                              ),
                                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                                            ),
                                                                                                                                                                                                          new CallCommand(
                                                                                                                                                                                                              new Identifier(
                                                                                                                                                                                                                "insertionSort",
                                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                                ),
                                                                                                                                                                                                              new SingleActualParameterSequence(
                                                                                                                                                                                                                new VarActualParameter(
                                                                                                                                                                                                                  new SimpleVname(
                                                                                                                                                                                                                    new Identifier(
                                                                                                                                                                                                                      "s",
                                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                                      ),
                                                                                                                                                                                                                    dummyPosition()
                                                                                                                                                                                                                    ),
                                                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                                                  ),
                                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                                ),
                                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                                              ),
                                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                                            ),
                                                                                                                                                                                                          new CallCommand(
                                                                                                                                                                                                              new Identifier(
                                                                                                                                                                                                                "display",
                                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                                ),
                                                                                                                                                                                                              new SingleActualParameterSequence(
                                                                                                                                                                                                                new ConstActualParameter(
                                                                                                                                                                                                                  new VnameExpression(
                                                                                                                                                                                                                    new SimpleVname(
                                                                                                                                                                                                                      new Identifier(
                                                                                                                                                                                                                        "s",
                                                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                                                        ),
                                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                                      ),
                                                                                                                                                                                                                    dummyPosition()
                                                                                                                                                                                                                    ),
                                                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                                                  ),
                                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                                ),
                                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                                                ),
                                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                                                ),
                                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                                                ),
                                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                                                );

    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }

  public void testRationals() {
    String filename = "samples/source/rationals.t";
    Scanner scanner = new Scanner(filename);
    Parser parser = new Parser(scanner);
    Program expectedProgram =
      new Program(
          new LetCommand(
            new SequentialDeclaration(
              new SequentialDeclaration(
                new SequentialDeclaration(
                  new SequentialDeclaration(
                    new SequentialDeclaration(
                      new SequentialDeclaration(
                        new SequentialDeclaration(
                          new SequentialDeclaration(
                            new SequentialDeclaration(
                              new TypeDeclaration(
                                new Identifier(
                                  "Rational",
                                  dummyPosition()
                                  ),
                                new RecordTypeDenoter(
                                  new MultipleFieldTypeDenoter(
                                    new Identifier(
                                      "numerator",
                                      dummyPosition()
                                      ),
                                    new SimpleTypeDenoter(
                                      new Identifier(
                                        "Integer",
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                      ),
                                    new SingleFieldTypeDenoter(
                                      new Identifier(
                                        "denominator",
                                        dummyPosition()
                                        ),
                                      new SimpleTypeDenoter(
                                        new Identifier(
                                          "Integer",
                                          dummyPosition()
                                          ),
                                        dummyPosition()
                                        ),
                                      dummyPosition()
                                      ),
                                    dummyPosition()
                                      ),
                                    dummyPosition()
                                      ),
                                    dummyPosition()
                                      ),
                                    new FuncDeclaration(
                                        new Identifier(
                                          "gcd",
                                          dummyPosition()
                                          ),
                                        new MultipleFormalParameterSequence(
                                          new ConstFormalParameter(
                                            new Identifier(
                                              "x",
                                              dummyPosition()
                                              ),
                                            new SimpleTypeDenoter(
                                              new Identifier(
                                                "Integer",
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          new SingleFormalParameterSequence(
                                            new ConstFormalParameter(
                                              new Identifier(
                                                "y",
                                                dummyPosition()
                                                ),
                                              new SimpleTypeDenoter(
                                                new Identifier(
                                                  "Integer",
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                            dummyPosition()
                                            ),
                                          dummyPosition()
                                            ),
                                          new SimpleTypeDenoter(
                                              new Identifier(
                                                "Integer",
                                                dummyPosition()
                                                ),
                                              dummyPosition()
                                              ),
                                          new IfExpression(
                                              new BinaryExpression(
                                                new VnameExpression(
                                                  new SimpleVname(
                                                    new Identifier(
                                                      "y",
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                                new Operator(
                                                  "=",
                                                  dummyPosition()
                                                  ),
                                                new IntegerExpression(
                                                  new IntegerLiteral(
                                                    "0",
                                                    dummyPosition()
                                                    ),
                                                  dummyPosition()
                                                  ),
                                                dummyPosition()
                                                  ),
                                                new VnameExpression(
                                                    new SimpleVname(
                                                      new Identifier(
                                                        "x",
                                                        dummyPosition()
                                                        ),
                                                      dummyPosition()
                                                      ),
                                                    dummyPosition()
                                                    ),
                                                new CallExpression(
                                                    new Identifier(
                                                      "gcd",
                                                      dummyPosition()
                                                      ),
                                                    new MultipleActualParameterSequence(
                                                      new ConstActualParameter(
                                                        new VnameExpression(
                                                          new SimpleVname(
                                                            new Identifier(
                                                              "y",
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                            ),
                                                          dummyPosition()
                                                          ),
                                                        dummyPosition()
                                                        ),
                                                      new SingleActualParameterSequence(
                                                        new ConstActualParameter(
                                                          new BinaryExpression(
                                                            new VnameExpression(
                                                              new SimpleVname(
                                                                new Identifier(
                                                                  "x",
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            new Operator(
                                                              "//",
                                                              dummyPosition()
                                                              ),
                                                            new VnameExpression(
                                                              new SimpleVname(
                                                                new Identifier(
                                                                  "y",
                                                                  dummyPosition()
                                                                  ),
                                                                dummyPosition()
                                                                ),
                                                              dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                              ),
                                                            dummyPosition()
                                                              ),
                                                            new FuncDeclaration(
                                                                new Identifier(
                                                                  "makerational",
                                                                  dummyPosition()
                                                                  ),
                                                                new MultipleFormalParameterSequence(
                                                                  new ConstFormalParameter(
                                                                    new Identifier(
                                                                      "n",
                                                                      dummyPosition()
                                                                      ),
                                                                    new SimpleTypeDenoter(
                                                                      new Identifier(
                                                                        "Integer",
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                  new SingleFormalParameterSequence(
                                                                    new ConstFormalParameter(
                                                                      new Identifier(
                                                                        "d",
                                                                        dummyPosition()
                                                                        ),
                                                                      new SimpleTypeDenoter(
                                                                        new Identifier(
                                                                          "Integer",
                                                                          dummyPosition()
                                                                          ),
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                                    dummyPosition()
                                                                    ),
                                                                  dummyPosition()
                                                                    ),
                                                                  new SimpleTypeDenoter(
                                                                      new Identifier(
                                                                        "Rational",
                                                                        dummyPosition()
                                                                        ),
                                                                      dummyPosition()
                                                                      ),
                                                                  new LetExpression(
                                                                      new ConstDeclaration(
                                                                        new Identifier(
                                                                          "g",
                                                                          dummyPosition()
                                                                          ),
                                                                        new CallExpression(
                                                                          new Identifier(
                                                                            "gcd",
                                                                            dummyPosition()
                                                                            ),
                                                                          new MultipleActualParameterSequence(
                                                                            new ConstActualParameter(
                                                                              new VnameExpression(
                                                                                new SimpleVname(
                                                                                  new Identifier(
                                                                                    "n",
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            new SingleActualParameterSequence(
                                                                              new ConstActualParameter(
                                                                                new VnameExpression(
                                                                                  new SimpleVname(
                                                                                    new Identifier(
                                                                                      "d",
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  dummyPosition()
                                                                                  ),
                                                                                dummyPosition()
                                                                                ),
                                                                              dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                              ),
                                                                            dummyPosition()
                                                                              ),
                                                                            new RecordExpression(
                                                                                new MultipleRecordAggregate(
                                                                                  new Identifier(
                                                                                    "numerator",
                                                                                    dummyPosition()
                                                                                    ),
                                                                                  new BinaryExpression(
                                                                                    new VnameExpression(
                                                                                      new SimpleVname(
                                                                                        new Identifier(
                                                                                          "n",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    new Operator(
                                                                                      "/",
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    new VnameExpression(
                                                                                      new SimpleVname(
                                                                                        new Identifier(
                                                                                          "g",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        dummyPosition()
                                                                                        ),
                                                                                      dummyPosition()
                                                                                      ),
                                                                                    dummyPosition()
                                                                                      ),
                                                                                    new SingleRecordAggregate(
                                                                                        new Identifier(
                                                                                          "denominator",
                                                                                          dummyPosition()
                                                                                          ),
                                                                                        new BinaryExpression(
                                                                                          new VnameExpression(
                                                                                            new SimpleVname(
                                                                                              new Identifier(
                                                                                                "d",
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          new Operator(
                                                                                            "/",
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          new VnameExpression(
                                                                                            new SimpleVname(
                                                                                              new Identifier(
                                                                                                "g",
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              dummyPosition()
                                                                                              ),
                                                                                            dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          dummyPosition()
                                                                                            ),
                                                                                          new ProcDeclaration(
                                                                                              new Identifier(
                                                                                                "readrational",
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              new SingleFormalParameterSequence(
                                                                                                new VarFormalParameter(
                                                                                                  new Identifier(
                                                                                                    "r",
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  new SimpleTypeDenoter(
                                                                                                    new Identifier(
                                                                                                      "Rational",
                                                                                                      dummyPosition()
                                                                                                      ),
                                                                                                    dummyPosition()
                                                                                                    ),
                                                                                                  dummyPosition()
                                                                                                  ),
                                                                                                dummyPosition()
                                                                                                ),
                                                                                              new SequentialCommand(
                                                                                                  new SequentialCommand(
                                                                                                    new CallCommand(
                                                                                                      new Identifier(
                                                                                                        "getint",
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      new SingleActualParameterSequence(
                                                                                                        new VarActualParameter(
                                                                                                          new DotVname(
                                                                                                            new SimpleVname(
                                                                                                              new Identifier(
                                                                                                                "r",
                                                                                                                dummyPosition()
                                                                                                                ),
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            new Identifier(
                                                                                                              "numerator",
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                          ),
                                                                                                        dummyPosition()
                                                                                                        ),
                                                                                                      dummyPosition()
                                                                                                        ),
                                                                                                      new CallCommand(
                                                                                                          new Identifier(
                                                                                                            "getint",
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          new SingleActualParameterSequence(
                                                                                                            new VarActualParameter(
                                                                                                              new DotVname(
                                                                                                                new SimpleVname(
                                                                                                                  new Identifier(
                                                                                                                    "r",
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                  ),
                                                                                                                new Identifier(
                                                                                                                  "denominator",
                                                                                                                  dummyPosition()
                                                                                                                  ),
                                                                                                                dummyPosition()
                                                                                                                ),
                                                                                                              dummyPosition()
                                                                                                              ),
                                                                                                            dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                            ),
                                                                                                          dummyPosition()
                                                                                                            ),
                                                                                                          new AssignCommand(
                                                                                                              new SimpleVname(
                                                                                                                new Identifier(
                                                                                                                  "r",
                                                                                                                  dummyPosition()
                                                                                                                  ),
                                                                                                                dummyPosition()
                                                                                                                ),
                                                                                                              new CallExpression(
                                                                                                                new Identifier(
                                                                                                                  "makerational",
                                                                                                                  dummyPosition()
                                                                                                                  ),
                                                                                                                new MultipleActualParameterSequence(
                                                                                                                  new ConstActualParameter(
                                                                                                                    new VnameExpression(
                                                                                                                      new DotVname(
                                                                                                                        new SimpleVname(
                                                                                                                          new Identifier(
                                                                                                                            "r",
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        new Identifier(
                                                                                                                          "numerator",
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                              new SingleActualParameterSequence(
                                                                                                                  new ConstActualParameter(
                                                                                                                    new VnameExpression(
                                                                                                                      new DotVname(
                                                                                                                        new SimpleVname(
                                                                                                                          new Identifier(
                                                                                                                            "r",
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        new Identifier(
                                                                                                                          "denominator",
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                              dummyPosition()
                                                                                                                ),
                                                                                                              dummyPosition()
                                                                                                                ),
                                                                                                              dummyPosition()
                                                                                                                ),
                                                                                                              dummyPosition()
                                                                                                                ),
                                                                                                              dummyPosition()
                                                                                                                ),
                                                                                                              dummyPosition()
                                                                                                                ),
                                                                                                              dummyPosition()
                                                                                                                ),
                                                                                                              new ProcDeclaration(
                                                                                                                  new Identifier(
                                                                                                                    "displayrational",
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  new SingleFormalParameterSequence(
                                                                                                                    new ConstFormalParameter(
                                                                                                                      new Identifier(
                                                                                                                        "r",
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      new SimpleTypeDenoter(
                                                                                                                        new Identifier(
                                                                                                                          "Rational",
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                    dummyPosition()
                                                                                                                    ),
                                                                                                                  new SequentialCommand(
                                                                                                                      new SequentialCommand(
                                                                                                                        new SequentialCommand(
                                                                                                                          new SequentialCommand(
                                                                                                                            new SequentialCommand(
                                                                                                                              new SequentialCommand(
                                                                                                                                new CallCommand(
                                                                                                                                  new Identifier(
                                                                                                                                    "put",
                                                                                                                                    dummyPosition()
                                                                                                                                    ),
                                                                                                                                  new SingleActualParameterSequence(
                                                                                                                                    new ConstActualParameter(
                                                                                                                                      new CharacterExpression(
                                                                                                                                        new CharacterLiteral(
                                                                                                                                          "{",
                                                                                                                                          dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                        ),
                                                                                                                                      dummyPosition()
                                                                                                                                      ),
                                                                                                                                    dummyPosition()
                                                                                                                                    ),
                                                                                                                                  dummyPosition()
                                                                                                                                  ),
                                                                                                                  new CallCommand(
                                                                                                                      new Identifier(
                                                                                                                        "putint",
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      new SingleActualParameterSequence(
                                                                                                                        new ConstActualParameter(
                                                                                                                          new VnameExpression(
                                                                                                                            new DotVname(
                                                                                                                              new SimpleVname(
                                                                                                                                new Identifier(
                                                                                                                                  "r",
                                                                                                                                  dummyPosition()
                                                                                                                                  ),
                                                                                                                                dummyPosition()
                                                                                                                                ),
                                                                                                                              new Identifier(
                                                                                                                                "numerator",
                                                                                                                                dummyPosition()
                                                                                                                                ),
                                                                                                                              dummyPosition()
                                                                                                                              ),
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  new CallCommand(
                                                                                                                      new Identifier(
                                                                                                                        "put",
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      new SingleActualParameterSequence(
                                                                                                                        new ConstActualParameter(
                                                                                                                          new CharacterExpression(
                                                                                                                            new CharacterLiteral(
                                                                                                                              ",",
                                                                                                                              dummyPosition()
                                                                                                                              ),
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  new CallCommand(
                                                                                                                      new Identifier(
                                                                                                                        "putint",
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      new SingleActualParameterSequence(
                                                                                                                        new ConstActualParameter(
                                                                                                                          new VnameExpression(
                                                                                                                            new DotVname(
                                                                                                                              new SimpleVname(
                                                                                                                                new Identifier(
                                                                                                                                  "r",
                                                                                                                                  dummyPosition()
                                                                                                                                  ),
                                                                                                                                dummyPosition()
                                                                                                                                ),
                                                                                                                              new Identifier(
                                                                                                                                "denominator",
                                                                                                                                dummyPosition()
                                                                                                                                ),
                                                                                                                              dummyPosition()
                                                                                                                              ),
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  new CallCommand(
                                                                                                                      new Identifier(
                                                                                                                        "put",
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      new SingleActualParameterSequence(
                                                                                                                        new ConstActualParameter(
                                                                                                                          new CharacterExpression(
                                                                                                                            new CharacterLiteral(
                                                                                                                              "}",
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  new CallCommand(
                                                                                                                      new Identifier(
                                                                                                                        "puteol",
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      new EmptyActualParameterSequence(
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  new EmptyCommand(
                                                                                                                      dummyPosition()
                                                                                                                      ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  dummyPosition()
                                                                                                                    ),
                                                                                                                  new FuncDeclaration(
                                                                                                                      new Identifier(
                                                                                                                        "addrational",
                                                                                                                        dummyPosition()
                                                                                                                        ),
                                                                                                                      new MultipleFormalParameterSequence(
                                                                                                                        new ConstFormalParameter(
                                                                                                                          new Identifier(
                                                                                                                            "r1",
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          new SimpleTypeDenoter(
                                                                                                                            new Identifier(
                                                                                                                              "Rational",
                                                                                                                              dummyPosition()
                                                                                                                              ),
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        new SingleFormalParameterSequence(
                                                                                                                          new ConstFormalParameter(
                                                                                                                            new Identifier(
                                                                                                                              "r2",
                                                                                                                              dummyPosition()
                                                                                                                              ),
                                                                                                                            new SimpleTypeDenoter(
                                                                                                                              new Identifier(
                                                                                                                                "Rational",
                                                                                                                                dummyPosition()
                                                                                                                                ),
                                                                                                                              dummyPosition()
                                                                                                                              ),
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                          dummyPosition()
                                                                                                                          ),
                                                                                                                        dummyPosition()
                                                                                                                          ),
                                                                                                                        new SimpleTypeDenoter(
                                                                                                                            new Identifier(
                                                                                                                              "Rational",
                                                                                                                              dummyPosition()
                                                                                                                              ),
                                                                                                                            dummyPosition()
                                                                                                                            ),
                                                                                                                        new LetExpression(
                                                                                                                            new SequentialDeclaration(
                                                                                                                              new ConstDeclaration(
                                                                                                                                new Identifier(
                                                                                                                                  "num",
                                                                                                                                  dummyPosition()
                                                                                                                                  ),
                                                                                                                                new BinaryExpression(
                                                                                                                                  new BinaryExpression(
                                                                                                                                    new VnameExpression(
                                                                                                                                      new DotVname(
                                                                                                                                        new SimpleVname(
                                                                                                                                          new Identifier(
                                                                                                                                            "r1",
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                          dummyPosition()
                                                                                                                                          ),
                                                                                                                                        new Identifier(
                                                                                                                                          "numerator",
                                                                                                                                          dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                        ),
                                                                                                                                      dummyPosition()
                                                                                                                                      ),
                                                                                                                                    new Operator(
                                                                                                                                      "*",
                                                                                                                                      dummyPosition()
                                                                                                                                      ),
                                                                                                                                    new VnameExpression(
                                                                                                                                        new DotVname(
                                                                                                                                          new SimpleVname(
                                                                                                                                            new Identifier(
                                                                                                                                              "r2",
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                          new Identifier(
                                                                                                                                            "denominator",
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                          dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                        ),
                                                                                                                                    dummyPosition()
                                                                                                                                      ),
                                                                                                                                    new Operator(
                                                                                                                                        "+",
                                                                                                                                        dummyPosition()
                                                                                                                                        ),
                                                                                                                                    new BinaryExpression(
                                                                                                                                        new VnameExpression(
                                                                                                                                          new DotVname(
                                                                                                                                            new SimpleVname(
                                                                                                                                              new Identifier(
                                                                                                                                                "r1",
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            new Identifier(
                                                                                                                                              "denominator",
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                          dummyPosition()
                                                                                                                                          ),
                                                                                                                                        new Operator(
                                                                                                                                          "*",
                                                                                                                                          dummyPosition()
                                                                                                                                          ),
                                                                                                                                        new VnameExpression(
                                                                                                                                            new DotVname(
                                                                                                                                              new SimpleVname(
                                                                                                                                                new Identifier(
                                                                                                                                                  "r2",
                                                                                                                                                  dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              new Identifier(
                                                                                                                                                "numerator",
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            dummyPosition()
                                                                                                                                            ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        dummyPosition()
                                                                                                                                          ),
                                                                                                                                        new ConstDeclaration(
                                                                                                                                            new Identifier(
                                                                                                                                              "denom",
                                                                                                                                              dummyPosition()
                                                                                                                                              ),
                                                                                                                                            new BinaryExpression(
                                                                                                                                              new VnameExpression(
                                                                                                                                                new DotVname(
                                                                                                                                                  new SimpleVname(
                                                                                                                                                    new Identifier(
                                                                                                                                                      "r1",
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                    ),
                                                                                                                                                  new Identifier(
                                                                                                                                                    "denominator",
                                                                                                                                                    dummyPosition()
                                                                                                                                                    ),
                                                                                                                                                  dummyPosition()
                                                                                                                                                  ),
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              new Operator(
                                                                                                                                                "*",
                                                                                                                                                dummyPosition()
                                                                                                                                                ),
                                                                                                                                              new VnameExpression(
                                                                                                                                                  new DotVname(
                                                                                                                                                    new SimpleVname(
                                                                                                                                                      new Identifier(
                                                                                                                                                        "r2",
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    new Identifier(
                                                                                                                                                      "denominator",
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                    ),
                                                                                                                                                  dummyPosition()
                                                                                                                                                  ),
                                                                                                                                              dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                                ),
                                                                                                                                              dummyPosition()
                                                                                                                                                ),
                                                                                                                                              new CallExpression(
                                                                                                                                                  new Identifier(
                                                                                                                                                    "makerational",
                                                                                                                                                    dummyPosition()
                                                                                                                                                    ),
                                                                                                                                                  new MultipleActualParameterSequence(
                                                                                                                                                    new ConstActualParameter(
                                                                                                                                                      new VnameExpression(
                                                                                                                                                        new SimpleVname(
                                                                                                                                                          new Identifier(
                                                                                                                                                            "num",
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    new SingleActualParameterSequence(
                                                                                                                                                      new ConstActualParameter(
                                                                                                                                                        new VnameExpression(
                                                                                                                                                          new SimpleVname(
                                                                                                                                                            new Identifier(
                                                                                                                                                              "denom",
                                                                                                                                                              dummyPosition()
                                                                                                                                                              ),
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        dummyPosition()
                                                                                                                                                        ),
                                                                                                                                                      dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    dummyPosition()
                                                                                                                                                      ),
                                                                                                                                                    new FuncDeclaration(
                                                                                                                                                        new Identifier(
                                                                                                                                                          "subrational",
                                                                                                                                                          dummyPosition()
                                                                                                                                                          ),
                                                                                                                                                        new MultipleFormalParameterSequence(
                                                                                                                                                          new ConstFormalParameter(
                                                                                                                                                            new Identifier(
                                                                                                                                                              "r1",
                                                                                                                                                              dummyPosition()
                                                                                                                                                              ),
                                                                                                                                                            new SimpleTypeDenoter(
                                                                                                                                                              new Identifier(
                                                                                                                                                                "Rational",
                                                                                                                                                                dummyPosition()
                                                                                                                                                                ),
                                                                                                                                                              dummyPosition()
                                                                                                                                                              ),
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          new SingleFormalParameterSequence(
                                                                                                                                                            new ConstFormalParameter(
                                                                                                                                                              new Identifier(
                                                                                                                                                                "r2",
                                                                                                                                                                dummyPosition()
                                                                                                                                                                ),
                                                                                                                                                              new SimpleTypeDenoter(
                                                                                                                                                                new Identifier(
                                                                                                                                                                  "Rational",
                                                                                                                                                                  dummyPosition()
                                                                                                                                                                  ),
                                                                                                                                                                dummyPosition()
                                                                                                                                                                ),
                                                                                                                                                              dummyPosition()
                                                                                                                                                              ),
                                                                                                                                                            dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          dummyPosition()
                                                                                                                                                            ),
                                                                                                                                                          new SimpleTypeDenoter(
                                                                                                                                                              new Identifier(
                                                                                                                                                                "Rational",
                                                                                                                                                                dummyPosition()
                                                                                                                                                                ),
                                                                                                                                                              dummyPosition()
                                                                                                                                                              ),
                                                                                                                                                          new LetExpression(
                                                                                                                                                              new SequentialDeclaration(
                                                                                                                                                                new ConstDeclaration(
                                                                                                                                                                  new Identifier(
                                                                                                                                                                    "num",
                                                                                                                                                                    dummyPosition()
                                                                                                                                                                    ),
                                                                                                                                                                  new BinaryExpression(
                                                                                                                                                                    new BinaryExpression(
                                                                                                                                                                      new VnameExpression(
                                                                                                                                                                        new DotVname(
                                                                                                                                                                          new SimpleVname(
                                                                                                                                                                            new Identifier(
                                                                                                                                                                              "r1",
                                                                                                                                                                              dummyPosition()
                                                                                                                                                                              ),
                                                                                                                                                                            dummyPosition()
                                                                                                                                                                            ),
                                                                                                                                                                          new Identifier(
                                                                                                                                                                            "numerator",
                                                                                                                                                                            dummyPosition()
                                                                                                                                                                            ),
                                                                                                                                                                          dummyPosition()
                                                                                                                                                                          ),
                                                                                                                                                                        dummyPosition()
                                                                                                                                                                        ),
                                                                                                                                                                      new Operator(
                                                                                                                                                                        "*",
                                                                                                                                                                        dummyPosition()
                                                                                                                                                                        ),
                                                                                                                                                                      new VnameExpression(
                                                                                                                                                                          new DotVname(
                                                                                                                                                                            new SimpleVname(
                                                                                                                                                                              new Identifier(
                                                                                                                                                                                "r2",
                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                ),
                                                                                                                                                                              dummyPosition()
                                                                                                                                                                              ),
                                                                                                                                                                            new Identifier(
                                                                                                                                                                              "denominator",
                                                                                                                                                                              dummyPosition()
                                                                                                                                                                              ),
                                                                                                                                                                            dummyPosition()
                                                                                                                                                                            ),
                                                                                                                                                                          dummyPosition()
                                                                                                                                                                          ),
                                                                                                                                                                      dummyPosition()
                                                                                                                                                                        ),
                                                                                                                                                                      new Operator(
                                                                                                                                                                          "-",
                                                                                                                                                                          dummyPosition()
                                                                                                                                                                          ),
                                                                                                                                                                      new BinaryExpression(
                                                                                                                                                                          new VnameExpression(
                                                                                                                                                                            new DotVname(
                                                                                                                                                                              new SimpleVname(
                                                                                                                                                                                new Identifier(
                                                                                                                                                                                  "r1",
                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                  ),
                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                ),
                                                                                                                                                                              new Identifier(
                                                                                                                                                                                "denominator",
                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                ),
                                                                                                                                                                              dummyPosition()
                                                                                                                                                                              ),
                                                                                                                                                                            dummyPosition()
                                                                                                                                                                            ),
                                                                                                                                                                          new Operator(
                                                                                                                                                                            "*",
                                                                                                                                                                            dummyPosition()
                                                                                                                                                                            ),
                                                                                                                                                                          new VnameExpression(
                                                                                                                                                                              new DotVname(
                                                                                                                                                                                new SimpleVname(
                                                                                                                                                                                  new Identifier(
                                                                                                                                                                                    "r2",
                                                                                                                                                                                    dummyPosition()
                                                                                                                                                                                    ),
                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                  ),
                                                                                                                                                                                new Identifier(
                                                                                                                                                                                  "numerator",
                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                  ),
                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                ),
                                                                                                                                                                              dummyPosition()
                                                                                                                                                                              ),
                                                                                                                                                                          dummyPosition()
                                                                                                                                                                            ),
                                                                                                                                                                          dummyPosition()
                                                                                                                                                                            ),
                                                                                                                                                                          dummyPosition()
                                                                                                                                                                            ),
                                                                                                                                                                          new ConstDeclaration(
                                                                                                                                                                              new Identifier(
                                                                                                                                                                                "denom",
                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                ),
                                                                                                                                                                              new BinaryExpression(
                                                                                                                                                                                new VnameExpression(
                                                                                                                                                                                  new DotVname(
                                                                                                                                                                                    new SimpleVname(
                                                                                                                                                                                      new Identifier(
                                                                                                                                                                                        "r1",
                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                        ),
                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                      ),
                                                                                                                                                                                    new Identifier(
                                                                                                                                                                                      "denominator",
                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                      ),
                                                                                                                                                                                    dummyPosition()
                                                                                                                                                                                    ),
                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                  ),
                                                                                                                                                                                new Operator(
                                                                                                                                                                                  "*",
                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                  ),
                                                                                                                                                                                new VnameExpression(
                                                                                                                                                                                    new DotVname(
                                                                                                                                                                                      new SimpleVname(
                                                                                                                                                                                        new Identifier(
                                                                                                                                                                                          "r2",
                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                          ),
                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                        ),
                                                                                                                                                                                      new Identifier(
                                                                                                                                                                                        "denominator",
                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                        ),
                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                      ),
                                                                                                                                                                                    dummyPosition()
                                                                                                                                                                                    ),
                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                  ),
                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                  ),
                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                  ),
                                                                                                                                                                                new CallExpression(
                                                                                                                                                                                    new Identifier(
                                                                                                                                                                                      "makerational",
                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                      ),
                                                                                                                                                                                    new MultipleActualParameterSequence(
                                                                                                                                                                                      new ConstActualParameter(
                                                                                                                                                                                        new VnameExpression(
                                                                                                                                                                                          new SimpleVname(
                                                                                                                                                                                            new Identifier(
                                                                                                                                                                                              "num",
                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                              ),
                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                            ),
                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                          ),
                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                        ),
                                                                                                                                                                                      new SingleActualParameterSequence(
                                                                                                                                                                                        new ConstActualParameter(
                                                                                                                                                                                          new VnameExpression(
                                                                                                                                                                                            new SimpleVname(
                                                                                                                                                                                              new Identifier(
                                                                                                                                                                                                "denom",
                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                ),
                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                              ),
                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                            ),
                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                          ),
                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                        ),
                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                        ),
                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                        ),
                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                        ),
                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                        ),
                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                        ),
                                                                                                                                                                                      new VarDeclaration(
                                                                                                                                                                                          new Identifier(
                                                                                                                                                                                            "a",
                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                            ),
                                                                                                                                                                                          new SimpleTypeDenoter(
                                                                                                                                                                                            new Identifier(
                                                                                                                                                                                              "Rational",
                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                              ),
                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                            ),
                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                          ),
                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                        ),
                                                                                                                                                                                      new VarDeclaration(
                                                                                                                                                                                          new Identifier(
                                                                                                                                                                                            "b",
                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                            ),
                                                                                                                                                                                          new SimpleTypeDenoter(
                                                                                                                                                                                            new Identifier(
                                                                                                                                                                                              "Rational",
                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                              ),
                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                            ),
                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                          ),
                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                        ),
                                                                                                                                                                                      new VarDeclaration(
                                                                                                                                                                                          new Identifier(
                                                                                                                                                                                            "c",
                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                            ),
                                                                                                                                                                                          new SimpleTypeDenoter(
                                                                                                                                                                                            new Identifier(
                                                                                                                                                                                              "Rational",
                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                              ),
                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                            ),
                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                          ),
                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                        ),
                                                                                                                                                                                      new SequentialCommand(
                                                                                                                                                                                          new SequentialCommand(
                                                                                                                                                                                            new SequentialCommand(
                                                                                                                                                                                              new SequentialCommand(
                                                                                                                                                                                                new SequentialCommand(
                                                                                                                                                                                                  new SequentialCommand(
                                                                                                                                                                                                    new SequentialCommand(
                                                                                                                                                                                                      new SequentialCommand(
                                                                                                                                                                                                        new CallCommand(
                                                                                                                                                                                                          new Identifier(
                                                                                                                                                                                                            "readrational",
                                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                                            ),
                                                                                                                                                                                                          new SingleActualParameterSequence(
                                                                                                                                                                                                            new VarActualParameter(
                                                                                                                                                                                                              new SimpleVname(
                                                                                                                                                                                                                new Identifier(
                                                                                                                                                                                                                  "a",
                                                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                                                  ),
                                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                                ),
                                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                                              ),
                                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                                            ),
                                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                                          ),
                                                                                                                                                                                      new CallCommand(
                                                                                                                                                                                          new Identifier(
                                                                                                                                                                                            "displayrational",
                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                            ),
                                                                                                                                                                                          new SingleActualParameterSequence(
                                                                                                                                                                                            new ConstActualParameter(
                                                                                                                                                                                              new VnameExpression(
                                                                                                                                                                                                new SimpleVname(
                                                                                                                                                                                                  new Identifier(
                                                                                                                                                                                                    "a",
                                                                                                                                                                                                    dummyPosition()
                                                                                                                                                                                                    ),
                                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                                  ),
                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                ),
                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                              ),
                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                            ),
                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                            ),
                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                            ),
                                                                                                                                                                                          new CallCommand(
                                                                                                                                                                                              new Identifier(
                                                                                                                                                                                                "readrational",
                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                ),
                                                                                                                                                                                              new SingleActualParameterSequence(
                                                                                                                                                                                                new VarActualParameter(
                                                                                                                                                                                                  new SimpleVname(
                                                                                                                                                                                                    new Identifier(
                                                                                                                                                                                                      "b",
                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                      ),
                                                                                                                                                                                                    dummyPosition()
                                                                                                                                                                                                    ),
                                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                                  ),
                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                ),
                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                              ),
                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                            ),
                                                                                                                                                                                          new CallCommand(
                                                                                                                                                                                              new Identifier(
                                                                                                                                                                                                "displayrational",
                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                ),
                                                                                                                                                                                              new SingleActualParameterSequence(
                                                                                                                                                                                                new ConstActualParameter(
                                                                                                                                                                                                  new VnameExpression(
                                                                                                                                                                                                    new SimpleVname(
                                                                                                                                                                                                      new Identifier(
                                                                                                                                                                                                        "b",
                                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                      ),
                                                                                                                                                                                                    dummyPosition()
                                                                                                                                                                                                    ),
                                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                                  ),
                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                ),
                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                                ),
                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                                ),
                                                                                                                                                                                              new AssignCommand(
                                                                                                                                                                                                  new SimpleVname(
                                                                                                                                                                                                    new Identifier(
                                                                                                                                                                                                      "c",
                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                      ),
                                                                                                                                                                                                    dummyPosition()
                                                                                                                                                                                                    ),
                                                                                                                                                                                                  new CallExpression(
                                                                                                                                                                                                    new Identifier(
                                                                                                                                                                                                      "addrational",
                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                      ),
                                                                                                                                                                                                    new MultipleActualParameterSequence(
                                                                                                                                                                                                      new ConstActualParameter(
                                                                                                                                                                                                        new VnameExpression(
                                                                                                                                                                                                          new SimpleVname(
                                                                                                                                                                                                            new Identifier(
                                                                                                                                                                                                              "a",
                                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                                              ),
                                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                                            ),
                                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                                          ),
                                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      new SingleActualParameterSequence(
                                                                                                                                                                                                        new ConstActualParameter(
                                                                                                                                                                                                          new VnameExpression(
                                                                                                                                                                                                            new SimpleVname(
                                                                                                                                                                                                              new Identifier(
                                                                                                                                                                                                                "b",
                                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                                ),
                                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                                              ),
                                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                                            ),
                                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                                          ),
                                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                        ),
                                                                                                                                                                                                      new CallCommand(
                                                                                                                                                                                                          new Identifier(
                                                                                                                                                                                                            "displayrational",
                                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                                            ),
                                                                                                                                                                                                          new SingleActualParameterSequence(
                                                                                                                                                                                                            new ConstActualParameter(
                                                                                                                                                                                                              new VnameExpression(
                                                                                                                                                                                                                new SimpleVname(
                                                                                                                                                                                                                  new Identifier(
                                                                                                                                                                                                                    "c",
                                                                                                                                                                                                                    dummyPosition()
                                                                                                                                                                                                                    ),
                                                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                                                  ),
                                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                                ),
                                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                                              ),
                                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                                            ),
                                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                                            ),
                                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                                            ),
                                                                                                                                                                                                          new AssignCommand(
                                                                                                                                                                                                              new SimpleVname(
                                                                                                                                                                                                                new Identifier(
                                                                                                                                                                                                                  "c",
                                                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                                                  ),
                                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                                ),
                                                                                                                                                                                                              new CallExpression(
                                                                                                                                                                                                                new Identifier(
                                                                                                                                                                                                                  "subrational",
                                                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                                                  ),
                                                                                                                                                                                                                new MultipleActualParameterSequence(
                                                                                                                                                                                                                  new ConstActualParameter(
                                                                                                                                                                                                                    new VnameExpression(
                                                                                                                                                                                                                      new SimpleVname(
                                                                                                                                                                                                                        new Identifier(
                                                                                                                                                                                                                          "a",
                                                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                                                          ),
                                                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                                                        ),
                                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                                      ),
                                                                                                                                                                                                                    dummyPosition()
                                                                                                                                                                                                                    ),
                                                                                                                                                                                                                  new SingleActualParameterSequence(
                                                                                                                                                                                                                    new ConstActualParameter(
                                                                                                                                                                                                                      new VnameExpression(
                                                                                                                                                                                                                        new SimpleVname(
                                                                                                                                                                                                                          new Identifier(
                                                                                                                                                                                                                            "b",
                                                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                                                            ),
                                                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                                                          ),
                                                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                                                        ),
                                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                                      ),
                                                                                                                                                                                                                    dummyPosition()
                                                                                                                                                                                                                    ),
                                                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                                                    ),
                                                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                                                    ),
                                                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                                                    ),
                                                                                                                                                                                                                  dummyPosition()
                                                                                                                                                                                                                    ),
                                                                                                                                                                                                                  new CallCommand(
                                                                                                                                                                                                                      new Identifier(
                                                                                                                                                                                                                        "displayrational",
                                                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                                                        ),
                                                                                                                                                                                                                      new SingleActualParameterSequence(
                                                                                                                                                                                                                        new ConstActualParameter(
                                                                                                                                                                                                                          new VnameExpression(
                                                                                                                                                                                                                            new SimpleVname(
                                                                                                                                                                                                                              new Identifier(
                                                                                                                                                                                                                                "c",
                                                                                                                                                                                                                                dummyPosition()
                                                                                                                                                                                                                                ),
                                                                                                                                                                                                                              dummyPosition()
                                                                                                                                                                                                                              ),
                                                                                                                                                                                                                            dummyPosition()
                                                                                                                                                                                                                            ),
                                                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                                                          ),
                                                                                                                                                                                                                        dummyPosition()
                                                                                                                                                                                                                        ),
                                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                                        ),
                                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                                        ),
                                                                                                                                                                                                                      new EmptyCommand(
                                                                                                                                                                                                                          dummyPosition()
                                                                                                                                                                                                                          ),
                                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                                        ),
                                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                                        ),
                                                                                                                                                                                                                      dummyPosition()
                                                                                                                                                                                                                        );

    Program actualProgram = parser.parseProgram();
    assertThat(expectedProgram, is(equalTo(actualProgram)));
  }
}

